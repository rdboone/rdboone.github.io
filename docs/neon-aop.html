<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 NEON AOP | Environmental Informatics Using Research Infrastructures and their Data</title>
  <meta name="description" content="Course text for NAU INF 550" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 NEON AOP | Environmental Informatics Using Research Infrastructures and their Data" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="//Users/rohan/katharynduffy.github.io/images/EcoInfo4.png" />
  <meta property="og:description" content="Course text for NAU INF 550" />
  <meta name="github-repo" content="rdboone/katharynduffy.github.io" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 NEON AOP | Environmental Informatics Using Research Infrastructures and their Data" />
  
  <meta name="twitter:description" content="Course text for NAU INF 550" />
  <meta name="twitter:image" content="//Users/rohan/katharynduffy.github.io/images/EcoInfo4.png" />

<meta name="author" content="Dr. Katharyn Duffy, Dr. Ben Ruddell" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="flux-measurements-inter-operability.html"/>
<link rel="next" href="nasas-earth-observing-system-eos.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">INF550: EcoInformatics data collection tools & products, </a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#key-contributors"><i class="fa fa-check"></i>Key Contributors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html"><i class="fa fa-check"></i>Pre-Course Setup: EcoInformatics Tools</a>
<ul>
<li class="chapter" data-level="0.1" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#pre-course-skills-setup"><i class="fa fa-check"></i><b>0.1</b> Pre-Course Skills &amp; Setup</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#installing-or-updating-r"><i class="fa fa-check"></i><b>0.1.1</b> Installing or Updating R</a></li>
<li class="chapter" data-level="0.1.2" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#windows-rrstudio-setup"><i class="fa fa-check"></i><b>0.1.2</b> Windows R/RStudio Setup</a></li>
<li class="chapter" data-level="0.1.3" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#mac-rrstudio-setup"><i class="fa fa-check"></i><b>0.1.3</b> Mac R/RStudio Setup</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#linux-rrstudio-setup"><i class="fa fa-check"></i><b>0.2</b> Linux R/RStudio Setup</a>
<ul>
<li class="chapter" data-level="0.2.1" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#install-basic-packages-for-this-course"><i class="fa fa-check"></i><b>0.2.1</b> Install basic packages for this course</a></li>
</ul></li>
<li class="chapter" data-level="0.3" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#installing-and-setting-up-git-github-on-your-machine"><i class="fa fa-check"></i><b>0.3</b> Installing and Setting up Git &amp; Github on Your Machine</a></li>
<li class="chapter" data-level="0.4" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#installing-atom"><i class="fa fa-check"></i><b>0.4</b> Installing Atom</a></li>
<li class="chapter" data-level="0.5" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#linking-rstudio-to-git"><i class="fa fa-check"></i><b>0.5</b> Linking RStudio to Git</a></li>
<li class="chapter" data-level="0.6" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#how-we-will-be-conducting-this-course"><i class="fa fa-check"></i><b>0.6</b> How we will be Conducting this Course</a></li>
<li class="chapter" data-level="0.7" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#exercises"><i class="fa fa-check"></i><b>0.7</b> Exercises:</a>
<ul>
<li class="chapter" data-level="0.7.1" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#exercise-0.1-a-git-introduction"><i class="fa fa-check"></i><b>0.7.1</b> Exercise 0.1: A git introduction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="why-ecoinformatics.html"><a href="why-ecoinformatics.html"><i class="fa fa-check"></i><b>1</b> Why ‘EcoInformatics’?</a>
<ul>
<li class="chapter" data-level="1.1" data-path="why-ecoinformatics.html"><a href="why-ecoinformatics.html#the-framework-of-this-course"><i class="fa fa-check"></i><b>1.1</b> The Framework of this Course</a></li>
<li class="chapter" data-level="1.2" data-path="why-ecoinformatics.html"><a href="why-ecoinformatics.html#final-course-project-proposed-derived-data-product"><i class="fa fa-check"></i><b>1.2</b> Final Course Project: Proposed Derived Data Product</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html"><i class="fa fa-check"></i><b>2</b> Introduction to NEON &amp; its Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#learning-objectives"><i class="fa fa-check"></i><b>2.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#the-neon-project-mission-design"><i class="fa fa-check"></i><b>2.2</b> The NEON Project Mission &amp; Design</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#the-science-and-design-of-neon"><i class="fa fa-check"></i><b>2.3</b> The Science and Design of NEON</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#neons-spatial-design"><i class="fa fa-check"></i><b>2.4</b> NEON’s Spatial Design</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#neon-samples-all-20-eco-regions"><i class="fa fa-check"></i><b>2.4.1</b> NEON Samples All 20 Eco-Regions</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#how-neon-collects-data"><i class="fa fa-check"></i><b>2.5</b> How NEON Collects Data</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#specimens-samples"><i class="fa fa-check"></i><b>2.5.1</b> Specimens &amp; Samples</a></li>
<li class="chapter" data-level="2.5.2" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#airborne-remote-sensing"><i class="fa fa-check"></i><b>2.5.2</b> Airborne Remote Sensing</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#accessing-neon-data"><i class="fa fa-check"></i><b>2.6</b> Accessing NEON Data</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#pathways-to-access-neon-data"><i class="fa fa-check"></i><b>2.6.1</b> Pathways to access NEON Data</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#hands-on-accessing-neon-data-user-tokens"><i class="fa fa-check"></i><b>2.7</b> Hands on: Accessing NEON Data &amp; User Tokens</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#via-the-neon-api-with-your-user-token"><i class="fa fa-check"></i><b>2.7.1</b> Via the NEON API, with your User Token</a></li>
<li class="chapter" data-level="2.8.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#get-a-neon-api-token"><i class="fa fa-check"></i><b>2.8.1</b> Get a NEON API Token</a></li>
<li class="chapter" data-level="2.8.2" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#use-the-api-token-in-neonutilities"><i class="fa fa-check"></i><b>2.8.2</b> Use the API token in neonUtilities</a></li>
<li class="chapter" data-level="2.8.3" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#token-management-for-open-code"><i class="fa fa-check"></i><b>2.8.3</b> Token management for open code</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#hands-on-neon-tos-data"><i class="fa fa-check"></i><b>2.9</b> Hands on: NEON TOS Data</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#pull-in-tree-data-from-neons-tos-and-investigate-relationships"><i class="fa fa-check"></i><b>2.9.1</b> Pull in Tree Data from NEON’s TOS and investigate relationships</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#intro-to-neon-exercises-part-1"><i class="fa fa-check"></i><b>2.10</b> Intro to NEON Exercises Part 1</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#exercise-2.1-neon-coding-lab---tos-vegetation-structure"><i class="fa fa-check"></i><b>2.10.1</b> Exercise 2.1: NEON Coding Lab - TOS Vegetation Structure</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#hands-on-pulling-neon-data-via-the-api"><i class="fa fa-check"></i><b>2.11</b> Hands on: Pulling NEON Data via the API</a></li>
<li class="chapter" data-level="2.12" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#what-is-an-api"><i class="fa fa-check"></i><b>2.12</b> What is an API?</a>
<ul>
<li class="chapter" data-level="2.12.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#anatomy-of-an-api-call"><i class="fa fa-check"></i><b>2.12.1</b> Anatomy of an API call</a></li>
<li class="chapter" data-level="2.12.2" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#targets"><i class="fa fa-check"></i><b>2.12.2</b> Targets:</a></li>
<li class="chapter" data-level="2.12.3" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#observational-data-os"><i class="fa fa-check"></i><b>2.12.3</b> Observational data (OS)</a></li>
<li class="chapter" data-level="2.12.4" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#instrumentation-data-is"><i class="fa fa-check"></i><b>2.12.4</b> Instrumentation data (IS)</a></li>
<li class="chapter" data-level="2.12.5" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#remote-sensing-data-aop"><i class="fa fa-check"></i><b>2.12.5</b> Remote sensing data (AOP)</a></li>
<li class="chapter" data-level="2.12.6" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#geolocation-data"><i class="fa fa-check"></i><b>2.12.6</b> Geolocation data</a></li>
<li class="chapter" data-level="2.12.7" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#querying-a-single-named-location"><i class="fa fa-check"></i><b>2.12.7</b> Querying a single named location</a></li>
<li class="chapter" data-level="2.12.8" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#taxonomy"><i class="fa fa-check"></i><b>2.12.8</b> Taxonomy</a></li>
</ul></li>
<li class="chapter" data-level="2.13" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#stacking-neon-data"><i class="fa fa-check"></i><b>2.13</b> Stacking NEON data</a></li>
<li class="chapter" data-level="2.14" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#intro-to-neon-exercises-part-2"><i class="fa fa-check"></i><b>2.14</b> Intro to NEON Exercises Part 2</a>
<ul>
<li class="chapter" data-level="2.14.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#exercise-2.2-written-questions"><i class="fa fa-check"></i><b>2.14.1</b> Exercise 2.2: Written questions</a></li>
<li class="chapter" data-level="2.14.2" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#exercise-2.3-neon-coding-lab---further-exploration-of-neon-data"><i class="fa fa-check"></i><b>2.14.2</b> Exercise 2.3: NEON Coding Lab - Further Exploration of NEON Data</a></li>
<li class="chapter" data-level="2.14.3" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#exercise-2.4-intro-to-neon-culmination-activity"><i class="fa fa-check"></i><b>2.14.3</b> Exercise 2.4: Intro to NEON Culmination Activity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html"><i class="fa fa-check"></i><b>3</b> Introduction to USA-NPN &amp; its Data</a>
<ul>
<li class="chapter" data-level="3.8" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#hands-on-accessing-usa-npn-data-via-rnpn"><i class="fa fa-check"></i><b>3.8</b> Hands on: Accessing USA-NPN Data via rNPN</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#introduction"><i class="fa fa-check"></i><b>3.8.1</b> Introduction</a></li>
<li class="chapter" data-level="3.8.2" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#accessing-usa-npn-observational-data"><i class="fa fa-check"></i><b>3.8.2</b> Accessing USA-NPN Observational Data</a></li>
<li class="chapter" data-level="3.8.3" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#status-and-intensity-data"><i class="fa fa-check"></i><b>3.8.3</b> Status and Intensity Data</a></li>
<li class="chapter" data-level="3.8.4" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#individual-phenometrics"><i class="fa fa-check"></i><b>3.8.4</b> Individual Phenometrics</a></li>
<li class="chapter" data-level="3.8.5" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#site-phenometrics"><i class="fa fa-check"></i><b>3.8.5</b> Site Phenometrics</a></li>
<li class="chapter" data-level="3.8.6" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#magnitude-phenometrics"><i class="fa fa-check"></i><b>3.8.6</b> Magnitude Phenometrics</a></li>
<li class="chapter" data-level="3.8.7" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#usa-npn-geospatial-data"><i class="fa fa-check"></i><b>3.8.7</b> USA-NPN Geospatial Data</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#accumulated-growing-degree-day-products"><i class="fa fa-check"></i><b>3.9</b> Accumulated Growing Degree Day Products</a></li>
<li class="chapter" data-level="3.10" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#extended-spring-indices"><i class="fa fa-check"></i><b>3.10</b> Extended Spring Indices</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#other-layers"><i class="fa fa-check"></i><b>3.10.1</b> Other Layers</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#putting-it-all-together"><i class="fa fa-check"></i><b>3.11</b> Putting it all together:</a></li>
<li class="chapter" data-level="3.12" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#combine-point-and-raster-data"><i class="fa fa-check"></i><b>3.12</b> Combine Point and Raster Data</a>
<ul>
<li class="chapter" data-level="3.12.1" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#step-1-get-the-data"><i class="fa fa-check"></i><b>3.12.1</b> Step 1: Get the data</a></li>
<li class="chapter" data-level="3.12.2" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#step-2-preparing-the-data"><i class="fa fa-check"></i><b>3.12.2</b> Step 2: Preparing the data</a></li>
<li class="chapter" data-level="3.12.3" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#step-3-define-style-options-and-create-graph"><i class="fa fa-check"></i><b>3.12.3</b> Step 3: Define style options and create graph</a></li>
</ul></li>
<li class="chapter" data-level="3.13" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#live-demo-code-with-lee-marsh-of-usa-npn"><i class="fa fa-check"></i><b>3.13</b> Live Demo Code with Lee Marsh of USA-NPN</a>
<ul>
<li class="chapter" data-level="3.13.1" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#basic-utility-functions"><i class="fa fa-check"></i><b>3.13.1</b> Basic Utility Functions</a></li>
<li class="chapter" data-level="3.13.2" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#download-observational-data"><i class="fa fa-check"></i><b>3.13.2</b> Download Observational Data</a></li>
<li class="chapter" data-level="3.13.3" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#magnitude-data"><i class="fa fa-check"></i><b>3.13.3</b> Magnitude Data</a></li>
<li class="chapter" data-level="3.13.4" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#downloading-geospatial-data"><i class="fa fa-check"></i><b>3.13.4</b> Downloading Geospatial Data</a></li>
<li class="chapter" data-level="3.13.5" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#putting-it-together"><i class="fa fa-check"></i><b>3.13.5</b> Putting it together</a></li>
<li class="chapter" data-level="3.13.6" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#other-data-sources-e.g.-daymet-modis"><i class="fa fa-check"></i><b>3.13.6</b> Other Data Sources, e.g. Daymet, MODIS</a></li>
</ul></li>
<li class="chapter" data-level="3.14" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#usa-npn-coding-lab"><i class="fa fa-check"></i><b>3.14</b> USA-NPN Coding Lab</a></li>
<li class="chapter" data-level="3.15" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#neon-tos-phenology-data-lecture"><i class="fa fa-check"></i><b>3.15</b> NEON TOS Phenology Data Lecture</a></li>
<li class="chapter" data-level="3.16" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#understanding-observation-biases-and-censoring-in-citizen-science-data"><i class="fa fa-check"></i><b>3.16</b> Understanding Observation Biases and Censoring in Citizen Science Data</a>
<ul>
<li class="chapter" data-level="3.16.1" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#many-existing-modeling-approaches-fail-in-one-or-both-regards."><i class="fa fa-check"></i><b>3.16.1</b> Many existing modeling approaches fail in one (or both) regards.</a></li>
<li class="chapter" data-level="3.16.2" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#censoring"><i class="fa fa-check"></i><b>3.16.2</b> Censoring</a></li>
</ul></li>
<li class="chapter" data-level="3.17" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#so-then-how-can-we-model-censored-data"><i class="fa fa-check"></i><b>3.17</b> So then how can we model censored data?</a></li>
<li class="chapter" data-level="3.18" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#intro-to-usa-npn-culmination-activity"><i class="fa fa-check"></i><b>3.18</b> Intro to USA-NPN Culmination Activity</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html"><i class="fa fa-check"></i><b>4</b> PhenoCam: Digital Repeat Photography Networks &amp; Methods</a>
<ul>
<li class="chapter" data-level="4.1" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#digital-repeat-photography-networks-learning-objectives"><i class="fa fa-check"></i><b>4.1</b> Digital Repeat Photography Networks Learning Objectives</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#guest-lectures"><i class="fa fa-check"></i><b>4.1.1</b> Guest Lectures</a></li>
<li class="chapter" data-level="4.1.2" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#assignments-in-this-chapter"><i class="fa fa-check"></i><b>4.1.2</b> Assignments in this chapter</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#the-phenocam-network-mission-design"><i class="fa fa-check"></i><b>4.2</b> The PhenoCam Network Mission &amp; Design</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#relevant-documents-background-information-1"><i class="fa fa-check"></i><b>4.2.1</b> Relevant documents &amp; background information:</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#phenocams-spatial-design"><i class="fa fa-check"></i><b>4.3</b> PhenoCam’s Spatial design:</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#phenocam-as-a-near-surface-remote-sensing-technique"><i class="fa fa-check"></i><b>4.3.1</b> PhenoCam as a Near Surface Remote Sensing Technique</a></li>
<li class="chapter" data-level="4.3.2" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#how-phenocams-pull-data"><i class="fa fa-check"></i><b>4.3.2</b> How PhenoCams Pull Data</a></li>
<li class="chapter" data-level="4.3.3" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#leveraging-camera-near-infrared-nir-capabilities"><i class="fa fa-check"></i><b>4.3.3</b> Leveraging camera near-infrared (NIR) capabilities</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#digital-repeat-photography-written-questions"><i class="fa fa-check"></i><b>4.4</b> Digital Repeat Photography Written Questions</a></li>
<li class="chapter" data-level="4.5" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#introduction-to-digital-repeat-photography-methods"><i class="fa fa-check"></i><b>4.5</b> Introduction to Digital Repeat Photography Methods</a></li>
<li class="chapter" data-level="4.6" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#pulling-data-via-the-phenocamapi-package"><i class="fa fa-check"></i><b>4.6</b> Pulling Data via the <em>phenocamapi</em> Package</a></li>
<li class="chapter" data-level="4.7" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#exploring-phenocam-metadata"><i class="fa fa-check"></i><b>4.7</b> Exploring PhenoCam metadata</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#remove-null-values"><i class="fa fa-check"></i><b>4.7.1</b> Remove null values</a></li>
<li class="chapter" data-level="4.7.2" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#filtering-using-attributes"><i class="fa fa-check"></i><b>4.7.2</b> Filtering using attributes</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#download-midday-images"><i class="fa fa-check"></i><b>4.8</b> Download midday images</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#download-midday-images-for-a-given-time-range"><i class="fa fa-check"></i><b>4.8.1</b> Download midday images for a given time range</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#detecting-foggy-images-using-the-hazer-r-package"><i class="fa fa-check"></i><b>4.9</b> Detecting Foggy Images using the ‘hazer’ R Package</a></li>
<li class="chapter" data-level="4.10" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#extracting-timeseries-from-images-using-the-xroi-r-package"><i class="fa fa-check"></i><b>4.10</b> Extracting Timeseries from Images using the xROI R Package</a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#xroi-design"><i class="fa fa-check"></i><b>4.10.1</b> xROI Design</a></li>
<li class="chapter" data-level="4.10.2" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#install-xroi"><i class="fa fa-check"></i><b>4.10.2</b> Install xROI</a></li>
<li class="chapter" data-level="4.10.3" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#launch-xroi"><i class="fa fa-check"></i><b>4.10.3</b> Launch xROI</a></li>
<li class="chapter" data-level="4.10.4" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#end-xroi"><i class="fa fa-check"></i><b>4.10.4</b> End xROI</a></li>
<li class="chapter" data-level="4.10.5" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#use-xroi"><i class="fa fa-check"></i><b>4.10.5</b> Use xROI</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#documentation-and-citation"><i class="fa fa-check"></i><b>4.11</b> Documentation and Citation</a>
<ul>
<li class="chapter" data-level="4.11.1" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#challenge-use-xroi"><i class="fa fa-check"></i><b>4.11.1</b> Challenge: Use xROI</a></li>
</ul></li>
<li class="chapter" data-level="4.12" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#hands-on-digital-repeat-photography-computational"><i class="fa fa-check"></i><b>4.12</b> Hands on: Digital Repeat Photography Computational</a>
<ul>
<li class="chapter" data-level="4.12.1" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#phenocam-time-series"><i class="fa fa-check"></i><b>4.12.1</b> PhenoCam time series</a></li>
<li class="chapter" data-level="4.12.2" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#obtain-rois"><i class="fa fa-check"></i><b>4.12.2</b> Obtain ROIs</a></li>
<li class="chapter" data-level="4.12.3" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#download-time-series"><i class="fa fa-check"></i><b>4.12.3</b> Download time series</a></li>
<li class="chapter" data-level="4.12.4" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#threshold-values"><i class="fa fa-check"></i><b>4.12.4</b> Threshold values</a></li>
<li class="chapter" data-level="4.12.5" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#comparing-phenology-across-vegetation-types"><i class="fa fa-check"></i><b>4.12.5</b> Comparing phenology across vegetation types</a></li>
<li class="chapter" data-level="4.12.6" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#in-class-hands-on-coding-comparing-phenology-of-the-same-plant-function-type-pft-across-climate-space"><i class="fa fa-check"></i><b>4.12.6</b> In Class Hands-on Coding: Comparing phenology of the same plant function type (PFT) across climate space</a></li>
</ul></li>
<li class="chapter" data-level="4.13" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#digital-repeat-photography-coding-lab"><i class="fa fa-check"></i><b>4.13</b> Digital Repeat Photography Coding Lab</a>
<ul>
<li class="chapter" data-level="4.13.1" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#quantifying-haze-and-redness-to-evaluate-california-wildfires"><i class="fa fa-check"></i><b>4.13.1</b> Quantifying haze and redness to evaluate California wildfires</a></li>
</ul></li>
<li class="chapter" data-level="4.14" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#phenocam-culmination-activity"><i class="fa fa-check"></i><b>4.14</b> PhenoCam Culmination Activity</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html"><i class="fa fa-check"></i><b>5</b> Flux Measurements &amp; Inter-Operability</a>
<ul>
<li class="chapter" data-level="6.1.2" data-path="neon-aop.html"><a href="neon-aop.html"><i class="fa fa-check"></i><b>6.1.2</b> About Hyperspectral Remote Sensing Data</a></li>
<li class="chapter" data-level="6.2" data-path="neon-aop.html"><a href="neon-aop.html#key-metadata-for-hyperspectral-data"><i class="fa fa-check"></i><b>6.2</b> Key Metadata for Hyperspectral Data</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="neon-aop.html"><a href="neon-aop.html#bands-and-wavelengths"><i class="fa fa-check"></i><b>6.2.1</b> Bands and Wavelengths</a></li>
<li class="chapter" data-level="6.2.2" data-path="neon-aop.html"><a href="neon-aop.html#spectral-resolution"><i class="fa fa-check"></i><b>6.2.2</b> Spectral Resolution</a></li>
<li class="chapter" data-level="6.2.3" data-path="neon-aop.html"><a href="neon-aop.html#full-width-half-max-fwhm"><i class="fa fa-check"></i><b>6.2.3</b> Full Width Half Max (FWHM)</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="neon-aop.html"><a href="neon-aop.html#intro-to-working-with-hyperspectral-remote-sensing-data-in-hdf5-format"><i class="fa fa-check"></i><b>6.3</b> Intro to Working with Hyperspectral Remote Sensing Data in HDF5 Format</a></li>
<li class="chapter" data-level="6.7" data-path="neon-aop.html"><a href="neon-aop.html#light-detection-and-ranging-lidar-data"><i class="fa fa-check"></i><b>6.7</b> Light Detection And Ranging (LiDAR) Data</a></li>
<li class="chapter" data-level="6.8" data-path="neon-aop.html"><a href="neon-aop.html#calculating-forest-structural-diversity-metrics-from-neon-lidar-data"><i class="fa fa-check"></i><b>6.8</b> Calculating Forest Structural Diversity Metrics from NEON LiDAR Data</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="neon-aop.html"><a href="neon-aop.html#learning-objectives-4"><i class="fa fa-check"></i><b>6.8.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="6.8.2" data-path="neon-aop.html"><a href="neon-aop.html#r-libraries-to-install-1"><i class="fa fa-check"></i><b>6.8.2</b> R Libraries to Install:</a></li>
<li class="chapter" data-level="6.8.3" data-path="neon-aop.html"><a href="neon-aop.html#data-to-download-1"><i class="fa fa-check"></i><b>6.8.3</b> Data to Download</a></li>
<li class="chapter" data-level="6.8.4" data-path="neon-aop.html"><a href="neon-aop.html#recommended-skills"><i class="fa fa-check"></i><b>6.8.4</b> Recommended Skills</a></li>
<li class="chapter" data-level="6.8.5" data-path="neon-aop.html"><a href="neon-aop.html#additional-resources-2"><i class="fa fa-check"></i><b>6.8.5</b> Additional Resources</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="neon-aop.html"><a href="neon-aop.html#introduction-to-structural-diversity-metrics"><i class="fa fa-check"></i><b>6.9</b> Introduction to Structural Diversity Metrics</a></li>
<li class="chapter" data-level="6.10" data-path="neon-aop.html"><a href="neon-aop.html#neon-aop-discrete-return-lidar"><i class="fa fa-check"></i><b>6.10</b> NEON AOP Discrete Return LIDAR</a>
<ul>
<li class="chapter" data-level="6.10.1" data-path="neon-aop.html"><a href="neon-aop.html#loading-the-lidar-products"><i class="fa fa-check"></i><b>6.10.1</b> Loading the LIDAR Products</a></li>
<li class="chapter" data-level="6.10.2" data-path="neon-aop.html"><a href="neon-aop.html#normalizing-tree-height-to-ground"><i class="fa fa-check"></i><b>6.10.2</b> Normalizing Tree Height to Ground</a></li>
</ul></li>
<li class="chapter" data-level="6.11" data-path="neon-aop.html"><a href="neon-aop.html#calculating-structural-diversity-metrics"><i class="fa fa-check"></i><b>6.11</b> Calculating Structural Diversity Metrics</a>
<ul>
<li class="chapter" data-level="6.11.1" data-path="neon-aop.html"><a href="neon-aop.html#generate-canopy-height-model-chm"><i class="fa fa-check"></i><b>6.11.1</b> GENERATE CANOPY HEIGHT MODEL (CHM)</a></li>
<li class="chapter" data-level="6.11.2" data-path="neon-aop.html"><a href="neon-aop.html#combining-everything-into-one-function"><i class="fa fa-check"></i><b>6.11.2</b> Combining Everything Into One Function</a></li>
<li class="chapter" data-level="6.11.3" data-path="neon-aop.html"><a href="neon-aop.html#comparing-metrics-between-forests"><i class="fa fa-check"></i><b>6.11.3</b> Comparing Metrics Between Forests</a></li>
</ul></li>
<li class="chapter" data-level="6.12" data-path="neon-aop.html"><a href="neon-aop.html#matching-gedi-waveforms-with-neon-aop-lidar-pointclouds"><i class="fa fa-check"></i><b>6.12</b> Matching GEDI waveforms with NEON AOP LiDAR pointclouds</a>
<ul>
<li class="chapter" data-level="6.12.1" data-path="neon-aop.html"><a href="neon-aop.html#learning-objectives-5"><i class="fa fa-check"></i><b>6.12.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="6.12.2" data-path="neon-aop.html"><a href="neon-aop.html#things-youll-need-to-complete-this-gedi-section"><i class="fa fa-check"></i><b>6.12.2</b> Things You’ll Need To Complete This GEDI Section</a></li>
<li class="chapter" data-level="6.12.3" data-path="neon-aop.html"><a href="neon-aop.html#r-packages-to-install"><i class="fa fa-check"></i><b>6.12.3</b> R Packages to Install</a></li>
<li class="chapter" data-level="6.12.4" data-path="neon-aop.html"><a href="neon-aop.html#example-data-set"><i class="fa fa-check"></i><b>6.12.4</b> Example Data Set</a></li>
<li class="chapter" data-level="6.12.5" data-path="neon-aop.html"><a href="neon-aop.html#getting-started"><i class="fa fa-check"></i><b>6.12.5</b> Getting Started</a></li>
<li class="chapter" data-level="6.12.6" data-path="neon-aop.html"><a href="neon-aop.html#downloading-gedi-data"><i class="fa fa-check"></i><b>6.12.6</b> Downloading GEDI data</a></li>
<li class="chapter" data-level="6.12.7" data-path="neon-aop.html"><a href="neon-aop.html#plot-gedi-footprints-on-chm"><i class="fa fa-check"></i><b>6.12.7</b> Plot GEDI footprints on CHM</a></li>
<li class="chapter" data-level="6.12.8" data-path="neon-aop.html"><a href="neon-aop.html#extract-waveform-for-a-single-shot"><i class="fa fa-check"></i><b>6.12.8</b> Extract Waveform for a single Shot</a></li>
<li class="chapter" data-level="6.12.9" data-path="neon-aop.html"><a href="neon-aop.html#download-and-plot-neon-aop-lidar-pointcloud-data"><i class="fa fa-check"></i><b>6.12.9</b> Download and Plot NEON AOP LiDAR pointcloud data</a></li>
<li class="chapter" data-level="6.12.10" data-path="neon-aop.html"><a href="neon-aop.html#clip-aop-lidar-pointcloud-to-gedi-footprints"><i class="fa fa-check"></i><b>6.12.10</b> Clip AOP LiDAR Pointcloud to GEDI footprints</a></li>
<li class="chapter" data-level="6.12.11" data-path="neon-aop.html"><a href="neon-aop.html#plot-gedi-waveform-with-aop-pointcloud-in-3d-space"><i class="fa fa-check"></i><b>6.12.11</b> Plot GEDI Waveform with AOP Pointcloud in 3D space</a></li>
<li class="chapter" data-level="6.12.12" data-path="neon-aop.html"><a href="neon-aop.html#datum-geoid-and-how-to-best-measure-the-earth"><i class="fa fa-check"></i><b>6.12.12</b> Datum, Geoid, and how to best measure the Earth</a></li>
<li class="chapter" data-level="6.12.13" data-path="neon-aop.html"><a href="neon-aop.html#aligning-the-vertical-datum"><i class="fa fa-check"></i><b>6.12.13</b> Aligning the Vertical Datum</a></li>
<li class="chapter" data-level="6.12.14" data-path="neon-aop.html"><a href="neon-aop.html#geoid12a-height-model"><i class="fa fa-check"></i><b>6.12.14</b> GEOID12A Height Model</a></li>
<li class="chapter" data-level="6.12.15" data-path="neon-aop.html"><a href="neon-aop.html#extract-vertical-offset-for-gedi-shots"><i class="fa fa-check"></i><b>6.12.15</b> Extract vertical offset for GEDI shots</a></li>
<li class="chapter" data-level="6.12.16" data-path="neon-aop.html"><a href="neon-aop.html#plot-vertically-corrected-gedi-waveform-in-3d"><i class="fa fa-check"></i><b>6.12.16</b> Plot vertically corrected GEDI waveform in 3D</a></li>
<li class="chapter" data-level="6.12.17" data-path="neon-aop.html"><a href="neon-aop.html#optional---neon-base-plots"><i class="fa fa-check"></i><b>6.12.17</b> Optional - NEON base plots</a></li>
</ul></li>
<li class="chapter" data-level="6.13" data-path="neon-aop.html"><a href="neon-aop.html#neon-aop-written-questions"><i class="fa fa-check"></i><b>6.13</b> NEON AOP Written Questions:</a></li>
<li class="chapter" data-level="6.14" data-path="neon-aop.html"><a href="neon-aop.html#neon-aop-coding-lab"><i class="fa fa-check"></i><b>6.14</b> NEON AOP Coding Lab</a></li>
<li class="chapter" data-level="6.15" data-path="neon-aop.html"><a href="neon-aop.html#neon-aop-culmination-write-up"><i class="fa fa-check"></i><b>6.15</b> NEON AOP Culmination Write Up</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html"><i class="fa fa-check"></i><b>7</b> NASA’s Earth Observing System (EOS)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#learning-objectives-6"><i class="fa fa-check"></i><b>7.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="7.2" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#nasa-eos-project-mission-design"><i class="fa fa-check"></i><b>7.2</b> NASA EOS Project Mission &amp; Design</a></li>
<li class="chapter" data-level="7.3" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#nasa-eos-earth-data-account"><i class="fa fa-check"></i><b>7.3</b> NASA EOS Earth Data Account:</a></li>
<li class="chapter" data-level="7.4" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#nasa-eos-coding-assignment-1"><i class="fa fa-check"></i><b>7.4</b> <strong>NASA EOS Coding Assignment 1</strong></a></li>
<li class="chapter" data-level="7.5" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#distributed-active-archive-centers"><i class="fa fa-check"></i><b>7.5</b> Distributed Active Archive Centers</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#lp-daac"><i class="fa fa-check"></i><b>7.5.1</b> LP DAAC</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#the-lpdaac-mission-process-archive-distribute-apply"><i class="fa fa-check"></i><b>7.6</b> The LPDAAC Mission: Process, Archive, Distribute, Apply</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#how-you-can-use-lp-daacs-data"><i class="fa fa-check"></i><b>7.6.1</b> How you can use LP DAAC’s data</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#appeears"><i class="fa fa-check"></i><b>7.7</b> AppEEARS</a></li>
<li class="chapter" data-level="7.8" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#hands-on-pulling-appeears-data-via-the-api"><i class="fa fa-check"></i><b>7.8</b> Hands on: Pulling AppEEARS Data via the API</a></li>
<li class="chapter" data-level="7.9" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#getting-started-with-the-appeears-api-point-request"><i class="fa fa-check"></i><b>7.9</b> Getting Started with the AppEEARS API (Point Request)</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#example-submit-a-point-request-for-multiple-neon-sites-to-extract-vegetation-and-land-surface-temperature-data"><i class="fa fa-check"></i><b>7.9.1</b> Example: Submit a point request for multiple NEON sites to extract vegetation and land surface temperature data</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#topics-covered-in-this-section"><i class="fa fa-check"></i><b>7.10</b> Topics Covered in this section:</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#prerequisites"><i class="fa fa-check"></i><b>7.10.1</b> Prerequisites:</a></li>
<li class="chapter" data-level="7.10.2" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#appeears-information"><i class="fa fa-check"></i><b>7.10.2</b> AppEEARS Information:</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#getting-started-with-the-appeears-api"><i class="fa fa-check"></i><b>7.11</b> Getting Started with the AppEEARS API</a>
<ul>
<li class="chapter" data-level="7.11.1" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#load-packages"><i class="fa fa-check"></i><b>7.11.1</b> Load Packages</a></li>
<li class="chapter" data-level="7.11.2" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#set-up-the-output-directory"><i class="fa fa-check"></i><b>7.11.2</b> Set Up the Output Directory</a></li>
<li class="chapter" data-level="7.11.3" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#login-to-earth-data"><i class="fa fa-check"></i><b>7.11.3</b> Login to Earth Data</a></li>
</ul></li>
<li class="chapter" data-level="7.12" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#query-available-products"><i class="fa fa-check"></i><b>7.12</b> Query Available Products</a></li>
<li class="chapter" data-level="7.13" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#search-and-explore-available-products"><i class="fa fa-check"></i><b>7.13</b> Search and Explore Available Products</a></li>
<li class="chapter" data-level="7.14" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#search-and-explore-available-layers"><i class="fa fa-check"></i><b>7.14</b> Search and Explore Available Layers</a></li>
<li class="chapter" data-level="7.15" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#submit-a-point-request"><i class="fa fa-check"></i><b>7.15</b> Submit a Point Request</a>
<ul>
<li class="chapter" data-level="7.15.1" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#compile-a-json-object"><i class="fa fa-check"></i><b>7.15.1</b> Compile a JSON Object</a></li>
<li class="chapter" data-level="7.15.2" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#submit-a-task-request"><i class="fa fa-check"></i><b>7.15.2</b> Submit a Task Request</a></li>
<li class="chapter" data-level="7.15.3" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#retrieve-task-status"><i class="fa fa-check"></i><b>7.15.3</b> Retrieve Task Status</a></li>
</ul></li>
<li class="chapter" data-level="7.16" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#download-a-request"><i class="fa fa-check"></i><b>7.16</b> Download a Request</a>
<ul>
<li class="chapter" data-level="7.16.1" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#explore-files-in-request-output"><i class="fa fa-check"></i><b>7.16.1</b> Explore Files in Request Output</a></li>
</ul></li>
<li class="chapter" data-level="7.17" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#download-files-in-a-request-automation"><i class="fa fa-check"></i><b>7.17</b> Download Files in a Request (Automation)</a></li>
<li class="chapter" data-level="7.18" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#explore-appeears-quality-service"><i class="fa fa-check"></i><b>7.18</b> Explore AppEEARS Quality Service</a>
<ul>
<li class="chapter" data-level="7.18.1" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#list-quality-layers"><i class="fa fa-check"></i><b>7.18.1</b> List Quality Layers</a></li>
<li class="chapter" data-level="7.18.2" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#inspect-quality-values"><i class="fa fa-check"></i><b>7.18.2</b> Inspect Quality Values</a></li>
</ul></li>
<li class="chapter" data-level="7.19" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#decode-quality-values"><i class="fa fa-check"></i><b>7.19</b> Decode Quality Values</a></li>
<li class="chapter" data-level="7.20" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#load-request-output-and-visualize"><i class="fa fa-check"></i><b>7.20</b> Load Request Output and Visualize</a></li>
<li class="chapter" data-level="7.21" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#load-a-csv"><i class="fa fa-check"></i><b>7.21</b> Load a CSV</a></li>
<li class="chapter" data-level="7.22" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#plot-results-linescatter-plots"><i class="fa fa-check"></i><b>7.22</b> Plot Results (Line/Scatter Plots)</a></li>
<li class="chapter" data-level="7.23" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#submit-an-area-request"><i class="fa fa-check"></i><b>7.23</b> Submit an Area Request</a></li>
<li class="chapter" data-level="7.24" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#submit-an-area-request-using-a-neon-site-boundary-as-the-region-of-interest-for-extracting-elevation-vegetation-and-land-surface-temperature-data"><i class="fa fa-check"></i><b>7.24</b> Submit an area request using a NEON site boundary as the region of interest for extracting elevation, vegetation and land surface temperature data</a>
<ul>
<li class="chapter" data-level="7.24.1" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#topics-covered-in-this-tutorial"><i class="fa fa-check"></i><b>7.24.1</b> Topics Covered in this Tutorial</a></li>
<li class="chapter" data-level="7.24.2" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#prerequisites-1"><i class="fa fa-check"></i><b>7.24.2</b> Prerequisites:</a></li>
<li class="chapter" data-level="7.24.3" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#procedures"><i class="fa fa-check"></i><b>7.24.3</b> Procedures:</a></li>
<li class="chapter" data-level="7.24.4" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#appeears-information-1"><i class="fa fa-check"></i><b>7.24.4</b> AppEEARS Information:</a></li>
</ul></li>
<li class="chapter" data-level="7.25" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#getting-started-with-an-area-request"><i class="fa fa-check"></i><b>7.25</b> Getting Started with an Area Request</a>
<ul>
<li class="chapter" data-level="7.25.1" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#load-packages-for-an-area-request"><i class="fa fa-check"></i><b>7.25.1</b> Load Packages for an Area Request</a></li>
</ul></li>
<li class="chapter" data-level="7.26" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#set-up-the-output-directory-1"><i class="fa fa-check"></i><b>7.26</b> Set Up the Output Directory</a></li>
<li class="chapter" data-level="7.27" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#load-your-earth-data-token"><i class="fa fa-check"></i><b>7.27</b> Load your Earth Data Token</a></li>
<li class="chapter" data-level="7.28" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#query-available-products-1"><i class="fa fa-check"></i><b>7.28</b> Query Available Products</a></li>
<li class="chapter" data-level="7.29" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#search-and-explore-available-products-1"><i class="fa fa-check"></i><b>7.29</b> Search and Explore Available Products</a></li>
<li class="chapter" data-level="7.30" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#search-and-explore-available-layers-1"><i class="fa fa-check"></i><b>7.30</b> Search and Explore Available Layers</a></li>
<li class="chapter" data-level="7.31" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#submit-an-area-request-1"><i class="fa fa-check"></i><b>7.31</b> Submit an Area Request</a>
<ul>
<li class="chapter" data-level="7.31.1" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#load-a-shapefile"><i class="fa fa-check"></i><b>7.31.1</b> Load a Shapefile</a></li>
</ul></li>
<li class="chapter" data-level="7.32" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#search-and-explore-available-projections"><i class="fa fa-check"></i><b>7.32</b> Search and Explore Available Projections</a></li>
<li class="chapter" data-level="7.33" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#compile-a-json-object-1"><i class="fa fa-check"></i><b>7.33</b> Compile a JSON Object</a></li>
<li class="chapter" data-level="7.34" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#submit-a-task-request-1"><i class="fa fa-check"></i><b>7.34</b> Submit a Task Request</a></li>
<li class="chapter" data-level="7.35" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#retrieve-task-status-1"><i class="fa fa-check"></i><b>7.35</b> Retrieve Task Status</a></li>
<li class="chapter" data-level="7.36" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#download-a-request-1"><i class="fa fa-check"></i><b>7.36</b> Download a Request</a>
<ul>
<li class="chapter" data-level="7.36.1" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#explore-files-in-request-output-1"><i class="fa fa-check"></i><b>7.36.1</b> Explore Files in Request Output</a></li>
</ul></li>
<li class="chapter" data-level="7.37" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#download-files-in-a-request-automation-1"><i class="fa fa-check"></i><b>7.37</b> Download Files in a Request (Automation)</a></li>
<li class="chapter" data-level="7.38" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#explore-appeears-quality-service-1"><i class="fa fa-check"></i><b>7.38</b> Explore AppEEARS Quality Service</a></li>
<li class="chapter" data-level="7.39" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#list-quality-layers-1"><i class="fa fa-check"></i><b>7.39</b> List Quality Layers</a></li>
<li class="chapter" data-level="7.40" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#show-quality-values"><i class="fa fa-check"></i><b>7.40</b> Show Quality Values</a></li>
<li class="chapter" data-level="7.41" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#decode-quality-values-1"><i class="fa fa-check"></i><b>7.41</b> Decode Quality Values</a></li>
<li class="chapter" data-level="7.42" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#bonus-load-request-output-and-visualize"><i class="fa fa-check"></i><b>7.42</b> BONUS: Load Request Output and Visualize</a></li>
<li class="chapter" data-level="7.43" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#load-a-geotiff"><i class="fa fa-check"></i><b>7.43</b> Load a GeoTIFF</a></li>
<li class="chapter" data-level="7.44" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#plot-a-geotiff"><i class="fa fa-check"></i><b>7.44</b> Plot a GeoTIFF</a></li>
<li class="chapter" data-level="7.45" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#nasa-eos-coding-lab-2"><i class="fa fa-check"></i><b>7.45</b> NASA EOS Coding Lab #2</a></li>
<li class="chapter" data-level="7.46" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#nasa-eos-written-questions"><i class="fa fa-check"></i><b>7.46</b> NASA EOS Written Questions</a></li>
<li class="chapter" data-level="7.47" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#nasa-eos-culmination-write-up"><i class="fa fa-check"></i><b>7.47</b> NASA EOS Culmination Write Up</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html"><i class="fa fa-check"></i><b>8</b> USGS National Water Information System (NWIS)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#usgs-mission"><i class="fa fa-check"></i><b>8.1</b> USGS Mission:</a></li>
<li class="chapter" data-level="8.2" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#usgs-water-resources-mission"><i class="fa fa-check"></i><b>8.2</b> USGS Water Resources Mission:</a></li>
<li class="chapter" data-level="8.3" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#types-of-usgs-nwis-data"><i class="fa fa-check"></i><b>8.3</b> Types of USGS NWIS Data</a></li>
<li class="chapter" data-level="8.4" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#usgs-r-packages-collaborative-and-reproducible-data-analysis-using-r"><i class="fa fa-check"></i><b>8.4</b> USGS R Packages: Collaborative and reproducible data analysis using R</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#suggested-prerequisite-knowledge"><i class="fa fa-check"></i><b>8.4.1</b> Suggested prerequisite knowledge</a></li>
<li class="chapter" data-level="8.4.2" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#course-outline"><i class="fa fa-check"></i><b>8.4.2</b> Course outline</a></li>
<li class="chapter" data-level="8.4.3" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#software-requirements"><i class="fa fa-check"></i><b>8.4.3</b> Software requirements</a></li>
<li class="chapter" data-level="8.4.4" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#lesson-summary"><i class="fa fa-check"></i><b>8.4.4</b> Lesson Summary</a></li>
<li class="chapter" data-level="8.4.5" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#lesson-objectives"><i class="fa fa-check"></i><b>8.4.5</b> Lesson Objectives</a></li>
<li class="chapter" data-level="8.4.6" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#lesson-resources"><i class="fa fa-check"></i><b>8.4.6</b> Lesson Resources</a></li>
<li class="chapter" data-level="8.4.7" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#lesson-slide-deck"><i class="fa fa-check"></i><b>8.4.7</b> Lesson Slide Deck</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#introduction-to-usgs-r-packages"><i class="fa fa-check"></i><b>8.5</b> Introduction to USGS R Packages</a></li>
<li class="chapter" data-level="8.6" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#data-available"><i class="fa fa-check"></i><b>8.6</b> Data available</a></li>
<li class="chapter" data-level="8.7" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#common-nwis-function-arguments"><i class="fa fa-check"></i><b>8.7</b> Common NWIS function arguments</a></li>
<li class="chapter" data-level="8.8" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#discovering-nwis-data"><i class="fa fa-check"></i><b>8.8</b> Discovering NWIS data</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#whatnwisdata"><i class="fa fa-check"></i><b>8.8.1</b> whatNWISdata</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#common-wqp-function-arguments"><i class="fa fa-check"></i><b>8.9</b> Common WQP function arguments</a></li>
<li class="chapter" data-level="8.10" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#discovering-wqp-data"><i class="fa fa-check"></i><b>8.10</b> Discovering WQP data</a>
<ul>
<li class="chapter" data-level="8.10.1" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readwqpdata-querysummary"><i class="fa fa-check"></i><b>8.10.1</b> readWQPdata + querySummary</a></li>
<li class="chapter" data-level="8.10.2" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#whatwqpsites"><i class="fa fa-check"></i><b>8.10.2</b> whatWQPsites</a></li>
</ul></li>
<li class="chapter" data-level="8.11" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readnwis-functions"><i class="fa fa-check"></i><b>8.11</b> readNWIS functions</a>
<ul>
<li class="chapter" data-level="8.11.1" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readnwisdata"><i class="fa fa-check"></i><b>8.11.1</b> readNWISdata</a></li>
<li class="chapter" data-level="8.11.2" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readnwisdv"><i class="fa fa-check"></i><b>8.11.2</b> readNWISdv</a></li>
<li class="chapter" data-level="8.11.3" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readnwisgwl"><i class="fa fa-check"></i><b>8.11.3</b> readNWISgwl</a></li>
<li class="chapter" data-level="8.11.4" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readnwismeas"><i class="fa fa-check"></i><b>8.11.4</b> readNWISmeas</a></li>
<li class="chapter" data-level="8.11.5" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readnwispcode"><i class="fa fa-check"></i><b>8.11.5</b> readNWISpCode</a></li>
<li class="chapter" data-level="8.11.6" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readnwispeak"><i class="fa fa-check"></i><b>8.11.6</b> readNWISpeak</a></li>
<li class="chapter" data-level="8.11.7" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readnwisqw"><i class="fa fa-check"></i><b>8.11.7</b> readNWISqw</a></li>
<li class="chapter" data-level="8.11.8" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readnwisrating"><i class="fa fa-check"></i><b>8.11.8</b> readNWISrating</a></li>
<li class="chapter" data-level="8.11.9" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readnwissite"><i class="fa fa-check"></i><b>8.11.9</b> readNWISsite</a></li>
<li class="chapter" data-level="8.11.10" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readnwisstat"><i class="fa fa-check"></i><b>8.11.10</b> readNWISstat</a></li>
<li class="chapter" data-level="8.11.11" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readnwisuse"><i class="fa fa-check"></i><b>8.11.11</b> readNWISuse</a></li>
<li class="chapter" data-level="8.11.12" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readnwisuv"><i class="fa fa-check"></i><b>8.11.12</b> readNWISuv</a></li>
</ul></li>
<li class="chapter" data-level="8.12" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#additional-features"><i class="fa fa-check"></i><b>8.12</b> Additional Features</a>
<ul>
<li class="chapter" data-level="8.12.1" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#accessing-attributes"><i class="fa fa-check"></i><b>8.12.1</b> Accessing attributes</a></li>
<li class="chapter" data-level="8.12.2" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#using-lists-as-input"><i class="fa fa-check"></i><b>8.12.2</b> Using lists as input</a></li>
<li class="chapter" data-level="8.12.3" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#helper-functions"><i class="fa fa-check"></i><b>8.12.3</b> Helper functions</a></li>
</ul></li>
<li class="chapter" data-level="8.13" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readwqp-functions"><i class="fa fa-check"></i><b>8.13</b> readWQP functions</a>
<ul>
<li class="chapter" data-level="8.13.1" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readwqpdata"><i class="fa fa-check"></i><b>8.13.1</b> readWQPdata</a></li>
<li class="chapter" data-level="8.13.2" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readwqpqw"><i class="fa fa-check"></i><b>8.13.2</b> readWQPqw</a></li>
</ul></li>
<li class="chapter" data-level="8.14" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#attributes-and-metadata"><i class="fa fa-check"></i><b>8.14</b> Attributes and metadata</a></li>
<li class="chapter" data-level="8.15" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#usgs-coding-lab-exercises"><i class="fa fa-check"></i><b>8.15</b> USGS Coding Lab Exercises</a>
<ul>
<li class="chapter" data-level="8.15.1" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#just-how-dry-was-the-2020-monsoon"><i class="fa fa-check"></i><b>8.15.1</b> Just how dry was the 2020 monsoon?</a></li>
</ul></li>
<li class="chapter" data-level="8.16" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#geoknife---introduction"><i class="fa fa-check"></i><b>8.16</b> geoKnife - Introduction</a></li>
<li class="chapter" data-level="8.17" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#lesson-summary-1"><i class="fa fa-check"></i><b>8.17</b> Lesson Summary</a></li>
<li class="chapter" data-level="8.18" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#lesson-objectives-1"><i class="fa fa-check"></i><b>8.18</b> Lesson Objectives</a></li>
<li class="chapter" data-level="8.19" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#lesson-resources-1"><i class="fa fa-check"></i><b>8.19</b> Lesson Resources</a></li>
<li class="chapter" data-level="8.20" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#remote-processing"><i class="fa fa-check"></i><b>8.20</b> Remote processing</a></li>
<li class="chapter" data-level="8.21" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#geoknife-components-fabric-stencil-knife"><i class="fa fa-check"></i><b>8.21</b> geoknife components: fabric, stencil, knife</a></li>
<li class="chapter" data-level="8.22" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#available-webdata"><i class="fa fa-check"></i><b>8.22</b> Available webdata</a>
<ul>
<li class="chapter" data-level="8.22.1" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#gdp-datasets"><i class="fa fa-check"></i><b>8.22.1</b> GDP datasets</a></li>
<li class="chapter" data-level="8.22.2" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#datasets-not-in-gdp"><i class="fa fa-check"></i><b>8.22.2</b> Datasets not in GDP</a></li>
</ul></li>
<li class="chapter" data-level="8.23" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#available-webgeoms"><i class="fa fa-check"></i><b>8.23</b> Available webgeoms</a></li>
<li class="chapter" data-level="8.24" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#available-webprocesses"><i class="fa fa-check"></i><b>8.24</b> Available webprocesses</a></li>
<li class="chapter" data-level="8.25" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#setting-up-a-geojob"><i class="fa fa-check"></i><b>8.25</b> Setting up a geojob</a></li>
<li class="chapter" data-level="8.26" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#checking-the-geojob-status"><i class="fa fa-check"></i><b>8.26</b> Checking the geojob status</a></li>
<li class="chapter" data-level="8.27" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#getting-geojob-data"><i class="fa fa-check"></i><b>8.27</b> Getting geojob data</a></li>
<li class="chapter" data-level="8.28" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#wait-and-email"><i class="fa fa-check"></i><b>8.28</b> <code>wait</code> and <code>email</code></a></li>
<li class="chapter" data-level="8.29" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#putting-it-all-together-mapping-precipitation-from-tropical-storm-colin"><i class="fa fa-check"></i><b>8.29</b> Putting it all together, mapping precipitation from Tropical Storm Colin</a></li>
<li class="chapter" data-level="8.30" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#usgs-nwis-culmination-write-up"><i class="fa fa-check"></i><b>8.30</b> USGS NWIS Culmination Write Up</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html"><i class="fa fa-check"></i>Frequently Asked Questions:</a>
<ul>
<li class="chapter" data-level="8.31" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#where-can-i-find-due-dates-for-assignments"><i class="fa fa-check"></i><b>8.31</b> Where can I find due dates for assignments?</a></li>
<li class="chapter" data-level="8.32" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#how-do-i-submit-assignments"><i class="fa fa-check"></i><b>8.32</b> How do I submit assignments?</a></li>
<li class="chapter" data-level="8.33" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#do-i-still-have-to-submit-written-exercises-as-.rmd-and-.pdf"><i class="fa fa-check"></i><b>8.33</b> Do I still have to submit written exercises as .Rmd and .pdf?</a></li>
<li class="chapter" data-level="8.34" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#whats-better-for-code-conciseness-or-readability"><i class="fa fa-check"></i><b>8.34</b> What’s better for code, conciseness or readability?</a></li>
<li class="chapter" data-level="8.35" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#how-find-i-find-resources-to-navigate-the-neon-data-portal"><i class="fa fa-check"></i><b>8.35</b> How find I find resources to navigate the NEON Data Portal?</a></li>
<li class="chapter" data-level="8.36" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#how-can-i-best-prepare-for-class-and-succeed"><i class="fa fa-check"></i><b>8.36</b> How can I best prepare for class and succeed?</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="fall-2020-ignite-session.html"><a href="fall-2020-ignite-session.html"><i class="fa fa-check"></i><b>9</b> Fall 2020 IGNITE Session</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rdboone/katharynduffy.github.io" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Environmental Informatics Using Research Infrastructures and their Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="neon-aop" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> NEON AOP<a href="neon-aop.html#neon-aop" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<iframe width="560" height="315" src="https://www.youtube.com/embed/f5e-X9dMnXs" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<div id="hyperspectral-remote-sensing" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Hyperspectral Remote Sensing<a href="neon-aop.html#hyperspectral-remote-sensing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="learning-objectives-2" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Learning Objectives<a href="neon-aop.html#learning-objectives-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>After completing this tutorial, you will be able to:</p>
<ul>
<li>Define hyperspectral remote sensing.</li>
<li>Explain the fundamental principles of hyperspectral remote sensing data.</li>
<li>Describe the key attributes that are required to effectively work with
hyperspectral remote sensing data in tools like R or Python.</li>
<li>Describe what a “band” is.</li>
</ul>
</div>
</div>
</div>
</div>
<div id="mapping-the-invisible" class="section level4 hasAnchor" number="6.1.1.1">
<h4><span class="header-section-number">6.1.1.1</span> Mapping the Invisible<a href="neon-aop.html#mapping-the-invisible" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<iframe width="640" height="360" src="https://www.youtube.com/embed/3iaFzafWJQE?rel=0" frameborder="0" allowfullscreen>
</iframe>
</div>
<div id="about-hyperspectral-remote-sensing-data" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> About Hyperspectral Remote Sensing Data<a href="neon-aop.html#about-hyperspectral-remote-sensing-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The electromagnetic spectrum is composed of thousands of bands representing
different types of light energy. Imaging spectrometers (instruments that collect
hyperspectral data) break the electromagnetic spectrum into groups of bands
that support classification of objects by their spectral properties on the
earth’s surface. Hyperspectral data consists of many bands – up to hundreds of
bands – that cover the electromagnetic spectrum.</p>
<p>The NEON imaging spectrometer collects data within the 380nm to 2510nm portions
of the electromagnetic spectrum within bands that are approximately 5nm in
width. This results in a hyperspectral data cube that contains approximately
426 bands - which means big, big data.</p>
</div>
<div id="key-metadata-for-hyperspectral-data" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Key Metadata for Hyperspectral Data<a href="neon-aop.html#key-metadata-for-hyperspectral-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="bands-and-wavelengths" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Bands and Wavelengths<a href="neon-aop.html#bands-and-wavelengths" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A <em>band</em> represents a group of wavelengths. For example, the wavelength values
between 695nm and 700nm might be one band as captured by an imaging spectrometer.
The imaging spectrometer collects reflected light energy in a pixel for light
in that band. Often when you work with a multi or hyperspectral dataset, the
band information is reported as the center wavelength value. This value
represents the center point value of the wavelengths represented in that band.
Thus in a band spanning 695-700 nm, the center would be 697.5).</p>
<p><img src="https://raw.githubusercontent.com/NEONScience/NEON-Data-Skills/dev-aten/graphics/hyperspectral-general/spectrumZoomed.png" /></p>
<blockquote>
<p>Imaging spectrometers collect reflected light information within
defined bands or regions of the electromagnetic spectrum. Source: National
Ecological Observatory Network (NEON)</p>
</blockquote>
</div>
<div id="spectral-resolution" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Spectral Resolution<a href="neon-aop.html#spectral-resolution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The spectral resolution of a dataset that has more than one band, refers to the
width of each band in the dataset. In the example above, a band was defined as
spanning 695-700nm. The width or spatial resolution of the band is thus 5
nanometers. To see an example of this, check out the band widths for the
<a href="http://landsat.usgs.gov/band_designations_landsat_satellites.php" target="_blank">Landsat sensors</a>.</p>
</div>
<div id="full-width-half-max-fwhm" class="section level3 hasAnchor" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> Full Width Half Max (FWHM)<a href="neon-aop.html#full-width-half-max-fwhm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The full width half max (FWHM) will also often be reported in a multi or
hyperspectral dataset. This value represents the spread of the band around that
center point.</p>
<p><img src="https://raw.githubusercontent.com/NEONScience/NEON-Data-Skills/dev-aten/graphics/hyperspectral-general/FWHM2.png" /></p>
<blockquote>
<p>The Full Width Half Max (FWHM) of a band relates to the distance
in nanometers between the band center and the edge of the band. In this
case, the FWHM for Band C is 5 nm.</p>
</blockquote>
<p>In the illustration above, the band that covers 695-700nm has a FWHM of 5 nm.
While a general spectral resolution of the sensor is often provided, not all
sensors create bands of uniform widths. For instance bands 1-9 of Landsat 8 are
listed below (Courtesy of <a href="http://landsat.usgs.gov" target="_blank">USGS</a>)</p>
<table>
<colgroup>
<col width="40%" />
<col width="19%" />
<col width="21%" />
<col width="17%" />
</colgroup>
<thead>
<tr class="header">
<th>Band</th>
<th>Wavelength range (microns)</th>
<th>Spatial Resolution (m)</th>
<th>Spectral Width (microns)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Band 1 - Coastal aerosol</td>
<td>0.43 - 0.45</td>
<td>30</td>
<td>0.02</td>
</tr>
<tr class="even">
<td>Band 2 - Blue</td>
<td>0.45 - 0.51</td>
<td>30</td>
<td>0.06</td>
</tr>
<tr class="odd">
<td>Band 3 - Green</td>
<td>0.53 - 0.59</td>
<td>30</td>
<td>0.06</td>
</tr>
<tr class="even">
<td>Band 4 - Red</td>
<td>0.64 - 0.67</td>
<td>30</td>
<td>0.03</td>
</tr>
<tr class="odd">
<td>Band 5 - Near Infrared (NIR)</td>
<td>0.85 - 0.88</td>
<td>30</td>
<td>0.03</td>
</tr>
<tr class="even">
<td>Band 6 - SWIR 1</td>
<td>1.57 - 1.65</td>
<td>30</td>
<td>0.08</td>
</tr>
<tr class="odd">
<td>Band 7 - SWIR 2</td>
<td>2.11 - 2.29</td>
<td>30</td>
<td>0.18</td>
</tr>
<tr class="even">
<td>Band 8 - Panchromatic</td>
<td>0.50 - 0.68</td>
<td>15</td>
<td>0.18</td>
</tr>
<tr class="odd">
<td>Band 9 - Cirrus</td>
<td>1.36 - 1.38</td>
<td>30</td>
<td>0.02</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="intro-to-working-with-hyperspectral-remote-sensing-data-in-hdf5-format" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Intro to Working with Hyperspectral Remote Sensing Data in HDF5 Format<a href="neon-aop.html#intro-to-working-with-hyperspectral-remote-sensing-data-in-hdf5-format" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>Contributors: Felipe Sanchez, Leah A. Wasser, Edmund Hart, Donal O’Leary
Based on NEON Science Tutorial Series: <a href="https://www.neonscience.org/intro-hsi-r-series" class="uri">https://www.neonscience.org/intro-hsi-r-series</a></p>
</blockquote>
<p>In this tutorial, we will explore reading and extracting spatial raster data
stored within a HDF5 file using R.</p>
<div id="ds-objectives" markdown="1">
<div id="learning-objectives-3" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Learning Objectives<a href="neon-aop.html#learning-objectives-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>After completing this section, you will be able to:</p>
<ul>
<li>Explain how HDF5 data can be used to store spatial data and the associated
benefits of this format when working with large spatial data cubes.</li>
<li>Extract metadata from HDF5 files.</li>
<li>Slice or subset HDF5 data. You will extract one band of pixels.</li>
<li>Plot a matrix as an image and a raster.</li>
<li>Export a final GeoTIFF (spatially projected) that can be used both in further
analysis and in common GIS tools like QGIS.</li>
</ul>
</div>
<div id="r-libraries-to-install" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> R Libraries to Install:<a href="neon-aop.html#r-libraries-to-install" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>rhdf5</strong>: <code>install.packages("BiocManager")</code>, <code>BiocManager::install("rhdf5")</code></li>
<li><strong>raster</strong>: <code>install.packages('raster')</code></li>
<li><strong>rgdal</strong>: <code>install.packages('rgdal')</code></li>
</ul>
</div>
<div id="data-to-download" class="section level3 hasAnchor" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> Data to Download<a href="neon-aop.html#data-to-download" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<h3>
<a href="https://ndownloader.figshare.com/files/21754221">
Download NEON Teaching Data Subset: Imaging Spectrometer Data - HDF5 </a>
</h3>
<p>These hyperspectral remote sensing data provide information on the
<a href="https://www.neonscience.org/" target="_blank"> National Ecological Observatory Network’s</a>
<a href="https://www.neonscience.org/field-sites/field-sites-map/SJER" target="_blank" > San Joaquin
Exerimental Range field site</a> in March of 2019.
The data were collected over the San Joaquin field site located in California
(Domain 17) and processed at NEON headquarters. This data subset is derived from
the mosaic tile named NEON_D17_SJER_DP3_257000_4112000_reflectance.h5.
The entire dataset can be accessed by request from the
<a href="http://data.neonscience.org" target="_blank"> NEON Data Portal</a>.</p>
<p><a href="https://ndownloader.figshare.com/files/21754221" class="link--button link--arrow">
Download Dataset</a></p>
<p><strong>Remember</strong> that the example dataset linked here only has 1 out of every 4 bands
included in a full NEON hyperspectral dataset (this substantially reduces the file
size!). When we refer to bands in this section, we will note the band numbers for
this example dataset, which are different from NEON production data. To convert
a band number (b) from this example data subset to the equivalent band in a full
NEON hyperspectral file (b’), use the following equation: b’ = 1+4*(b-1).</p>
</div>
<div id="about-hyperspectral-remote-sensing-data-1" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> About Hyperspectral Remote Sensing Data<a href="neon-aop.html#about-hyperspectral-remote-sensing-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The electromagnetic spectrum is composed of thousands of bands representing
different types of light energy. Imaging spectrometers (instruments that collect
hyperspectral data) break the electromagnetic spectrum into groups of bands that
support classification of objects by their spectral properties on the Earth’s
surface. Hyperspectral data consists of many bands - up to hundreds of bands -
that cover the electromagnetic spectrum.</p>
<p>The NEON imaging spectrometer (NIS) collects data within the 380 nm to 2510 nm
portions of the electromagnetic spectrum within bands that are approximately 5 nm
in width. This results in a hyperspectral data cube that contains approximately
428 bands - which means BIG DATA. <em>Remember</em> that the example dataset used
here only has 1 out of every 4 bands included in a full NEON hyperspectral dataset
(this substantially reduces size!). When we refer to bands in this tutorial,
we will note the band numbers for this example dataset, which may be different
from NEON production data.</p>
<p><img src="https://raw.githubusercontent.com/NEONScience/NEON-Data-Skills/dev-aten/graphics/hyperspectral-general/DataCube.png" /></p>
<blockquote>
<p>A data cube of NEON hyperspectral data. Each layer in the cube
represents a band.</p>
</blockquote>
<p>The HDF5 data model natively compresses data stored within it (makes it smaller)
and supports data slicing (extracting only the portions of the data that you
need to work with rather than reading the entire dataset into memory). These
features in addition to the ability to support spatial data and associated
metadata make it ideal for working with large data cubes such as those generated
by imaging spectrometers.</p>
<p>In this section we will explore reading and extracting spatial raster data
stored within a HDF5 file using R.</p>
</div>
<div id="read-hdf5-data-into-r" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Read HDF5 data into R<a href="neon-aop.html#read-hdf5-data-into-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will use the <code>raster</code> and <code>rhdf5</code> packages to read in the HDF5 file that
contains hyperspectral data for the
<a href="https://www.neonscience.org/field-sites/field-sites-map/SJER" target="_blank">NEON San Joaquin (SJER) field site</a>.
Let’s start by calling the needed packages and reading in our NEON HDF5 file.</p>
<p>Please be sure that you have <em>at least</em> version 2.10 of <code>rhdf5</code> installed. Use:
<code>packageVersion("rhdf5")</code> to check the package version.</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="neon-aop.html#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load `raster` and `rhdf5` packages and read NIS data into R</span></span>
<span id="cb416-2"><a href="neon-aop.html#cb416-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span></code></pre></div>
<pre><code>## Loading required package: sp</code></pre>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="neon-aop.html#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rhdf5)</span>
<span id="cb418-2"><a href="neon-aop.html#cb418-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgdal)</span></code></pre></div>
<pre><code>## Please note that rgdal will be retired by the end of 2023,
## plan transition to sf/stars/terra functions using GDAL and PROJ
## at your earliest convenience.
## 
## rgdal: version: 1.5-32, (SVN revision 1176)
## Geospatial Data Abstraction Library extensions to R successfully loaded
## Loaded GDAL runtime: GDAL 3.4.3, released 2022/04/22
## Path to GDAL shared files: C:/Users/rohan/AppData/Local/R/win-library/4.2/rgdal/gdal
## GDAL binary built with GEOS: TRUE 
## Loaded PROJ runtime: Rel. 7.2.1, January 1st, 2021, [PJ_VERSION: 721]
## Path to PROJ shared files: C:/Users/rohan/AppData/Local/R/win-library/4.2/rgdal/proj
## PROJ CDN enabled: FALSE
## Linking to sp version:1.5-0
## To mute warnings of possible GDAL/OSR exportToProj4() degradation,
## use options(&quot;rgdal_show_exportToProj4_warnings&quot;=&quot;none&quot;) before loading sp or rgdal.</code></pre>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="neon-aop.html#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the file name to be opened</span></span>
<span id="cb420-2"><a href="neon-aop.html#cb420-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> (<span class="st">&#39;./data/NEON_hyperspectral_tutorial_example_subset.h5&#39;</span>)</span></code></pre></div>
<div id="ds-dataTip" markdown="1">
<p><i class="fa fa-star"></i> <strong>Data Tip:</strong> To update all packages installed in
R, use <code>update.packages()</code>.</p>
</div>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="neon-aop.html#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="co"># look at the HDF5 file structure </span></span>
<span id="cb421-2"><a href="neon-aop.html#cb421-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">h5ls</span>(f,<span class="at">all=</span>T))</span></code></pre></div>
<p>When you look at the structure of the data, take note of the “map info” dataset,
the “Coordinate_System” group, and the “wavelength” and “Reflectance” datasets. The
“Coordinate_System” folder contains the spatial attributes of the data including its
EPSG Code, which is easily converted to a Coordinate Reference System (CRS).
The CRS documents how the data are physically located on the Earth. The “wavelength”
dataset contains the middle wavelength values for each band in the data. The
“Reflectance” dataset contains the image data that we will use for both data processing
and visualization.</p>
<p>More Information on raster metadata:</p>
<ul>
<li><p><a href="https://www.neonscience.org/raster-data-r" target="_blank"> Raster Data in R</p></li>
<li><p>The Basics</a> - this tutorial explains more about how rasters work in R and
their associated metadata.</p></li>
<li><p><a href="https://www.neonscience.org/hyper-spec-intro" target="_blank"> About
Hyperspectral Remote Sensing Data</a> -this tutorial explains more about
metadata and important concepts associated with multi-band (multi and
hyperspectral) rasters.</p></li>
</ul>
<div id="ds-dataTip" markdown="1">
<p><i class="fa fa-star"></i><strong>Data Tip - HDF5 Structure:</strong> Note that the structure
of individual HDF5 files may vary depending on who produced the data. In this
case, the Wavelength and reflectance data within the file are both datasets.
However, the spatial information is contained within a group. Data downloaded from
another organization like NASA, may look different. This is why it’s important to
explore the data before diving into using it!</p>
</div>
<p>We can use the <code>h5readAttributes()</code> function to read and extract metadata from the
HDF5 file. Let’s start by learning about the wavelengths described within this file.</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="neon-aop.html#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get information about the wavelengths of this dataset</span></span>
<span id="cb422-2"><a href="neon-aop.html#cb422-2" aria-hidden="true" tabindex="-1"></a>wavelengthInfo <span class="ot">&lt;-</span> <span class="fu">h5readAttributes</span>(f,<span class="st">&quot;/SJER/Reflectance/Metadata/Spectral_Data/Wavelength&quot;</span>)</span>
<span id="cb422-3"><a href="neon-aop.html#cb422-3" aria-hidden="true" tabindex="-1"></a>wavelengthInfo</span></code></pre></div>
<pre><code>## $Description
## [1] &quot;Central wavelength of the reflectance bands.&quot;
## 
## $Units
## [1] &quot;nanometers&quot;</code></pre>
<p>Next, we can use the <code>h5read</code> function to read the data contained within the
HDF5 file. Let’s read in the wavelengths of the band centers:</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="neon-aop.html#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read in the wavelength information from the HDF5 file</span></span>
<span id="cb424-2"><a href="neon-aop.html#cb424-2" aria-hidden="true" tabindex="-1"></a>wavelengths <span class="ot">&lt;-</span> <span class="fu">h5read</span>(f,<span class="st">&quot;/SJER/Reflectance/Metadata/Spectral_Data/Wavelength&quot;</span>)</span>
<span id="cb424-3"><a href="neon-aop.html#cb424-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wavelengths)</span></code></pre></div>
<pre><code>## [1] 381.5437 401.5756 421.6075 441.6394 461.6713 481.7032</code></pre>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="neon-aop.html#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(wavelengths)</span></code></pre></div>
<pre><code>## [1] 2404.764 2424.796 2444.828 2464.860 2484.892 2504.924</code></pre>
<p>Which wavelength is band 6 associated with?</p>
<p>(Hint: look at the wavelengths
vector that we just imported and check out the data located at index 6 -
<code>wavelengths[6]</code>).</p>
<p><img src="https://raw.githubusercontent.com/NEONScience/NEON-Data-Skills/dev-aten/graphics/hyperspectral-general/bluelight_EMSpectrum.png" /></p>
<blockquote>
<p>482 nanometers falls within the blue portion of the electromagnetic spectrum. Source: National Ecological Observatory Network</p>
</blockquote>
<p>Band 6 has a associate wavelength center of 481.7032 nanometers (nm) which is
in the blue portion of the visible electromagnetic spectrum (~ 400-700 nm).</p>
<div id="bands-and-wavelengths-1" class="section level3 hasAnchor" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Bands and Wavelengths<a href="neon-aop.html#bands-and-wavelengths-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A <em>band</em> represents
a group of wavelengths. For example, the wavelength values between 695 nm and 700 nm
might be one band as captured by an imaging spectrometer. The imaging spectrometer
collects reflected light energy in a pixel for light in that band. Often when you
work with a multi or hyperspectral dataset, the band information is reported as
the center wavelength value. This value represents the center point value of the
wavelengths represented in that band. Thus in a band spanning 695-700 nm, the
center would be 697.5 nm). The full width half max (FWHM) will also be reported.
This value represents the spread of the band around that center point. So, a band
that covers 800 nm-805 nm might have a FWHM of 5 nm and a wavelength value of
802.5 nm.</p>
<p><img src="https://raw.githubusercontent.com/NEONScience/NEON-Data-Skills/dev-aten/graphics/hyperspectral-general/spectrumZoomed.png" /></p>
<blockquote>
<p>Bands represent a range of values (types of light) within the
electromagnetic spectrum. Values for each band are often represented as the
center point value of each band. Source: National Ecological Observatory
Network (NEON)</p>
</blockquote>
<p>The HDF5 dataset that we are working with in this activity may contain more
information than we need to work with. For example, we don’t necessarily need
to process all 107 bands available in this example dataset (or all 426 bands
available in a full NEON hyperspectral reflectance file, for that matter)
- if we are interested in creating a product like NDVI which only uses bands in
the near infra-red and red portions of the spectrum. Or we might only be interested
in a spatial subset of the data - perhaps a region where we have plots in the field.</p>
<p>The HDF5 format allows us to slice (or subset) the data - quickly extracting the
subset that we need to process. Let’s extract one of the green bands in our
dataset - band 9.</p>
<p>By the way - what is the center wavelength value associated
with band 9?</p>
<p>Hint: <code>wavelengths[9]</code>.</p>
<p>How do we know this band is a green band in the visible portion of the spectrum?</p>
<p>In order to effectively subset our data, let’s first read the important
reflectance metadata stored as <em>attributes</em> in the “Reflectance_Data” dataset.</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="neon-aop.html#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, we need to extract the reflectance metadata:</span></span>
<span id="cb428-2"><a href="neon-aop.html#cb428-2" aria-hidden="true" tabindex="-1"></a>reflInfo <span class="ot">&lt;-</span> <span class="fu">h5readAttributes</span>(f, <span class="st">&quot;/SJER/Reflectance/Reflectance_Data&quot;</span>)</span>
<span id="cb428-3"><a href="neon-aop.html#cb428-3" aria-hidden="true" tabindex="-1"></a>reflInfo</span></code></pre></div>
<pre><code>## $Cloud_conditions
## [1] &quot;For cloud conditions information see Weather Quality Index dataset.&quot;
## 
## $Cloud_type
## [1] &quot;Cloud type may have been selected from multiple flight trajectories.&quot;
## 
## $Data_Ignore_Value
## [1] -9999
## 
## $Description
## [1] &quot;Atmospherically corrected reflectance.&quot;
## 
## $Dimension_Labels
## [1] &quot;Line, Sample, Wavelength&quot;
## 
## $Dimensions
## [1] 500 500 107
## 
## $Interleave
## [1] &quot;BSQ&quot;
## 
## $Scale_Factor
## [1] 10000
## 
## $Spatial_Extent_meters
## [1]  257500  258000 4112500 4113000
## 
## $Spatial_Resolution_X_Y
## [1] 1 1
## 
## $Units
## [1] &quot;Unitless.&quot;
## 
## $Units_Valid_range
## [1]     0 10000
## 
## $dim
## [1] 107 500 500</code></pre>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="neon-aop.html#cb430-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Next, we read the different dimensions</span></span>
<span id="cb430-2"><a href="neon-aop.html#cb430-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-3"><a href="neon-aop.html#cb430-3" aria-hidden="true" tabindex="-1"></a>nRows <span class="ot">&lt;-</span> reflInfo<span class="sc">$</span>Dimensions[<span class="dv">1</span>]</span>
<span id="cb430-4"><a href="neon-aop.html#cb430-4" aria-hidden="true" tabindex="-1"></a>nCols <span class="ot">&lt;-</span> reflInfo<span class="sc">$</span>Dimensions[<span class="dv">2</span>]</span>
<span id="cb430-5"><a href="neon-aop.html#cb430-5" aria-hidden="true" tabindex="-1"></a>nBands <span class="ot">&lt;-</span> reflInfo<span class="sc">$</span>Dimensions[<span class="dv">3</span>]</span>
<span id="cb430-6"><a href="neon-aop.html#cb430-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-7"><a href="neon-aop.html#cb430-7" aria-hidden="true" tabindex="-1"></a>nRows</span></code></pre></div>
<pre><code>## [1] 500</code></pre>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="neon-aop.html#cb432-1" aria-hidden="true" tabindex="-1"></a>nCols</span></code></pre></div>
<pre><code>## [1] 500</code></pre>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="neon-aop.html#cb434-1" aria-hidden="true" tabindex="-1"></a>nBands</span></code></pre></div>
<pre><code>## [1] 107</code></pre>
<p>The HDF5 read function reads data in the order: Bands, Cols, Rows. This is
different from how R reads data. We’ll adjust for this later.</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="neon-aop.html#cb436-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract or &quot;slice&quot; data for band 9 from the HDF5 file</span></span>
<span id="cb436-2"><a href="neon-aop.html#cb436-2" aria-hidden="true" tabindex="-1"></a>b9 <span class="ot">&lt;-</span> <span class="fu">h5read</span>(f,<span class="st">&quot;/SJER/Reflectance/Reflectance_Data&quot;</span>,<span class="at">index=</span><span class="fu">list</span>(<span class="dv">9</span>,<span class="dv">1</span><span class="sc">:</span>nCols,<span class="dv">1</span><span class="sc">:</span>nRows)) </span>
<span id="cb436-3"><a href="neon-aop.html#cb436-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-4"><a href="neon-aop.html#cb436-4" aria-hidden="true" tabindex="-1"></a><span class="co"># what type of object is b9?</span></span>
<span id="cb436-5"><a href="neon-aop.html#cb436-5" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(b9)</span></code></pre></div>
<pre><code>## [1] &quot;array&quot;</code></pre>
</div>
<div id="a-note-about-data-slicing-in-hdf5" class="section level3 hasAnchor" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> A Note About Data Slicing in HDF5<a href="neon-aop.html#a-note-about-data-slicing-in-hdf5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Data slicing allows us to extract and work with subsets of the data rather than
reading in the entire dataset into memory. Thus, in this case, we can extract and
plot the green band without reading in all 107 bands of information. The ability
to slice large datasets makes HDF5 ideal for working with big data.</p>
<p>Next, let’s convert our data from an array (more than 2 dimensions) to a matrix
(just 2 dimensions). We need to have our data in a matrix format to plot it.</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="neon-aop.html#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert from array to matrix by selecting only the first band</span></span>
<span id="cb438-2"><a href="neon-aop.html#cb438-2" aria-hidden="true" tabindex="-1"></a>b9 <span class="ot">&lt;-</span> b9[<span class="dv">1</span>,,]</span>
<span id="cb438-3"><a href="neon-aop.html#cb438-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb438-4"><a href="neon-aop.html#cb438-4" aria-hidden="true" tabindex="-1"></a><span class="co"># check it</span></span>
<span id="cb438-5"><a href="neon-aop.html#cb438-5" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(b9)</span></code></pre></div>
<pre><code>## [1] &quot;matrix&quot; &quot;array&quot;</code></pre>
</div>
<div id="arrays-vs.-matrices" class="section level3 hasAnchor" number="6.5.3">
<h3><span class="header-section-number">6.5.3</span> Arrays vs. Matrices<a href="neon-aop.html#arrays-vs.-matrices" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Arrays are matrices with more than 2 dimensions. When we say dimension, we are
talking about the “z”
associated with the data (imagine a series of tabs in a spreadsheet). Put the other
way: matrices are arrays with only 2 dimensions. Arrays can have any number of
dimensions one, two, ten or more.</p>
<p>Here is a matrix that is 4 x 3 in size (4 rows and 3 columns):</p>
<table>
<thead>
<tr class="header">
<th>Metric</th>
<th>species 1</th>
<th>species 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>total number</td>
<td>23</td>
<td>45</td>
</tr>
<tr class="even">
<td>average weight</td>
<td>14</td>
<td>5</td>
</tr>
<tr class="odd">
<td>average length</td>
<td>2.4</td>
<td>3.5</td>
</tr>
<tr class="even">
<td>average height</td>
<td>32</td>
<td>12</td>
</tr>
</tbody>
</table>
</div>
<div id="dimensions-in-arrays" class="section level3 hasAnchor" number="6.5.4">
<h3><span class="header-section-number">6.5.4</span> Dimensions in Arrays<a href="neon-aop.html#dimensions-in-arrays" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An array contains 1 or more dimensions in the “z” direction. For example, let’s
say that we collected the same set of species data for every day in a 30 day month.
We might then have a matrix like the one above for each day for a total of 30 days
making a 4 x 3 x 30 array (this dataset has more than 2 dimensions). More on R object
types <a href="http://www.statmethods.net/input/datatypes.html">here</a>
(links to external site, DataCamp).</p>
<p><img src="https://raw.githubusercontent.com/NEONScience/NEON-Data-Skills/dev-aten/graphics/r-skills/matrix.png" /></p>
<blockquote>
<p>A matrix has only 2 dimensions</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/NEONScience/NEON-Data-Skills/dev-aten/graphics/r-skills/array.png" /></p>
<blockquote>
<p>An array has more than 2 dimensions.</p>
</blockquote>
<p>Next, let’s look at the metadata for the reflectance data. When we do this, take
note of 1) the scale factor and 2) the data ignore value. Then we can plot the
band 9 data. Plotting spatial data as a visual “data check” is a good idea to
make sure processing is being performed correctly and all is well with the image.</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="neon-aop.html#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="co"># look at the metadata for the reflectance dataset</span></span>
<span id="cb440-2"><a href="neon-aop.html#cb440-2" aria-hidden="true" tabindex="-1"></a><span class="fu">h5readAttributes</span>(f,<span class="st">&quot;/SJER/Reflectance/Reflectance_Data&quot;</span>)</span></code></pre></div>
<pre><code>## $Cloud_conditions
## [1] &quot;For cloud conditions information see Weather Quality Index dataset.&quot;
## 
## $Cloud_type
## [1] &quot;Cloud type may have been selected from multiple flight trajectories.&quot;
## 
## $Data_Ignore_Value
## [1] -9999
## 
## $Description
## [1] &quot;Atmospherically corrected reflectance.&quot;
## 
## $Dimension_Labels
## [1] &quot;Line, Sample, Wavelength&quot;
## 
## $Dimensions
## [1] 500 500 107
## 
## $Interleave
## [1] &quot;BSQ&quot;
## 
## $Scale_Factor
## [1] 10000
## 
## $Spatial_Extent_meters
## [1]  257500  258000 4112500 4113000
## 
## $Spatial_Resolution_X_Y
## [1] 1 1
## 
## $Units
## [1] &quot;Unitless.&quot;
## 
## $Units_Valid_range
## [1]     0 10000
## 
## $dim
## [1] 107 500 500</code></pre>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="neon-aop.html#cb442-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the image</span></span>
<span id="cb442-2"><a href="neon-aop.html#cb442-2" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(b9)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:read-attributes-plot"></span>
<img src="07-NEON_AOP_files/figure-html/read-attributes-plot-1.png" alt="Plot of reflectance values for band 9 data. This plot shows a very washed out image lacking any detail." width="672" />
<p class="caption">
Figure 6.1: Plot of reflectance values for band 9 data. This plot shows a very washed out image lacking any detail.
</p>
</div>
<p>That is hard to visually interpret.
What happens if we plot a log of the data?</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="neon-aop.html#cb443-1" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(<span class="fu">log</span>(b9))</span></code></pre></div>
<p><img src="07-NEON_AOP_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>What do you notice about the first image? It’s washed out and lacking any detail. What
could be causing this? It got better when plotting the log of the values, but
still not great.</p>
<p>Let’s look at the distribution of reflectance values in
our data to figure out what is going on.</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="neon-aop.html#cb444-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot range of reflectance values as a histogram to view range</span></span>
<span id="cb444-2"><a href="neon-aop.html#cb444-2" aria-hidden="true" tabindex="-1"></a><span class="co"># and distribution of values.</span></span>
<span id="cb444-3"><a href="neon-aop.html#cb444-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(b9,<span class="at">breaks=</span><span class="dv">40</span>,<span class="at">col=</span><span class="st">&quot;darkmagenta&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:hist-data-1"></span>
<img src="07-NEON_AOP_files/figure-html/hist-data-1.png" alt="Histogram of reflectance values for band 9. The x-axis represents the reflectance values and ranges from 0 to 8000. The frequency of these values is on the y-axis. The histogram shows reflectance values are skewed to the right, where the majority of the values lie between 0 and 1000. We can conclude that reflectance values are not equally distributed across the range of reflectance values, resulting in a washed out image." width="672" />
<p class="caption">
Figure 6.2: Histogram of reflectance values for band 9. The x-axis represents the reflectance values and ranges from 0 to 8000. The frequency of these values is on the y-axis. The histogram shows reflectance values are skewed to the right, where the majority of the values lie between 0 and 1000. We can conclude that reflectance values are not equally distributed across the range of reflectance values, resulting in a washed out image.
</p>
</div>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="neon-aop.html#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View values between 0 and 5000</span></span>
<span id="cb445-2"><a href="neon-aop.html#cb445-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(b9,<span class="at">breaks=</span><span class="dv">40</span>,<span class="at">col=</span><span class="st">&quot;darkmagenta&quot;</span>,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5000</span>))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:hist-data-2"></span>
<img src="07-NEON_AOP_files/figure-html/hist-data-2.png" alt="Histogram of reflectance values between 0 and 5000 for band 9. Reflectance values are on the x-axis, and the frequency is on the y-axis. The x-axis limit has been set 5000 in order to better visualize the distribution of reflectance values. We can confirm that the majority of the values are indeed within the 0 to 4000 range." width="672" />
<p class="caption">
Figure 6.3: Histogram of reflectance values between 0 and 5000 for band 9. Reflectance values are on the x-axis, and the frequency is on the y-axis. The x-axis limit has been set 5000 in order to better visualize the distribution of reflectance values. We can confirm that the majority of the values are indeed within the 0 to 4000 range.
</p>
</div>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="neon-aop.html#cb446-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View higher values</span></span>
<span id="cb446-2"><a href="neon-aop.html#cb446-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(b9, <span class="at">breaks=</span><span class="dv">40</span>,<span class="at">col=</span><span class="st">&quot;darkmagenta&quot;</span>,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">5000</span>, <span class="dv">15000</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:hist-data-3"></span>
<img src="07-NEON_AOP_files/figure-html/hist-data-3.png" alt="Histogram of reflectance values between 5000 and 15000 for band 9. Reflectance values are on the x-axis, and the frequency is on the y-axis. Plot shows that a very few number of pixels have reflectance values larger than 5,000. These values are skewing how the image is being rendered and heavily impacting the way the image is drawn on our monitor." width="672" />
<p class="caption">
Figure 6.4: Histogram of reflectance values between 5000 and 15000 for band 9. Reflectance values are on the x-axis, and the frequency is on the y-axis. Plot shows that a very few number of pixels have reflectance values larger than 5,000. These values are skewing how the image is being rendered and heavily impacting the way the image is drawn on our monitor.
</p>
</div>
<p>As you’re examining the histograms above, keep in mind that reflectance values
range between 0-1. The <strong>data scale factor</strong> in the metadata tells us to divide
all reflectance values by 10,000. Thus, a value of 5,000 equates to a reflectance
value of 0.50. Storing data as integers (without decimal places) compared to
floating points (with decimal places) creates a smaller file. You will see this
done often when working with remote sensing data.</p>
<p>Notice in the data that there are some larger reflectance values (&gt;5,000) that
represent a smaller number of pixels. These pixels are skewing how the image
renders.</p>
</div>
<div id="data-ignore-value" class="section level3 hasAnchor" number="6.5.5">
<h3><span class="header-section-number">6.5.5</span> Data Ignore Value<a href="neon-aop.html#data-ignore-value" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Image data in raster
format will often contain a data ignore value and a scale factor. The data ignore
value represents pixels where there are no data. Among other causes, no data
values may be attributed to the sensor not collecting data in that area of the
image or to processing results which yield null values.</p>
<p>Remember that the metadata for the <code>Reflectance</code> dataset designated -9999 as
<code>data ignore value</code>. Thus, let’s set all pixels with a value == -9999 to <code>NA</code>
(no value). If we do this, R won’t try to render these pixels.</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="neon-aop.html#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="co"># there is a no data value in our raster - let&#39;s define it</span></span>
<span id="cb447-2"><a href="neon-aop.html#cb447-2" aria-hidden="true" tabindex="-1"></a>myNoDataValue <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(reflInfo<span class="sc">$</span>Data_Ignore_Value)</span>
<span id="cb447-3"><a href="neon-aop.html#cb447-3" aria-hidden="true" tabindex="-1"></a>myNoDataValue</span></code></pre></div>
<pre><code>## [1] -9999</code></pre>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="neon-aop.html#cb449-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set all values equal to -9999 to NA</span></span>
<span id="cb449-2"><a href="neon-aop.html#cb449-2" aria-hidden="true" tabindex="-1"></a>b9[b9 <span class="sc">==</span> myNoDataValue] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb449-3"><a href="neon-aop.html#cb449-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb449-4"><a href="neon-aop.html#cb449-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the image now</span></span>
<span id="cb449-5"><a href="neon-aop.html#cb449-5" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(b9)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:set-values-NA"></span>
<img src="07-NEON_AOP_files/figure-html/set-values-NA-1.png" alt="Plot of reflectance values for band 9 data with values equal to -9999 set to NA. Image data in raster format will often contain no data values, which may be attributed to the sensor not collecting data in that area of the image or to processing results which yield null values. Reflectance datasets designate -9999 as data ignore values. As such, we will reassign -9999 values to NA so R won't try to render these pixels." width="672" />
<p class="caption">
Figure 6.5: Plot of reflectance values for band 9 data with values equal to -9999 set to NA. Image data in raster format will often contain no data values, which may be attributed to the sensor not collecting data in that area of the image or to processing results which yield null values. Reflectance datasets designate -9999 as data ignore values. As such, we will reassign -9999 values to NA so R won’t try to render these pixels.
</p>
</div>
</div>
<div id="reflectance-values-and-image-stretch" class="section level3 hasAnchor" number="6.5.6">
<h3><span class="header-section-number">6.5.6</span> Reflectance Values and Image Stretch<a href="neon-aop.html#reflectance-values-and-image-stretch" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Our image still looks dark because R is trying to render all reflectance values
between 0 and 14999 as if they were distributed equally in the histogram. However
we know they are not distributed equally. There are many more values between
0-5000 then there are values &gt;5000.</p>
<p>Images have a distribution of reflectance values. A typical image viewing program
will render the values by distributing the entire range of reflectance values<br />
across a range of “shades” that the monitor can render - between 0 and 255.
However, often the distribution of reflectance values is not linear. For example,
in the case of our data, most of the reflectance values fall between 0 and 0.5.
Yet there are a few values &gt;0.8 that are heavily impacting the way the image is
drawn on our monitor. Imaging processing programs like ENVI, QGIS and ArcGIS (and
even Adobe Photoshop) allow you to adjust the stretch of the image. This is similar
to adjusting the contrast and brightness in Photoshop.</p>
<p>The proper way to adjust our data would be
what’s called an <code>image stretch</code>. We will learn how to stretch our image data,
later. For now, let’s plot the values as the log function on the pixel
reflectance values to factor out those larger values.</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="neon-aop.html#cb450-1" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(<span class="fu">log</span>(b9))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:plot-log"></span>
<img src="07-NEON_AOP_files/figure-html/plot-log-1.png" alt="Plot of log transformed reflectance values for the previous b9 image. Applying the log to the image increases the contrast making it look more like an image by factoring out those larger values. While an improvement, the image is still far from great. The proper way to adjust an image is by doing whats called an image stretch." width="672" />
<p class="caption">
Figure 6.6: Plot of log transformed reflectance values for the previous b9 image. Applying the log to the image increases the contrast making it look more like an image by factoring out those larger values. While an improvement, the image is still far from great. The proper way to adjust an image is by doing whats called an image stretch.
</p>
</div>
<p>The log applied to our image increases the contrast making it look more like an
image. However, look at the images below. The top one is what our log adjusted
image looks like when plotted. The bottom on is an RGB version of the same image.
Notice a difference?</p>
<img src="https://raw.githubusercontent.com/NEONScience/NEON-Data-Skills/dev-aten/graphics/hyperspectral-general/RGBImage_2.png"
    alt="RGB image of the SJER field site. At the top right of the image, there is dark, brakish water. Scattered throughout the image, there are several trees. At the center of the image, there is a baseball field, with low grass. At the bottom left of the image, there is a parking lot and some buildings with highly reflective surfaces, and adjacent to it is a section of a gravel lot.">
</a>
<a href="https://raw.githubusercontent.com/NEONScience/NEON-Data-Skills/dev-aten/graphics/hyperspectral-general/SJER_Flipped.png">
<img src="https://raw.githubusercontent.com/NEONScience/NEON-Data-Skills/dev-aten/graphics/hyperspectral-general/SJER_Flipped.png"
    alt="Plot of log transformed reflectance values for the b9 image previously plotted. Applying the log to the image increases the contrast making it look more like an image by factoring out those larger values. While an improvement, the image is still far from great. The proper way to adjust an image is by doing whats called an image stretch. The log transformed image appears flipped because when R reads in the dataset, it reads them as: Columns x Bands x Rows, as opposed to the RGB image on the left which has dimensions as Bands x Rows x Columns.">
</a>
<figcaption>
TOP: The image as it should look. BOTTOM: the image that we outputted from the code above. Notice a difference?
</figcaption>
</div>
<div id="transpose-image" class="section level3 hasAnchor" number="6.5.7">
<h3><span class="header-section-number">6.5.7</span> Transpose Image<a href="neon-aop.html#transpose-image" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Notice that there are three data dimensions for this file: Bands x Rows x
Columns. However, when R reads in the dataset, it reads them as: Columns x
Bands x Rows. The data are flipped. We can quickly transpose the data to correct
for this using the <code>t</code> or <code>transpose</code> command in R.</p>
<p>The orientation is rotated in our log adjusted image. This is because R reads
in matrices starting from the upper left hand corner. Whereas, most rasters
read pixels starting from the lower left hand corner. In the next section, we
will deal with this issue by creating a proper georeferenced (spatially located)
raster in R. The raster format will read in pixels following the same methods
as other GIS and imaging processing software like QGIS and ENVI do.</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="neon-aop.html#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We need to transpose x and y values in order for our </span></span>
<span id="cb451-2"><a href="neon-aop.html#cb451-2" aria-hidden="true" tabindex="-1"></a><span class="co"># final image to plot properly</span></span>
<span id="cb451-3"><a href="neon-aop.html#cb451-3" aria-hidden="true" tabindex="-1"></a>b9 <span class="ot">&lt;-</span> <span class="fu">t</span>(b9)</span>
<span id="cb451-4"><a href="neon-aop.html#cb451-4" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(<span class="fu">log</span>(b9), <span class="at">main=</span><span class="st">&quot;Transposed Image&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:transpose-data"></span>
<img src="07-NEON_AOP_files/figure-html/transpose-data-1.png" alt="Plot showing the transposed image of the log transformed reflectance values of b9. The orientation of the image is rotated in our log transformed image, because R reads in the matrices starting from the upper left hand corner." width="672" />
<p class="caption">
Figure 6.7: Plot showing the transposed image of the log transformed reflectance values of b9. The orientation of the image is rotated in our log transformed image, because R reads in the matrices starting from the upper left hand corner.
</p>
</div>
</div>
</div>
<div id="create-a-georeferenced-raster" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Create a Georeferenced Raster<a href="neon-aop.html#create-a-georeferenced-raster" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Next, we will create a proper raster using the <code>b9</code> matrix. The raster
format will allow us to define and manage:</p>
<ul>
<li>Image stretch</li>
<li>Coordinate reference system &amp; spatial reference</li>
<li>Resolution</li>
<li>and other raster attributes…</li>
</ul>
<p>It will also account for the orientation issue discussed above.</p>
<p>To create a raster in R, we need a few pieces of information, including:</p>
<ul>
<li>The coordinate reference system (CRS)</li>
<li>The spatial extent of the image</li>
</ul>
<div id="define-raster-crs" class="section level3 hasAnchor" number="6.6.1">
<h3><span class="header-section-number">6.6.1</span> Define Raster CRS<a href="neon-aop.html#define-raster-crs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First, we need to define the Coordinate reference system (CRS) of the raster.
To do that, we can first grab the EPSG code from the HDF5 attributes, and covert the
EPSG to a CRS string. Then we can assign that CRS to the raster object.</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="neon-aop.html#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the EPSG from the h5 dataset</span></span>
<span id="cb452-2"><a href="neon-aop.html#cb452-2" aria-hidden="true" tabindex="-1"></a>myEPSG <span class="ot">&lt;-</span> <span class="fu">h5read</span>(f, <span class="st">&quot;/SJER/Reflectance/Metadata/Coordinate_System/EPSG Code&quot;</span>)</span>
<span id="cb452-3"><a href="neon-aop.html#cb452-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb452-4"><a href="neon-aop.html#cb452-4" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the EPSG code to a CRS string</span></span>
<span id="cb452-5"><a href="neon-aop.html#cb452-5" aria-hidden="true" tabindex="-1"></a>myCRS <span class="ot">&lt;-</span> <span class="fu">crs</span>(<span class="fu">paste0</span>(<span class="st">&quot;+init=epsg:&quot;</span>,myEPSG))</span>
<span id="cb452-6"><a href="neon-aop.html#cb452-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb452-7"><a href="neon-aop.html#cb452-7" aria-hidden="true" tabindex="-1"></a><span class="co"># define final raster with projection info </span></span>
<span id="cb452-8"><a href="neon-aop.html#cb452-8" aria-hidden="true" tabindex="-1"></a><span class="co"># note that capitalization will throw errors on a MAC.</span></span>
<span id="cb452-9"><a href="neon-aop.html#cb452-9" aria-hidden="true" tabindex="-1"></a><span class="co"># if UTM is all caps it might cause an error!</span></span>
<span id="cb452-10"><a href="neon-aop.html#cb452-10" aria-hidden="true" tabindex="-1"></a>b9r <span class="ot">&lt;-</span> <span class="fu">raster</span>(b9, </span>
<span id="cb452-11"><a href="neon-aop.html#cb452-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">crs=</span>myCRS)</span>
<span id="cb452-12"><a href="neon-aop.html#cb452-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb452-13"><a href="neon-aop.html#cb452-13" aria-hidden="true" tabindex="-1"></a><span class="co"># view the raster attributes</span></span>
<span id="cb452-14"><a href="neon-aop.html#cb452-14" aria-hidden="true" tabindex="-1"></a>b9r</span></code></pre></div>
<pre><code>## class      : RasterLayer 
## dimensions : 500, 500, 250000  (nrow, ncol, ncell)
## resolution : 0.002, 0.002  (x, y)
## extent     : 0, 1, 0, 1  (xmin, xmax, ymin, ymax)
## crs        : +proj=utm +zone=11 +datum=WGS84 +units=m +no_defs 
## source     : memory
## names      : layer 
## values     : 0, 9210  (min, max)</code></pre>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="neon-aop.html#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="co"># let&#39;s have a look at our properly oriented raster. Take note of the </span></span>
<span id="cb454-2"><a href="neon-aop.html#cb454-2" aria-hidden="true" tabindex="-1"></a><span class="co"># coordinates on the x and y axis.</span></span>
<span id="cb454-3"><a href="neon-aop.html#cb454-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-4"><a href="neon-aop.html#cb454-4" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(<span class="fu">log</span>(b9r), </span>
<span id="cb454-5"><a href="neon-aop.html#cb454-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;UTM Easting&quot;</span>, </span>
<span id="cb454-6"><a href="neon-aop.html#cb454-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&quot;UTM Northing&quot;</span>,</span>
<span id="cb454-7"><a href="neon-aop.html#cb454-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">&quot;Properly Oriented Raster&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:define-CRS"></span>
<img src="07-NEON_AOP_files/figure-html/define-CRS-1.png" alt="Plot of the properly oriented raster image of the band 9 data. In order to orient the image correctly, the coordinate reference system was defined and assigned to the raster object. X-axis represents the UTM Easting values, and the Y-axis represents the Northing values." width="672" />
<p class="caption">
Figure 6.8: Plot of the properly oriented raster image of the band 9 data. In order to orient the image correctly, the coordinate reference system was defined and assigned to the raster object. X-axis represents the UTM Easting values, and the Y-axis represents the Northing values.
</p>
</div>
<p>Next we define the extents of our raster. The extents will be used to calculate
the raster’s resolution. Fortunately, the spatial extent is provided in the
HDF5 file “Reflectance_Data” group attributes that we saved before as <code>reflInfo</code>.</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="neon-aop.html#cb455-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grab the UTM coordinates of the spatial extent</span></span>
<span id="cb455-2"><a href="neon-aop.html#cb455-2" aria-hidden="true" tabindex="-1"></a>xMin <span class="ot">&lt;-</span> reflInfo<span class="sc">$</span>Spatial_Extent_meters[<span class="dv">1</span>]</span>
<span id="cb455-3"><a href="neon-aop.html#cb455-3" aria-hidden="true" tabindex="-1"></a>xMax <span class="ot">&lt;-</span> reflInfo<span class="sc">$</span>Spatial_Extent_meters[<span class="dv">2</span>]</span>
<span id="cb455-4"><a href="neon-aop.html#cb455-4" aria-hidden="true" tabindex="-1"></a>yMin <span class="ot">&lt;-</span> reflInfo<span class="sc">$</span>Spatial_Extent_meters[<span class="dv">3</span>]</span>
<span id="cb455-5"><a href="neon-aop.html#cb455-5" aria-hidden="true" tabindex="-1"></a>yMax <span class="ot">&lt;-</span> reflInfo<span class="sc">$</span>Spatial_Extent_meters[<span class="dv">4</span>]</span>
<span id="cb455-6"><a href="neon-aop.html#cb455-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb455-7"><a href="neon-aop.html#cb455-7" aria-hidden="true" tabindex="-1"></a><span class="co"># define the extent (left, right, top, bottom)</span></span>
<span id="cb455-8"><a href="neon-aop.html#cb455-8" aria-hidden="true" tabindex="-1"></a>rasExt <span class="ot">&lt;-</span> <span class="fu">extent</span>(xMin,xMax,yMin,yMax)</span>
<span id="cb455-9"><a href="neon-aop.html#cb455-9" aria-hidden="true" tabindex="-1"></a>rasExt</span></code></pre></div>
<pre><code>## class      : Extent 
## xmin       : 257500 
## xmax       : 258000 
## ymin       : 4112500 
## ymax       : 4113000</code></pre>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="neon-aop.html#cb457-1" aria-hidden="true" tabindex="-1"></a><span class="co"># assign the spatial extent to the raster</span></span>
<span id="cb457-2"><a href="neon-aop.html#cb457-2" aria-hidden="true" tabindex="-1"></a><span class="fu">extent</span>(b9r) <span class="ot">&lt;-</span> rasExt</span>
<span id="cb457-3"><a href="neon-aop.html#cb457-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb457-4"><a href="neon-aop.html#cb457-4" aria-hidden="true" tabindex="-1"></a><span class="co"># look at raster attributes</span></span>
<span id="cb457-5"><a href="neon-aop.html#cb457-5" aria-hidden="true" tabindex="-1"></a>b9r</span></code></pre></div>
<pre><code>## class      : RasterLayer 
## dimensions : 500, 500, 250000  (nrow, ncol, ncell)
## resolution : 1, 1  (x, y)
## extent     : 257500, 258000, 4112500, 4113000  (xmin, xmax, ymin, ymax)
## crs        : +proj=utm +zone=11 +datum=WGS84 +units=m +no_defs 
## source     : memory
## names      : layer 
## values     : 0, 9210  (min, max)</code></pre>
<p><img src="https://raw.githubusercontent.com/NEONScience/NEON-Data-Skills/dev-aten/graphics/raster-general/sat_image_lat_lon.png" /></p>
<blockquote>
<p>The extent of a raster represents the spatial location of each
corner. The coordinate units will be determined by the spatial projection/
coordinate reference system that the data are in. Source: National Ecological
Observatory Network (NEON)</p>
</blockquote>
<p><a href="https://www.neonscience.org/raster-data-series" target="_blank"> Learn more about raster attributes including extent, and coordinate reference systems here.</a></p>
<p>We can adjust the colors of our raster too if we want.</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="neon-aop.html#cb459-1" aria-hidden="true" tabindex="-1"></a><span class="co"># let&#39;s change the colors of our raster and adjust the zlims </span></span>
<span id="cb459-2"><a href="neon-aop.html#cb459-2" aria-hidden="true" tabindex="-1"></a>col <span class="ot">&lt;-</span> <span class="fu">terrain.colors</span>(<span class="dv">25</span>)</span>
<span id="cb459-3"><a href="neon-aop.html#cb459-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb459-4"><a href="neon-aop.html#cb459-4" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(b9r,  </span>
<span id="cb459-5"><a href="neon-aop.html#cb459-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;UTM Easting&quot;</span>, </span>
<span id="cb459-6"><a href="neon-aop.html#cb459-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&quot;UTM Northing&quot;</span>,</span>
<span id="cb459-7"><a href="neon-aop.html#cb459-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span> <span class="st">&quot;Raster w Custom Colors&quot;</span>,</span>
<span id="cb459-8"><a href="neon-aop.html#cb459-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">col=</span>col, </span>
<span id="cb459-9"><a href="neon-aop.html#cb459-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">zlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3000</span>))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:plot-colors-raster"></span>
<img src="07-NEON_AOP_files/figure-html/plot-colors-raster-1.png" alt="Plot of the properly oriented raster image of B9 with custom colors. We can adjust the colors of the image by adjusting the z limits, which in this case makes the highly reflective surfaces more vibrant. This color adjustment is more apparent in the bottom left of the image, where the parking lot, buildings and bare surfaces are located. X-axis represents the UTM Easting values, and the Y-axis represents the Northing values." width="672" />
<p class="caption">
Figure 6.9: Plot of the properly oriented raster image of B9 with custom colors. We can adjust the colors of the image by adjusting the z limits, which in this case makes the highly reflective surfaces more vibrant. This color adjustment is more apparent in the bottom left of the image, where the parking lot, buildings and bare surfaces are located. X-axis represents the UTM Easting values, and the Y-axis represents the Northing values.
</p>
</div>
<p>We’ve now created a raster from band 9 reflectance data. We can export the data
as a raster, using the <code>writeRaster</code> command.</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="neon-aop.html#cb460-1" aria-hidden="true" tabindex="-1"></a><span class="co"># write out the raster as a geotiff</span></span>
<span id="cb460-2"><a href="neon-aop.html#cb460-2" aria-hidden="true" tabindex="-1"></a><span class="fu">writeRaster</span>(b9r,</span>
<span id="cb460-3"><a href="neon-aop.html#cb460-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">file=</span><span class="fu">paste0</span>(wd,<span class="st">&quot;band9.tif&quot;</span>),</span>
<span id="cb460-4"><a href="neon-aop.html#cb460-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">format=</span><span class="st">&quot;GTiff&quot;</span>,</span>
<span id="cb460-5"><a href="neon-aop.html#cb460-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">overwrite=</span><span class="cn">TRUE</span>)</span>
<span id="cb460-6"><a href="neon-aop.html#cb460-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb460-7"><a href="neon-aop.html#cb460-7" aria-hidden="true" tabindex="-1"></a><span class="co"># It&#39;s always good practice to close the H5 connection before moving on!</span></span>
<span id="cb460-8"><a href="neon-aop.html#cb460-8" aria-hidden="true" tabindex="-1"></a><span class="co"># close the H5 file</span></span>
<span id="cb460-9"><a href="neon-aop.html#cb460-9" aria-hidden="true" tabindex="-1"></a><span class="fu">H5close</span>()</span></code></pre></div>
</div>
<div id="challenge-work-with-rasters" class="section level3 hasAnchor" number="6.6.2">
<h3><span class="header-section-number">6.6.2</span> Challenge: Work with Rasters<a href="neon-aop.html#challenge-work-with-rasters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Try these three extensions on your own:</p>
<ol style="list-style-type: decimal">
<li><p>Create rasters using other bands in the dataset.</p></li>
<li><p>Vary the distribution of values in the image to mimic an image stretch.
e.g. <code>b9[b9 &gt; 6000 ] &lt;- 6000</code></p></li>
<li><p>Use what you know to extract ALL of the reflectance values for
ONE pixel rather than for an entire band. HINT: this will require you to pick
an x and y value and then all values in the z dimension:
<code>aPixel&lt;- h5read(f,"Reflectance",index=list(NULL,100,35))</code>. Plot the spectra
output.</p></li>
</ol>
</div>
</div>
</div>
<hr />
</div>
<div id="light-detection-and-ranging-lidar-data" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> Light Detection And Ranging (LiDAR) Data<a href="neon-aop.html#light-detection-and-ranging-lidar-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>A 6:02 introduction video on LiDAR:</strong></p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/EYbhNSUnIdU" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<p><strong>A ~17 minute video lecture by Dr. Tristan Goulden on discrete LiDAR and LiDAT data:</strong></p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/PRE5KV2_w3Q" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<p><strong>A ~35 minute video on LiDAR Uncertainty:</strong></p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Cy2pAuv-eUY" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</div>
<div id="calculating-forest-structural-diversity-metrics-from-neon-lidar-data" class="section level2 hasAnchor" number="6.8">
<h2><span class="header-section-number">6.8</span> Calculating Forest Structural Diversity Metrics from NEON LiDAR Data<a href="neon-aop.html#calculating-forest-structural-diversity-metrics-from-neon-lidar-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>Contributors: Jeff Atkins, Keith Krause, Atticus Stovall
Authors: Elizabeth LaRue, Donal O’Leary</p>
</blockquote>
<div id="learning-objectives-4" class="section level3 hasAnchor" number="6.8.1">
<h3><span class="header-section-number">6.8.1</span> Learning Objectives<a href="neon-aop.html#learning-objectives-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>After completing this tutorial, you will be able to:</p>
<ul>
<li>Read a NEON LiDAR file (laz) into R</li>
<li>Visualize a spatial subset of the LiDAR tile</li>
<li>Correct a spatial subset of the LiDAR tile for topographic varation</li>
<li>Calculate 13 structural diversity metrics described in <a href="https://doi.org/10.3390/rs12091407" target="_blank">LaRue, Wagner, et al. (2020) </a></li>
</ul>
</div>
<div id="r-libraries-to-install-1" class="section level3 hasAnchor" number="6.8.2">
<h3><span class="header-section-number">6.8.2</span> R Libraries to Install:<a href="neon-aop.html#r-libraries-to-install-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>lidR</strong>: <code>install.packages('lidR')</code></li>
<li><strong>gstat</strong>: <code>install.packages('gstat')</code></li>
</ul>
<p><strong>Important Note:</strong>
If you have R version 3.6 or above you’ll need to update <code>data.table</code>:</p>
<pre><code>data.table::update.dev.pkg()</code></pre>
</div>
<div id="data-to-download-1" class="section level3 hasAnchor" number="6.8.3">
<h3><span class="header-section-number">6.8.3</span> Data to Download<a href="neon-aop.html#data-to-download-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For this tutorial, we will be using two .laz files containing NEON
AOP point clouds for 1km tiles from the <a href="https://www.neonscience.org/field-sites/field-sites-map/HARV" target="_blank">Harvard Forest (HARV)</a> and
<a href="https://www.neonscience.org/field-sites/field-sites-map/TEAK" target="_blank">Lower Teakettle (TEAK)</a> sites.</p>
<p><a href="https://drive.google.com/open?id=1Aemh0IVKvC-LoMj2AXr9k8rDQk77l8k7" target="_blank"> <strong>Link to download .laz files on Google Drive Here.</strong></a></p>
</div>
<div id="recommended-skills" class="section level3 hasAnchor" number="6.8.4">
<h3><span class="header-section-number">6.8.4</span> Recommended Skills<a href="neon-aop.html#recommended-skills" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For this tutorial, you should have an understanding of Light Detection
And Ranging (LiDAR) technology, specifically how discrete return lidar
data are collected and represented in las/laz files. For more information
on how lidar works, please see NEON’s
<a href="https://www.neonscience.org/intro-lidar-r-series" target="_blank"> Introduction to Lidar Tutorial Series.</a></p>
</div>
<div id="additional-resources-2" class="section level3 hasAnchor" number="6.8.5">
<h3><span class="header-section-number">6.8.5</span> Additional Resources<a href="neon-aop.html#additional-resources-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Jean-Romain Roussel, Tristan R.H. Goodbody, Piotr Tompalski have written a fantastic <code>gitbook</code> on their <code>lidR</code> package <a href="https://jean-romain.github.io/lidRbook/index.html"><strong>which can be found here.</strong></a></p>
<p><img src="images/lidR_logo.png" width="226" /></p>
<p>If loading some of the packages needed for this tutorial results in non-stop errors, I strongly suggest you run this section using a Docker container,<em>(e.g. Rocker Project’s Geospatial image)</em>, or one from CyVerse: <a href="https://hub.docker.com/r/cyversevice/rstudio-geospatial" class="uri">https://hub.docker.com/r/cyversevice/rstudio-geospatial</a></p>
<p><img src="images/cyverse_logo.png" width="1042" /></p>
</div>
</div>
<div id="introduction-to-structural-diversity-metrics" class="section level2 hasAnchor" number="6.9">
<h2><span class="header-section-number">6.9</span> Introduction to Structural Diversity Metrics<a href="neon-aop.html#introduction-to-structural-diversity-metrics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Forest structure influences many important ecological processes, including:</p>
<ul>
<li>biogeochemical cycling,</li>
<li>wildfires,</li>
<li>species richness and diversity,</li>
<li>and many others.</li>
</ul>
<p>Quantifying forest structure, hereafter referred to as “<em>structural
diversity</em>,” presents a challenge for many reasons, including difficulty in
measuring individual trees, limbs, and leaves across large areas. In order
to overcome this challenge, today’s researchers use Light Detection And
Ranging (LiDAR) technology to measure large areas of forest. It is also
challenging to calculate meaningful summary metrics of a forest’s structure
that 1) are ecologically relevant and 2) can be used to compare different
forested locations. In this tutorial, you will be introduced to a few tools
that will help you to explore and quantify forest structure using LiDAR data
collected at two field sites of the
<a href="https://www.neonscience.org/" target="_blank">
National Ecological Observatory Network</a>.</p>
</div>
<div id="neon-aop-discrete-return-lidar" class="section level2 hasAnchor" number="6.10">
<h2><span class="header-section-number">6.10</span> NEON AOP Discrete Return LIDAR<a href="neon-aop.html#neon-aop-discrete-return-lidar" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://www.neonscience.org/data-collection/airborne-remote-sensing" target="_blank"> The NEON Airborne Observation Platform (AOP) </a>.
has several sensors including discrete-return LiDAR, which is useful for measuring forest structural diversity that can be summarized into four categories of metrics: (1) canopy height, (2) canopy cover and openness, and (3) canopy heterogeneity (internal and external), and (4) vegetation area.</p>
<p>We will be comparing the structural diversity of two NEON sites that vary in their structural characteristics.</p>
<p>First, we will look at <a href="https://www.neonscience.org/field-sites/field-sites-map/HARV" target="_blank">Harvard Forest (HARV)</a>, which is located in Massachusetts. It is a lower elevation, mixed deciduous and evergreen forest dominated by Quercus rubra, Acer rubrum, and Aralia nudicaulis.</p>
<p>Second, we will look at <a href="https://www.neonscience.org/field-sites/field-sites-map/TEAK" target="_blank">Lower Teakettle (TEAK)</a>, which is a high elevation forested NEON site in California. TEAK is an evergreen forest dominated by Abies magnifica, Abies concolor, Pinus jeffreyi, and Pinus contorta.</p>
<p>As you can imagine, these two forest types will have both similarities and differences in their structural attributes. We can quantify these attributes by calculating several different structural diversity metrics, and comparing
the results.</p>
<div id="loading-the-lidar-products" class="section level3 hasAnchor" number="6.10.1">
<h3><span class="header-section-number">6.10.1</span> Loading the LIDAR Products<a href="neon-aop.html#loading-the-lidar-products" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To begin, we first need to load our required R packages, and set our working
directory to the location where we saved the input LiDAR .laz files that can be
downloaded from the NEON Data Portal.</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="neon-aop.html#cb462-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lidR)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;lidR&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:raster&#39;:
## 
##     projection, projection&lt;-</code></pre>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="neon-aop.html#cb465-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gstat)</span>
<span id="cb465-2"><a href="neon-aop.html#cb465-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;data.table&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:raster&#39;:
## 
##     shift</code></pre>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="neon-aop.html#cb468-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code></pre></div>
<p>Next, we will read in the LiDAR data using the <code>lidR::readLAS()</code> function.
Note that this function can read in both <code>.las</code> and <code>.laz</code> file formats.</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="neon-aop.html#cb469-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in LiDAR data </span></span>
<span id="cb469-2"><a href="neon-aop.html#cb469-2" aria-hidden="true" tabindex="-1"></a><span class="co">#2017 1 km2 tile .laz file type for HARV and TEAK</span></span>
<span id="cb469-3"><a href="neon-aop.html#cb469-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb469-4"><a href="neon-aop.html#cb469-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Watch out for outlier Z points - this function also allows for the</span></span>
<span id="cb469-5"><a href="neon-aop.html#cb469-5" aria-hidden="true" tabindex="-1"></a><span class="co">#ability to filter outlier points well above or below the landscape</span></span>
<span id="cb469-6"><a href="neon-aop.html#cb469-6" aria-hidden="true" tabindex="-1"></a><span class="co">#(-drop_z_blow and -drop_z_above). See how we have done this here </span></span>
<span id="cb469-7"><a href="neon-aop.html#cb469-7" aria-hidden="true" tabindex="-1"></a><span class="co">#for you.</span></span>
<span id="cb469-8"><a href="neon-aop.html#cb469-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb469-9"><a href="neon-aop.html#cb469-9" aria-hidden="true" tabindex="-1"></a>HARV <span class="ot">&lt;-</span> lidR<span class="sc">::</span><span class="fu">readLAS</span>(<span class="st">&#39;/Users/rohan/katharynduffy.github.io/data/NEON_D01_HARV_DP1_727000_4702000_classified_point_cloud_colorized.laz&#39;</span>,<span class="at">filter =</span> <span class="st">&quot;-drop_z_below 150 -drop_z_above 325&quot;</span>)</span>
<span id="cb469-10"><a href="neon-aop.html#cb469-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb469-11"><a href="neon-aop.html#cb469-11" aria-hidden="true" tabindex="-1"></a>TEAK <span class="ot">&lt;-</span> lidR<span class="sc">::</span><span class="fu">readLAS</span>(<span class="st">&#39;/Users/rohan/katharynduffy.github.io/data/NEON_D17_TEAK_DP1_316000_4091000_classified_point_cloud_colorized.laz&#39;</span>,<span class="at">filter =</span> <span class="st">&quot;-drop_z_below 1694 -drop_z_above 2500&quot;</span>)</span></code></pre></div>
<p>Let’s check out:</p>
<ol style="list-style-type: decimal">
<li>the extent,</li>
<li>coordinate system,</li>
<li>and a 3D plot of each .laz file.</li>
</ol>
<p><em>Note that on Mac computers you may need to install
XQuartz for 3D plots - see xquartz.org</em></p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="neon-aop.html#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(HARV)</span>
<span id="cb470-2"><a href="neon-aop.html#cb470-2" aria-hidden="true" tabindex="-1"></a>lidR<span class="sc">::</span><span class="fu">plot</span>(HARV)</span></code></pre></div>
<pre><code>class        : LAS (v1.3 format 3)
memory       : 521.6 Mb 
extent       : 727000, 728000, 4702000, 4703000 (xmin, xmax, ymin, ymax)
coord. ref.  : +proj=utm +zone=18 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0 
area         : 1 km²
points       : 5.94 million points
density      : 5.94 points/m²
File signature:           LASF� 
File source ID:           211 
Global encoding:
 - GPS Time Type: GPS Week Time 
 - Synthetic Return Numbers: no 
 - Well Know Text: CRS is GeoTIFF 
 - Aggregate Model: false 
Project ID - GUID:        00000000-0000-0000-0000-000000000000 
Version:                  1.3
System identifier:        LAStools (c) by rapidlasso GmbH 
Generating software:      lascolor (190812) commercial 
File creation d/y:        278/2019
header size:              235 
Offset to point data:     329 
Num. var. length record:  1 
Point data format:        3 
Point data record length: 34 
Num. of point records:    5944282 
Num. of points by return: 4581566 1255117 104991 2608 0 
Scale factor X Y Z:       0.01 0.01 0.01 
Offset X Y Z:             7e+05 4700000 0 
min X Y Z:                727000 4702000 223.2 
max X Y Z:                728000 4703000 324.99 
Variable length records: 
   Variable length record 1 of 1 
       Description:  
       Tags:
          Key 1024 value 1 
          Key 1025 value 2 
          Key 3072 value 32618 
          Key 4099 value 9001 </code></pre>
<p><img src="https://raw.githubusercontent.com/NEONScience/NEON-Data-Skills/dev-aten/graphics/lidar-point-clouds/HARV1km2.JPG" /></p>
<blockquote>
<p>1 km-squared point cloud from Harvard Forest showing a gentle slope covered in a continuous canopy of mixed forest.</p>
</blockquote>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="neon-aop.html#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(TEAK)</span>
<span id="cb472-2"><a href="neon-aop.html#cb472-2" aria-hidden="true" tabindex="-1"></a>lidR<span class="sc">::</span><span class="fu">plot</span>(TEAK)</span></code></pre></div>
<pre><code>class        : LAS (v1.3 format 3)
memory       : 439.2 Mb 
extent       : 316000, 317000, 4091231, 4092000 (xmin, xmax, ymin, ymax)
coord. ref.  : +proj=utm +zone=11 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0 
area         : 0.75 km²
points       : 5.01 million points
density      : 6.7 points/m²
File signature:           LASF� 
File source ID:           211 
Global encoding:
 - GPS Time Type: GPS Week Time 
 - Synthetic Return Numbers: no 
 - Well Know Text: CRS is GeoTIFF 
 - Aggregate Model: false 
Project ID - GUID:        00000000-0000-0000-0000-000000000000 
Version:                  1.3
System identifier:        LAStools (c) by rapidlasso GmbH 
Generating software:      lascolor (190812) commercial 
File creation d/y:        206/2019
header size:              235 
Offset to point data:     329 
Num. var. length record:  1 
Point data format:        3 
Point data record length: 34 
Num. of point records:    5006002 
Num. of points by return: 3315380 1182992 416154 91476 0 
Scale factor X Y Z:       0.01 0.01 0.01 
Offset X Y Z:             3e+05 4e+06 0 
min X Y Z:                316000 4091231 2117.03 
max X Y Z:                317000 4092000 2376.98 
Variable length records: 
   Variable length record 1 of 1 
       Description:  
       Tags:
          Key 1024 value 1 
          Key 1025 value 2 
          Key 3072 value 32611 
          Key 4099 value 9001</code></pre>
<p><img src="https://raw.githubusercontent.com/NEONScience/NEON-Data-Skills/dev-aten/graphics/lidar-point-clouds/TEAK1km2.JPG" /></p>
<blockquote>
<p>1 km-squared point cloud from Lower Teakettle showing mountainous terrain covered in a patchy conifer forest, with tall, skinny conifers clearly visible emerging from the discontinuous canopy.</p>
</blockquote>
</div>
<div id="normalizing-tree-height-to-ground" class="section level3 hasAnchor" number="6.10.2">
<h3><span class="header-section-number">6.10.2</span> Normalizing Tree Height to Ground<a href="neon-aop.html#normalizing-tree-height-to-ground" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To begin, we will take a look at the structural diversity of the dense mixed deciduous/evergreen
forest of HARV. We’re going to choose a 40 x 40 m spatial extent for our analysis, but first we
need to normalize the height values of this LiDAR point cloud from an absolute elevation
above mean sea level to height above the ground using the <code>lidR::normalize_height()</code> function.</p>
<p>This function relies on spatial interpolation, and therefore we want to perform this step on an area
that is quite a bit larger than our area of interest to avoid edge effects.</p>
<p>To be safe, we will clip out an area of 200 x 200 m, normalize it, and then clip out our smaller area of interest.</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="neon-aop.html#cb474-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correct for elevation </span></span>
<span id="cb474-2"><a href="neon-aop.html#cb474-2" aria-hidden="true" tabindex="-1"></a><span class="co">#We&#39;re going to choose a 40 x 40 m spatial extent, which is the</span></span>
<span id="cb474-3"><a href="neon-aop.html#cb474-3" aria-hidden="true" tabindex="-1"></a><span class="co">#extent for NEON base plots. </span></span>
<span id="cb474-4"><a href="neon-aop.html#cb474-4" aria-hidden="true" tabindex="-1"></a><span class="co">#First set the center of where you want the plot to be (note easting </span></span>
<span id="cb474-5"><a href="neon-aop.html#cb474-5" aria-hidden="true" tabindex="-1"></a><span class="co">#and northing works in units of m because these data are in a UTM </span></span>
<span id="cb474-6"><a href="neon-aop.html#cb474-6" aria-hidden="true" tabindex="-1"></a><span class="co">#proejction as shown in the summary above).</span></span>
<span id="cb474-7"><a href="neon-aop.html#cb474-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">727500</span> <span class="co">#easting </span></span>
<span id="cb474-8"><a href="neon-aop.html#cb474-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">4702500</span> <span class="co">#northing</span></span>
<span id="cb474-9"><a href="neon-aop.html#cb474-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb474-10"><a href="neon-aop.html#cb474-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Cut out a 200 x 200 m buffer by adding 100 m to easting and </span></span>
<span id="cb474-11"><a href="neon-aop.html#cb474-11" aria-hidden="true" tabindex="-1"></a><span class="co">#northing coordinates (x,y).</span></span>
<span id="cb474-12"><a href="neon-aop.html#cb474-12" aria-hidden="true" tabindex="-1"></a>data<span class="fl">.200</span>m <span class="ot">&lt;-</span> </span>
<span id="cb474-13"><a href="neon-aop.html#cb474-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">clip_rectangle</span>(HARV,</span>
<span id="cb474-14"><a href="neon-aop.html#cb474-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xleft =</span> (x <span class="sc">-</span> <span class="dv">100</span>), <span class="at">ybottom =</span> (y <span class="sc">-</span> <span class="dv">100</span>),</span>
<span id="cb474-15"><a href="neon-aop.html#cb474-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xright =</span> (x <span class="sc">+</span> <span class="dv">100</span>), <span class="at">ytop =</span> (y <span class="sc">+</span> <span class="dv">100</span>))</span>
<span id="cb474-16"><a href="neon-aop.html#cb474-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb474-17"><a href="neon-aop.html#cb474-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Correct for ground height using a kriging function to interpolate </span></span>
<span id="cb474-18"><a href="neon-aop.html#cb474-18" aria-hidden="true" tabindex="-1"></a><span class="co">#elevation from ground points in the .laz file.</span></span>
<span id="cb474-19"><a href="neon-aop.html#cb474-19" aria-hidden="true" tabindex="-1"></a><span class="co">#If the function will not run, then you may need to checkfor outliers</span></span>
<span id="cb474-20"><a href="neon-aop.html#cb474-20" aria-hidden="true" tabindex="-1"></a><span class="co">#by adjusting the &#39;drop_z_&#39; arguments when reading in the .laz files.</span></span>
<span id="cb474-21"><a href="neon-aop.html#cb474-21" aria-hidden="true" tabindex="-1"></a>dtm <span class="ot">&lt;-</span> <span class="fu">grid_terrain</span>(data<span class="fl">.200</span>m, <span class="dv">1</span>, <span class="fu">kriging</span>(<span class="at">k =</span> 10L))</span>
<span id="cb474-22"><a href="neon-aop.html#cb474-22" aria-hidden="true" tabindex="-1"></a>data<span class="fl">.200</span>m <span class="ot">&lt;-</span> <span class="fu">normalize_height</span>(data<span class="fl">.200</span>m, dtm)</span>
<span id="cb474-23"><a href="neon-aop.html#cb474-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb474-24"><a href="neon-aop.html#cb474-24" aria-hidden="true" tabindex="-1"></a><span class="co">#Will often give a warning if not all points could be corrected, </span></span>
<span id="cb474-25"><a href="neon-aop.html#cb474-25" aria-hidden="true" tabindex="-1"></a><span class="co">#but visually check to see if it corrected for ground height. </span></span>
<span id="cb474-26"><a href="neon-aop.html#cb474-26" aria-hidden="true" tabindex="-1"></a>lidR<span class="sc">::</span><span class="fu">plot</span>(data<span class="fl">.200</span>m)</span>
<span id="cb474-27"><a href="neon-aop.html#cb474-27" aria-hidden="true" tabindex="-1"></a><span class="co">#There&#39;s only a few uncorrected points and we&#39;ll fix these in </span></span>
<span id="cb474-28"><a href="neon-aop.html#cb474-28" aria-hidden="true" tabindex="-1"></a><span class="co">#the next step. </span></span>
<span id="cb474-29"><a href="neon-aop.html#cb474-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb474-30"><a href="neon-aop.html#cb474-30" aria-hidden="true" tabindex="-1"></a><span class="co">#Clip 20 m out from each side of the easting and northing </span></span>
<span id="cb474-31"><a href="neon-aop.html#cb474-31" aria-hidden="true" tabindex="-1"></a><span class="co">#coordinates (x,y).</span></span>
<span id="cb474-32"><a href="neon-aop.html#cb474-32" aria-hidden="true" tabindex="-1"></a>data<span class="fl">.40</span>m <span class="ot">&lt;-</span> </span>
<span id="cb474-33"><a href="neon-aop.html#cb474-33" aria-hidden="true" tabindex="-1"></a>   <span class="fu">clip_rectangle</span>(data<span class="fl">.200</span>m, </span>
<span id="cb474-34"><a href="neon-aop.html#cb474-34" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xleft =</span> (x <span class="sc">-</span> <span class="dv">20</span>), <span class="at">ybottom =</span> (y <span class="sc">-</span> <span class="dv">20</span>),</span>
<span id="cb474-35"><a href="neon-aop.html#cb474-35" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xright =</span> (x <span class="sc">+</span> <span class="dv">20</span>), <span class="at">ytop =</span> (y <span class="sc">+</span> <span class="dv">20</span>))</span>
<span id="cb474-36"><a href="neon-aop.html#cb474-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb474-37"><a href="neon-aop.html#cb474-37" aria-hidden="true" tabindex="-1"></a>data<span class="fl">.40</span>m<span class="sc">@</span>data<span class="sc">$</span>Z[data<span class="fl">.40</span>m<span class="sc">@</span>data<span class="sc">$</span>Z <span class="sc">&lt;=</span> .<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span>  </span>
<span id="cb474-38"><a href="neon-aop.html#cb474-38" aria-hidden="true" tabindex="-1"></a><span class="co">#This line filters out all z_vals below .5 m as we are less </span></span>
<span id="cb474-39"><a href="neon-aop.html#cb474-39" aria-hidden="true" tabindex="-1"></a><span class="co">#interested in shrubs/trees. </span></span>
<span id="cb474-40"><a href="neon-aop.html#cb474-40" aria-hidden="true" tabindex="-1"></a><span class="co">#You could change it to zero or another height depending on interests. </span></span>
<span id="cb474-41"><a href="neon-aop.html#cb474-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb474-42"><a href="neon-aop.html#cb474-42" aria-hidden="true" tabindex="-1"></a><span class="co">#visualize the clipped plot point cloud</span></span>
<span id="cb474-43"><a href="neon-aop.html#cb474-43" aria-hidden="true" tabindex="-1"></a>lidR<span class="sc">::</span><span class="fu">plot</span>(data<span class="fl">.40</span>m) </span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/NEONScience/NEON-Data-Skills/dev-aten/graphics/lidar-point-clouds/HARV40mx40m.JPG" /></p>
<blockquote>
<p>40 meter by 40 meter point cloud from Harvard Forest showing a cross-section of the forest structure with a complex canopy- and sub-canopy structure with many rounded crowns, characteristic of a deciduous-dominated section of forest.</p>
</blockquote>
</div>
</div>
<div id="calculating-structural-diversity-metrics" class="section level2 hasAnchor" number="6.11">
<h2><span class="header-section-number">6.11</span> Calculating Structural Diversity Metrics<a href="neon-aop.html#calculating-structural-diversity-metrics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we have our area of interest normalized and clipped, we can proceed with calculating
our structural diversity metrics.</p>
<div id="generate-canopy-height-model-chm" class="section level3 hasAnchor" number="6.11.1">
<h3><span class="header-section-number">6.11.1</span> GENERATE CANOPY HEIGHT MODEL (CHM)<a href="neon-aop.html#generate-canopy-height-model-chm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>(i.e. a 1 m2 raster grid of vegetations heights)</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="neon-aop.html#cb475-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Structural diversity metrics</span></span>
<span id="cb475-2"><a href="neon-aop.html#cb475-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-3"><a href="neon-aop.html#cb475-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-4"><a href="neon-aop.html#cb475-4" aria-hidden="true" tabindex="-1"></a><span class="co">#res argument specifies pixel size in meters and dsmtin is </span></span>
<span id="cb475-5"><a href="neon-aop.html#cb475-5" aria-hidden="true" tabindex="-1"></a><span class="co">#for raster interpolation</span></span>
<span id="cb475-6"><a href="neon-aop.html#cb475-6" aria-hidden="true" tabindex="-1"></a>chm <span class="ot">&lt;-</span> <span class="fu">grid_canopy</span>(data<span class="fl">.40</span>m, <span class="at">res =</span> <span class="dv">1</span>, <span class="fu">dsmtin</span>())  </span>
<span id="cb475-7"><a href="neon-aop.html#cb475-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-8"><a href="neon-aop.html#cb475-8" aria-hidden="true" tabindex="-1"></a><span class="co">#visualize CHM</span></span>
<span id="cb475-9"><a href="neon-aop.html#cb475-9" aria-hidden="true" tabindex="-1"></a>lidR<span class="sc">::</span><span class="fu">plot</span>(chm) </span></code></pre></div>
<div id="mean-outer-canopy-height-moch" class="section level4 hasAnchor" number="6.11.1.1">
<h4><span class="header-section-number">6.11.1.1</span> MEAN OUTER CANOPY HEIGHT (MOCH)<a href="neon-aop.html#mean-outer-canopy-height-moch" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="neon-aop.html#cb476-1" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate MOCH, the mean CHM height value</span></span>
<span id="cb476-2"><a href="neon-aop.html#cb476-2" aria-hidden="true" tabindex="-1"></a>mean.max.canopy.ht <span class="ot">&lt;-</span> <span class="fu">mean</span>(chm<span class="sc">@</span>data<span class="sc">@</span>values, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span></code></pre></div>
</div>
<div id="max-canopy-height" class="section level4 hasAnchor" number="6.11.1.2">
<h4><span class="header-section-number">6.11.1.2</span> MAX CANOPY HEIGHT<a href="neon-aop.html#max-canopy-height" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="neon-aop.html#cb477-1" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate HMAX, the maximum CHM height value</span></span>
<span id="cb477-2"><a href="neon-aop.html#cb477-2" aria-hidden="true" tabindex="-1"></a>max.canopy.ht <span class="ot">&lt;-</span> <span class="fu">max</span>(chm<span class="sc">@</span>data<span class="sc">@</span>values, <span class="at">na.rm=</span><span class="cn">TRUE</span>) </span></code></pre></div>
</div>
<div id="rumple" class="section level4 hasAnchor" number="6.11.1.3">
<h4><span class="header-section-number">6.11.1.3</span> RUMPLE<a href="neon-aop.html#rumple" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="neon-aop.html#cb478-1" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate rumple, a ratio of outer canopy surface area to </span></span>
<span id="cb478-2"><a href="neon-aop.html#cb478-2" aria-hidden="true" tabindex="-1"></a><span class="co">#ground surface area (1600 m^2)</span></span>
<span id="cb478-3"><a href="neon-aop.html#cb478-3" aria-hidden="true" tabindex="-1"></a>rumple <span class="ot">&lt;-</span> <span class="fu">rumple_index</span>(chm) </span></code></pre></div>
</div>
<div id="top-rugosity" class="section level4 hasAnchor" number="6.11.1.4">
<h4><span class="header-section-number">6.11.1.4</span> TOP RUGOSITY<a href="neon-aop.html#top-rugosity" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="neon-aop.html#cb479-1" aria-hidden="true" tabindex="-1"></a><span class="co">#top rugosity, the standard deviation of pixel values in chm and </span></span>
<span id="cb479-2"><a href="neon-aop.html#cb479-2" aria-hidden="true" tabindex="-1"></a><span class="co">#is a measure of outer canopy roughness</span></span>
<span id="cb479-3"><a href="neon-aop.html#cb479-3" aria-hidden="true" tabindex="-1"></a>top.rugosity <span class="ot">&lt;-</span> <span class="fu">sd</span>(chm<span class="sc">@</span>data<span class="sc">@</span>values, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span></code></pre></div>
</div>
<div id="deep-gaps-deep-gap-fraction" class="section level4 hasAnchor" number="6.11.1.5">
<h4><span class="header-section-number">6.11.1.5</span> DEEP GAPS &amp; DEEP GAP FRACTION<a href="neon-aop.html#deep-gaps-deep-gap-fraction" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="neon-aop.html#cb480-1" aria-hidden="true" tabindex="-1"></a><span class="co">#number of cells in raster (also area in m2)</span></span>
<span id="cb480-2"><a href="neon-aop.html#cb480-2" aria-hidden="true" tabindex="-1"></a>cells <span class="ot">&lt;-</span> <span class="fu">length</span>(chm<span class="sc">@</span>data<span class="sc">@</span>values) </span>
<span id="cb480-3"><a href="neon-aop.html#cb480-3" aria-hidden="true" tabindex="-1"></a>chm<span class="fl">.0</span> <span class="ot">&lt;-</span> chm</span>
<span id="cb480-4"><a href="neon-aop.html#cb480-4" aria-hidden="true" tabindex="-1"></a>chm<span class="fl">.0</span>[<span class="fu">is.na</span>(chm<span class="fl">.0</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co">#replace NAs with zeros in CHM</span></span>
<span id="cb480-5"><a href="neon-aop.html#cb480-5" aria-hidden="true" tabindex="-1"></a><span class="co">#create variable for the number of deep gaps, 1 m^2 canopy gaps</span></span>
<span id="cb480-6"><a href="neon-aop.html#cb480-6" aria-hidden="true" tabindex="-1"></a>zeros <span class="ot">&lt;-</span> <span class="fu">which</span>(chm<span class="fl">.0</span><span class="sc">@</span>data<span class="sc">@</span>values <span class="sc">==</span> <span class="dv">0</span>) </span>
<span id="cb480-7"><a href="neon-aop.html#cb480-7" aria-hidden="true" tabindex="-1"></a>deepgaps <span class="ot">&lt;-</span> <span class="fu">length</span>(zeros) <span class="co">#number of deep gaps</span></span>
<span id="cb480-8"><a href="neon-aop.html#cb480-8" aria-hidden="true" tabindex="-1"></a><span class="co">#deep gap fraction, the number of deep gaps in the chm relative </span></span>
<span id="cb480-9"><a href="neon-aop.html#cb480-9" aria-hidden="true" tabindex="-1"></a><span class="co">#to total number of chm pixels</span></span>
<span id="cb480-10"><a href="neon-aop.html#cb480-10" aria-hidden="true" tabindex="-1"></a>deepgap.fraction <span class="ot">&lt;-</span> deepgaps<span class="sc">/</span>cells </span></code></pre></div>
</div>
<div id="cover-fraction" class="section level4 hasAnchor" number="6.11.1.6">
<h4><span class="header-section-number">6.11.1.6</span> COVER FRACTION<a href="neon-aop.html#cover-fraction" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="neon-aop.html#cb481-1" aria-hidden="true" tabindex="-1"></a><span class="co">#cover fraction, the inverse of deep gap fraction</span></span>
<span id="cb481-2"><a href="neon-aop.html#cb481-2" aria-hidden="true" tabindex="-1"></a>cover.fraction <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> deepgap.fraction </span></code></pre></div>
</div>
<div id="height-sd" class="section level4 hasAnchor" number="6.11.1.7">
<h4><span class="header-section-number">6.11.1.7</span> HEIGHT SD<a href="neon-aop.html#height-sd" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The standard deviation of height values for all points in the plot point cloud</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="neon-aop.html#cb482-1" aria-hidden="true" tabindex="-1"></a><span class="co">#height SD, the standard deviation of height values for all points</span></span>
<span id="cb482-2"><a href="neon-aop.html#cb482-2" aria-hidden="true" tabindex="-1"></a><span class="co">#in the plot point cloud</span></span>
<span id="cb482-3"><a href="neon-aop.html#cb482-3" aria-hidden="true" tabindex="-1"></a>vert.sd <span class="ot">&lt;-</span> <span class="fu">cloud_metrics</span>(data<span class="fl">.40</span>m, <span class="fu">sd</span>(Z, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) </span>
<span id="cb482-4"><a href="neon-aop.html#cb482-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb482-5"><a href="neon-aop.html#cb482-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb482-6"><a href="neon-aop.html#cb482-6" aria-hidden="true" tabindex="-1"></a><span class="co">#SD of VERTICAL SD of HEIGHT</span></span>
<span id="cb482-7"><a href="neon-aop.html#cb482-7" aria-hidden="true" tabindex="-1"></a><span class="co">#rasterize plot point cloud and calculate the standard deviation </span></span>
<span id="cb482-8"><a href="neon-aop.html#cb482-8" aria-hidden="true" tabindex="-1"></a><span class="co">#of height values at a resolution of 1 m^2</span></span>
<span id="cb482-9"><a href="neon-aop.html#cb482-9" aria-hidden="true" tabindex="-1"></a>sd<span class="fl">.1</span>m2 <span class="ot">&lt;-</span> <span class="fu">grid_metrics</span>(data<span class="fl">.40</span>m, <span class="fu">sd</span>(Z), <span class="dv">1</span>)</span>
<span id="cb482-10"><a href="neon-aop.html#cb482-10" aria-hidden="true" tabindex="-1"></a><span class="co">#standard deviation of the calculated standard deviations </span></span>
<span id="cb482-11"><a href="neon-aop.html#cb482-11" aria-hidden="true" tabindex="-1"></a><span class="co">#from previous line </span></span>
<span id="cb482-12"><a href="neon-aop.html#cb482-12" aria-hidden="true" tabindex="-1"></a><span class="co">#This is a measure of internal and external canopy complexity</span></span>
<span id="cb482-13"><a href="neon-aop.html#cb482-13" aria-hidden="true" tabindex="-1"></a>sd.sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(sd<span class="fl">.1</span>m2[,<span class="dv">3</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span>
<span id="cb482-14"><a href="neon-aop.html#cb482-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb482-15"><a href="neon-aop.html#cb482-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb482-16"><a href="neon-aop.html#cb482-16" aria-hidden="true" tabindex="-1"></a><span class="co">#some of the next few functions won&#39;t handle NAs, so we need </span></span>
<span id="cb482-17"><a href="neon-aop.html#cb482-17" aria-hidden="true" tabindex="-1"></a><span class="co">#to filter these out of a vector of Z points</span></span>
<span id="cb482-18"><a href="neon-aop.html#cb482-18" aria-hidden="true" tabindex="-1"></a>Zs <span class="ot">&lt;-</span> data<span class="fl">.40</span>m<span class="sc">@</span>data<span class="sc">$</span>Z</span>
<span id="cb482-19"><a href="neon-aop.html#cb482-19" aria-hidden="true" tabindex="-1"></a>Zs <span class="ot">&lt;-</span> Zs[<span class="sc">!</span><span class="fu">is.na</span>(Zs)]</span></code></pre></div>
</div>
<div id="entropy" class="section level4 hasAnchor" number="6.11.1.8">
<h4><span class="header-section-number">6.11.1.8</span> ENTROPY<a href="neon-aop.html#entropy" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Quantifies diversity &amp; evenness of point cloud heights</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="neon-aop.html#cb483-1" aria-hidden="true" tabindex="-1"></a><span class="co">#by = 1 partitions point cloud in 1 m tall horizontal slices </span></span>
<span id="cb483-2"><a href="neon-aop.html#cb483-2" aria-hidden="true" tabindex="-1"></a><span class="co">#ranges from 0-1, with 1 being more evenly distributed points </span></span>
<span id="cb483-3"><a href="neon-aop.html#cb483-3" aria-hidden="true" tabindex="-1"></a><span class="co">#across the 1 m tall slices </span></span>
<span id="cb483-4"><a href="neon-aop.html#cb483-4" aria-hidden="true" tabindex="-1"></a>entro <span class="ot">&lt;-</span> <span class="fu">entropy</span>(Zs, <span class="at">by =</span> <span class="dv">1</span>) </span></code></pre></div>
</div>
<div id="gap-fraction-profile" class="section level4 hasAnchor" number="6.11.1.9">
<h4><span class="header-section-number">6.11.1.9</span> GAP FRACTION PROFILE<a href="neon-aop.html#gap-fraction-profile" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Gap fraction profile, assesses the distribution of gaps in the canopy volume</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="neon-aop.html#cb484-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dz = 1 partitions point cloud in 1 m horizontal slices </span></span>
<span id="cb484-2"><a href="neon-aop.html#cb484-2" aria-hidden="true" tabindex="-1"></a><span class="co">#z0 is set to a reasonable height based on the age and height of </span></span>
<span id="cb484-3"><a href="neon-aop.html#cb484-3" aria-hidden="true" tabindex="-1"></a><span class="co">#the study sites </span></span>
<span id="cb484-4"><a href="neon-aop.html#cb484-4" aria-hidden="true" tabindex="-1"></a>gap_frac <span class="ot">&lt;-</span> <span class="fu">gap_fraction_profile</span>(Zs, <span class="at">dz =</span> <span class="dv">1</span>, <span class="at">z0=</span><span class="dv">3</span>) </span>
<span id="cb484-5"><a href="neon-aop.html#cb484-5" aria-hidden="true" tabindex="-1"></a><span class="co">#defines gap fraction profile as the average gap fraction in each </span></span>
<span id="cb484-6"><a href="neon-aop.html#cb484-6" aria-hidden="true" tabindex="-1"></a><span class="co">#1 m horizontal slice assessed in the previous line</span></span>
<span id="cb484-7"><a href="neon-aop.html#cb484-7" aria-hidden="true" tabindex="-1"></a>GFP.AOP <span class="ot">&lt;-</span> <span class="fu">mean</span>(gap_frac<span class="sc">$</span>gf) </span></code></pre></div>
</div>
<div id="vai" class="section level4 hasAnchor" number="6.11.1.10">
<h4><span class="header-section-number">6.11.1.10</span> VAI<a href="neon-aop.html#vai" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Leaf area density, assesses leaf area in the canopy volume</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="neon-aop.html#cb485-1" aria-hidden="true" tabindex="-1"></a><span class="co">#k = 0.5 is a standard extinction coefficient for foliage </span></span>
<span id="cb485-2"><a href="neon-aop.html#cb485-2" aria-hidden="true" tabindex="-1"></a><span class="co">#dz = 1 partitions point cloud in 1 m horizontal slices </span></span>
<span id="cb485-3"><a href="neon-aop.html#cb485-3" aria-hidden="true" tabindex="-1"></a><span class="co">#z0 is set to the same height as gap fraction profile above</span></span>
<span id="cb485-4"><a href="neon-aop.html#cb485-4" aria-hidden="true" tabindex="-1"></a>LADen<span class="ot">&lt;-</span><span class="fu">LAD</span>(Zs, <span class="at">dz =</span> <span class="dv">1</span>, <span class="at">k=</span><span class="fl">0.5</span>, <span class="at">z0=</span><span class="dv">3</span>) </span>
<span id="cb485-5"><a href="neon-aop.html#cb485-5" aria-hidden="true" tabindex="-1"></a><span class="co">#vegetation area index, sum of leaf area density values for </span></span>
<span id="cb485-6"><a href="neon-aop.html#cb485-6" aria-hidden="true" tabindex="-1"></a><span class="co">#all horizontal slices assessed in previous line</span></span>
<span id="cb485-7"><a href="neon-aop.html#cb485-7" aria-hidden="true" tabindex="-1"></a>VAI.AOP <span class="ot">&lt;-</span> <span class="fu">sum</span>(LADen<span class="sc">$</span>lad, <span class="at">na.rm=</span><span class="cn">TRUE</span>) </span></code></pre></div>
</div>
<div id="vci" class="section level4 hasAnchor" number="6.11.1.11">
<h4><span class="header-section-number">6.11.1.11</span> VCI<a href="neon-aop.html#vci" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A vertical complexity index, fixed normalization of entropy metric calculated above</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="neon-aop.html#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="co">#set zmax comofortably above maximum canopy height</span></span>
<span id="cb486-2"><a href="neon-aop.html#cb486-2" aria-hidden="true" tabindex="-1"></a><span class="co">#by = 1 assesses the metric based on 1 m horizontal slices in </span></span>
<span id="cb486-3"><a href="neon-aop.html#cb486-3" aria-hidden="true" tabindex="-1"></a><span class="co">#the canopy</span></span>
<span id="cb486-4"><a href="neon-aop.html#cb486-4" aria-hidden="true" tabindex="-1"></a>VCI.AOP <span class="ot">&lt;-</span> <span class="fu">VCI</span>(Zs, <span class="at">by =</span> <span class="dv">1</span>, <span class="at">zmax=</span><span class="dv">100</span>) </span></code></pre></div>
<p>We now have 13 different structural diversity metrics. Let’s organize them into a new dataframe:</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="neon-aop.html#cb487-1" aria-hidden="true" tabindex="-1"></a><span class="co">#OUTPUT CALCULATED METRICS INTO A TABLE</span></span>
<span id="cb487-2"><a href="neon-aop.html#cb487-2" aria-hidden="true" tabindex="-1"></a><span class="co">#creates a dataframe row, out.plot, containing plot descriptors </span></span>
<span id="cb487-3"><a href="neon-aop.html#cb487-3" aria-hidden="true" tabindex="-1"></a><span class="co">#and calculated metrics</span></span>
<span id="cb487-4"><a href="neon-aop.html#cb487-4" aria-hidden="true" tabindex="-1"></a>HARV_structural_diversity <span class="ot">&lt;-</span> </span>
<span id="cb487-5"><a href="neon-aop.html#cb487-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(x, y, mean.max.canopy.ht, max.canopy.ht, </span>
<span id="cb487-6"><a href="neon-aop.html#cb487-6" aria-hidden="true" tabindex="-1"></a>                       rumple, deepgaps,deepgap.fraction,</span>
<span id="cb487-7"><a href="neon-aop.html#cb487-7" aria-hidden="true" tabindex="-1"></a>                       cover.fraction,top.rugosity, vert.sd, </span>
<span id="cb487-8"><a href="neon-aop.html#cb487-8" aria-hidden="true" tabindex="-1"></a>                       sd.sd, entro,GFP.AOP, VAI.AOP, VCI.AOP),</span>
<span id="cb487-9"><a href="neon-aop.html#cb487-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ncol =</span> <span class="dv">15</span>)) </span>
<span id="cb487-10"><a href="neon-aop.html#cb487-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-11"><a href="neon-aop.html#cb487-11" aria-hidden="true" tabindex="-1"></a><span class="co">#provide descriptive names for the calculated metrics</span></span>
<span id="cb487-12"><a href="neon-aop.html#cb487-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(HARV_structural_diversity) <span class="ot">&lt;-</span> </span>
<span id="cb487-13"><a href="neon-aop.html#cb487-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">c</span>(<span class="st">&quot;easting&quot;</span>, <span class="st">&quot;northing&quot;</span>, <span class="st">&quot;mean.max.canopy.ht.aop&quot;</span>,</span>
<span id="cb487-14"><a href="neon-aop.html#cb487-14" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;max.canopy.ht.aop&quot;</span>, <span class="st">&quot;rumple.aop&quot;</span>, <span class="st">&quot;deepgaps.aop&quot;</span>,</span>
<span id="cb487-15"><a href="neon-aop.html#cb487-15" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;deepgap.fraction.aop&quot;</span>,<span class="st">&quot;cover.fraction.aop&quot;</span>, </span>
<span id="cb487-16"><a href="neon-aop.html#cb487-16" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;top.rugosity.aop&quot;</span>, <span class="st">&quot;vert.sd.aop&quot;</span>, <span class="st">&quot;sd.sd.aop&quot;</span>, </span>
<span id="cb487-17"><a href="neon-aop.html#cb487-17" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;entropy.aop&quot;</span>, <span class="st">&quot;GFP.AOP.aop&quot;</span>, <span class="st">&quot;VAI.AOP.aop&quot;</span>, <span class="st">&quot;VCI.AOP.aop&quot;</span>) </span>
<span id="cb487-18"><a href="neon-aop.html#cb487-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-19"><a href="neon-aop.html#cb487-19" aria-hidden="true" tabindex="-1"></a><span class="co">#View the results</span></span>
<span id="cb487-20"><a href="neon-aop.html#cb487-20" aria-hidden="true" tabindex="-1"></a>HARV_structural_diversity </span></code></pre></div>
</div>
</div>
<div id="combining-everything-into-one-function" class="section level3 hasAnchor" number="6.11.2">
<h3><span class="header-section-number">6.11.2</span> Combining Everything Into One Function<a href="neon-aop.html#combining-everything-into-one-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that we have run through how to measure each structural diversity metric, let’s create a
convenient function to run these a little faster on the TEAK site for a comparison of structural
diversity with HARV.</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="neon-aop.html#cb488-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Let&#39;s correct for elevation and measure structural diversity for TEAK</span></span>
<span id="cb488-2"><a href="neon-aop.html#cb488-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">316400</span> </span>
<span id="cb488-3"><a href="neon-aop.html#cb488-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">4091700</span></span>
<span id="cb488-4"><a href="neon-aop.html#cb488-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb488-5"><a href="neon-aop.html#cb488-5" aria-hidden="true" tabindex="-1"></a>data<span class="fl">.200</span>m <span class="ot">&lt;-</span> <span class="fu">clip_rectangle</span>(TEAK, </span>
<span id="cb488-6"><a href="neon-aop.html#cb488-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">xleft =</span> (x <span class="sc">-</span> <span class="dv">100</span>), <span class="at">ybottom =</span> (y <span class="sc">-</span> <span class="dv">100</span>),</span>
<span id="cb488-7"><a href="neon-aop.html#cb488-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">xright =</span> (x <span class="sc">+</span> <span class="dv">100</span>), <span class="at">ytop =</span> (y <span class="sc">+</span> <span class="dv">100</span>))</span>
<span id="cb488-8"><a href="neon-aop.html#cb488-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb488-9"><a href="neon-aop.html#cb488-9" aria-hidden="true" tabindex="-1"></a>dtm <span class="ot">&lt;-</span> <span class="fu">grid_terrain</span>(data<span class="fl">.200</span>m, <span class="dv">1</span>, <span class="fu">kriging</span>(<span class="at">k =</span> 10L))</span>
<span id="cb488-10"><a href="neon-aop.html#cb488-10" aria-hidden="true" tabindex="-1"></a>data<span class="fl">.200</span>m <span class="ot">&lt;-</span> <span class="fu">normalize_height</span>(data<span class="fl">.200</span>m, dtm)</span>
<span id="cb488-11"><a href="neon-aop.html#cb488-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb488-12"><a href="neon-aop.html#cb488-12" aria-hidden="true" tabindex="-1"></a>data<span class="fl">.40</span>m <span class="ot">&lt;-</span> <span class="fu">clip_rectangle</span>(data<span class="fl">.200</span>m, </span>
<span id="cb488-13"><a href="neon-aop.html#cb488-13" aria-hidden="true" tabindex="-1"></a>                             <span class="at">xleft =</span> (x <span class="sc">-</span> <span class="dv">20</span>), <span class="at">ybottom =</span> (y <span class="sc">-</span> <span class="dv">20</span>),</span>
<span id="cb488-14"><a href="neon-aop.html#cb488-14" aria-hidden="true" tabindex="-1"></a>                             <span class="at">xright =</span> (x <span class="sc">+</span> <span class="dv">20</span>), <span class="at">ytop =</span> (y <span class="sc">+</span> <span class="dv">20</span>))</span>
<span id="cb488-15"><a href="neon-aop.html#cb488-15" aria-hidden="true" tabindex="-1"></a>data<span class="fl">.40</span>m<span class="sc">@</span>data<span class="sc">$</span>Z[data<span class="fl">.40</span>m<span class="sc">@</span>data<span class="sc">$</span>Z <span class="sc">&lt;=</span> .<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="dv">0</span>  </span>
<span id="cb488-16"><a href="neon-aop.html#cb488-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(data<span class="fl">.40</span>m)</span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/NEONScience/NEON-Data-Skills/dev-aten/graphics/lidar-point-clouds/TEAK40mx40m.JPG" /></p>
<blockquote>
<p>40 meter by 40 meter point cloud from Lower Teakettle showing a cross-section of the forest structure with several tall, pointed conifers separated by deep gaps in the canopy.</p>
</blockquote>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="neon-aop.html#cb489-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Zip up all the code we previously used and write function to </span></span>
<span id="cb489-2"><a href="neon-aop.html#cb489-2" aria-hidden="true" tabindex="-1"></a><span class="co">#run all 13 metrics in a single function. </span></span>
<span id="cb489-3"><a href="neon-aop.html#cb489-3" aria-hidden="true" tabindex="-1"></a>structural_diversity_metrics <span class="ot">&lt;-</span> <span class="cf">function</span>(data<span class="fl">.40</span>m) {</span>
<span id="cb489-4"><a href="neon-aop.html#cb489-4" aria-hidden="true" tabindex="-1"></a>   chm <span class="ot">&lt;-</span> <span class="fu">grid_canopy</span>(data<span class="fl">.40</span>m, <span class="at">res =</span> <span class="dv">1</span>, <span class="fu">dsmtin</span>()) </span>
<span id="cb489-5"><a href="neon-aop.html#cb489-5" aria-hidden="true" tabindex="-1"></a>   mean.max.canopy.ht <span class="ot">&lt;-</span> <span class="fu">mean</span>(chm<span class="sc">@</span>data<span class="sc">@</span>values, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span>
<span id="cb489-6"><a href="neon-aop.html#cb489-6" aria-hidden="true" tabindex="-1"></a>   max.canopy.ht <span class="ot">&lt;-</span> <span class="fu">max</span>(chm<span class="sc">@</span>data<span class="sc">@</span>values, <span class="at">na.rm=</span><span class="cn">TRUE</span>) </span>
<span id="cb489-7"><a href="neon-aop.html#cb489-7" aria-hidden="true" tabindex="-1"></a>   rumple <span class="ot">&lt;-</span> <span class="fu">rumple_index</span>(chm) </span>
<span id="cb489-8"><a href="neon-aop.html#cb489-8" aria-hidden="true" tabindex="-1"></a>   top.rugosity <span class="ot">&lt;-</span> <span class="fu">sd</span>(chm<span class="sc">@</span>data<span class="sc">@</span>values, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span>
<span id="cb489-9"><a href="neon-aop.html#cb489-9" aria-hidden="true" tabindex="-1"></a>   cells <span class="ot">&lt;-</span> <span class="fu">length</span>(chm<span class="sc">@</span>data<span class="sc">@</span>values) </span>
<span id="cb489-10"><a href="neon-aop.html#cb489-10" aria-hidden="true" tabindex="-1"></a>   chm<span class="fl">.0</span> <span class="ot">&lt;-</span> chm</span>
<span id="cb489-11"><a href="neon-aop.html#cb489-11" aria-hidden="true" tabindex="-1"></a>   chm<span class="fl">.0</span>[<span class="fu">is.na</span>(chm<span class="fl">.0</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb489-12"><a href="neon-aop.html#cb489-12" aria-hidden="true" tabindex="-1"></a>   zeros <span class="ot">&lt;-</span> <span class="fu">which</span>(chm<span class="fl">.0</span><span class="sc">@</span>data<span class="sc">@</span>values <span class="sc">==</span> <span class="dv">0</span>) </span>
<span id="cb489-13"><a href="neon-aop.html#cb489-13" aria-hidden="true" tabindex="-1"></a>   deepgaps <span class="ot">&lt;-</span> <span class="fu">length</span>(zeros) </span>
<span id="cb489-14"><a href="neon-aop.html#cb489-14" aria-hidden="true" tabindex="-1"></a>   deepgap.fraction <span class="ot">&lt;-</span> deepgaps<span class="sc">/</span>cells </span>
<span id="cb489-15"><a href="neon-aop.html#cb489-15" aria-hidden="true" tabindex="-1"></a>   cover.fraction <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> deepgap.fraction </span>
<span id="cb489-16"><a href="neon-aop.html#cb489-16" aria-hidden="true" tabindex="-1"></a>   vert.sd <span class="ot">&lt;-</span> <span class="fu">cloud_metrics</span>(data<span class="fl">.40</span>m, <span class="fu">sd</span>(Z, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) </span>
<span id="cb489-17"><a href="neon-aop.html#cb489-17" aria-hidden="true" tabindex="-1"></a>   sd<span class="fl">.1</span>m2 <span class="ot">&lt;-</span> <span class="fu">grid_metrics</span>(data<span class="fl">.40</span>m, <span class="fu">sd</span>(Z), <span class="dv">1</span>) </span>
<span id="cb489-18"><a href="neon-aop.html#cb489-18" aria-hidden="true" tabindex="-1"></a>   sd.sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(sd<span class="fl">.1</span>m2[,<span class="dv">3</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span>
<span id="cb489-19"><a href="neon-aop.html#cb489-19" aria-hidden="true" tabindex="-1"></a>   Zs <span class="ot">&lt;-</span> data<span class="fl">.40</span>m<span class="sc">@</span>data<span class="sc">$</span>Z</span>
<span id="cb489-20"><a href="neon-aop.html#cb489-20" aria-hidden="true" tabindex="-1"></a>   Zs <span class="ot">&lt;-</span> Zs[<span class="sc">!</span><span class="fu">is.na</span>(Zs)]</span>
<span id="cb489-21"><a href="neon-aop.html#cb489-21" aria-hidden="true" tabindex="-1"></a>   entro <span class="ot">&lt;-</span> <span class="fu">entropy</span>(Zs, <span class="at">by =</span> <span class="dv">1</span>) </span>
<span id="cb489-22"><a href="neon-aop.html#cb489-22" aria-hidden="true" tabindex="-1"></a>   gap_frac <span class="ot">&lt;-</span> <span class="fu">gap_fraction_profile</span>(Zs, <span class="at">dz =</span> <span class="dv">1</span>, <span class="at">z0=</span><span class="dv">3</span>)</span>
<span id="cb489-23"><a href="neon-aop.html#cb489-23" aria-hidden="true" tabindex="-1"></a>   GFP.AOP <span class="ot">&lt;-</span> <span class="fu">mean</span>(gap_frac<span class="sc">$</span>gf) </span>
<span id="cb489-24"><a href="neon-aop.html#cb489-24" aria-hidden="true" tabindex="-1"></a>   LADen<span class="ot">&lt;-</span><span class="fu">LAD</span>(Zs, <span class="at">dz =</span> <span class="dv">1</span>, <span class="at">k=</span><span class="fl">0.5</span>, <span class="at">z0=</span><span class="dv">3</span>) </span>
<span id="cb489-25"><a href="neon-aop.html#cb489-25" aria-hidden="true" tabindex="-1"></a>   VAI.AOP <span class="ot">&lt;-</span> <span class="fu">sum</span>(LADen<span class="sc">$</span>lad, <span class="at">na.rm=</span><span class="cn">TRUE</span>) </span>
<span id="cb489-26"><a href="neon-aop.html#cb489-26" aria-hidden="true" tabindex="-1"></a>   VCI.AOP <span class="ot">&lt;-</span> <span class="fu">VCI</span>(Zs, <span class="at">by =</span> <span class="dv">1</span>, <span class="at">zmax=</span><span class="dv">100</span>) </span>
<span id="cb489-27"><a href="neon-aop.html#cb489-27" aria-hidden="true" tabindex="-1"></a>   out.plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb489-28"><a href="neon-aop.html#cb489-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">matrix</span>(<span class="fu">c</span>(x, y, mean.max.canopy.ht,max.canopy.ht, </span>
<span id="cb489-29"><a href="neon-aop.html#cb489-29" aria-hidden="true" tabindex="-1"></a>               rumple,deepgaps, deepgap.fraction, </span>
<span id="cb489-30"><a href="neon-aop.html#cb489-30" aria-hidden="true" tabindex="-1"></a>               cover.fraction, top.rugosity, vert.sd, </span>
<span id="cb489-31"><a href="neon-aop.html#cb489-31" aria-hidden="true" tabindex="-1"></a>               sd.sd, entro, GFP.AOP, VAI.AOP,VCI.AOP),</span>
<span id="cb489-32"><a href="neon-aop.html#cb489-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">15</span>)) </span>
<span id="cb489-33"><a href="neon-aop.html#cb489-33" aria-hidden="true" tabindex="-1"></a>   <span class="fu">colnames</span>(out.plot) <span class="ot">&lt;-</span> </span>
<span id="cb489-34"><a href="neon-aop.html#cb489-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">&quot;easting&quot;</span>, <span class="st">&quot;northing&quot;</span>, <span class="st">&quot;mean.max.canopy.ht.aop&quot;</span>,</span>
<span id="cb489-35"><a href="neon-aop.html#cb489-35" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;max.canopy.ht.aop&quot;</span>, <span class="st">&quot;rumple.aop&quot;</span>, <span class="st">&quot;deepgaps.aop&quot;</span>,</span>
<span id="cb489-36"><a href="neon-aop.html#cb489-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;deepgap.fraction.aop&quot;</span>, <span class="st">&quot;cover.fraction.aop&quot;</span>,</span>
<span id="cb489-37"><a href="neon-aop.html#cb489-37" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;top.rugosity.aop&quot;</span>,<span class="st">&quot;vert.sd.aop&quot;</span>,<span class="st">&quot;sd.sd.aop&quot;</span>, </span>
<span id="cb489-38"><a href="neon-aop.html#cb489-38" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;entropy.aop&quot;</span>, <span class="st">&quot;GFP.AOP.aop&quot;</span>,</span>
<span id="cb489-39"><a href="neon-aop.html#cb489-39" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;VAI.AOP.aop&quot;</span>, <span class="st">&quot;VCI.AOP.aop&quot;</span>) </span>
<span id="cb489-40"><a href="neon-aop.html#cb489-40" aria-hidden="true" tabindex="-1"></a>   <span class="fu">print</span>(out.plot)</span>
<span id="cb489-41"><a href="neon-aop.html#cb489-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb489-42"><a href="neon-aop.html#cb489-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb489-43"><a href="neon-aop.html#cb489-43" aria-hidden="true" tabindex="-1"></a>TEAK_structural_diversity <span class="ot">&lt;-</span> <span class="fu">structural_diversity_metrics</span>(data<span class="fl">.40</span>m)</span></code></pre></div>
</div>
<div id="comparing-metrics-between-forests" class="section level3 hasAnchor" number="6.11.3">
<h3><span class="header-section-number">6.11.3</span> Comparing Metrics Between Forests<a href="neon-aop.html#comparing-metrics-between-forests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>How does the structural diversity of the evergreen TEAK forest compare to the mixed deciduous/evergreen forest from HARV? Let’s combine the result data.frames for a direct comparison:</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="neon-aop.html#cb490-1" aria-hidden="true" tabindex="-1"></a>combined_results<span class="ot">=</span><span class="fu">rbind</span>(HARV_structural_diversity, </span>
<span id="cb490-2"><a href="neon-aop.html#cb490-2" aria-hidden="true" tabindex="-1"></a>                       TEAK_structural_diversity)</span>
<span id="cb490-3"><a href="neon-aop.html#cb490-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-4"><a href="neon-aop.html#cb490-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add row names for clarity</span></span>
<span id="cb490-5"><a href="neon-aop.html#cb490-5" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(combined_results)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;HARV&quot;</span>,<span class="st">&quot;TEAK&quot;</span>)</span>
<span id="cb490-6"><a href="neon-aop.html#cb490-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-7"><a href="neon-aop.html#cb490-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Take a look to compare</span></span>
<span id="cb490-8"><a href="neon-aop.html#cb490-8" aria-hidden="true" tabindex="-1"></a>combined_results</span></code></pre></div>
</div>
</div>
<div id="matching-gedi-waveforms-with-neon-aop-lidar-pointclouds" class="section level2 hasAnchor" number="6.12">
<h2><span class="header-section-number">6.12</span> Matching GEDI waveforms with NEON AOP LiDAR pointclouds<a href="neon-aop.html#matching-gedi-waveforms-with-neon-aop-lidar-pointclouds" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>author: Donal O’Leary</p>
</blockquote>
<p><em>GEDI has amazing coverage around the globe, but is limited in its spatial resolution. Here, we extract NEON pointcloud data corresponding to individual GEDI waveforms to better understand how the GEDI return waveform gets its shape.</em></p>
<div id="ds-objectives" markdown="1">

<div id="learning-objectives-5" class="section level3 hasAnchor" number="6.12.1">
<h3><span class="header-section-number">6.12.1</span> Learning Objectives<a href="neon-aop.html#learning-objectives-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>After completing this section you will be able to:</p>
<ul>
<li>Search for GEDI data based on a NEON site bounding box</li>
<li>Extract NEON LiDAR pointcloud data corresponding to a specific GEDI footprint</li>
<li>Visualize NEON and GEDI LiDAR data together in 3D</li>
</ul>
</div>
<div id="things-youll-need-to-complete-this-gedi-section" class="section level3 hasAnchor" number="6.12.2">
<h3><span class="header-section-number">6.12.2</span> Things You’ll Need To Complete This GEDI Section<a href="neon-aop.html#things-youll-need-to-complete-this-gedi-section" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="r-packages-to-install" class="section level3 hasAnchor" number="6.12.3">
<h3><span class="header-section-number">6.12.3</span> R Packages to Install<a href="neon-aop.html#r-packages-to-install" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Prior to starting the tutorial ensure that the following packages are installed.</p>
<ul>
<li><strong>raster:</strong> <code>install.packages("raster")</code></li>
<li><strong>rGEDI:</strong> <code>install.packages("rGEDI")</code></li>
<li><strong>sp:</strong> <code>install.packages("sp")</code></li>
<li><strong>sf:</strong> <code>install.packages("sf")</code></li>
<li><strong>lidR:</strong> <code>install.packages("lidR")</code></li>
<li><strong>neonUtilities:</strong> <code>install.packages("neonUtilities")</code></li>
<li><strong>viridis:</strong> <code>install.packages("viridis")</code></li>
<li><strong>maptools:</strong> <code>install.packages("maptools")</code></li>
</ul>
</div>
<div id="example-data-set" class="section level3 hasAnchor" number="6.12.4">
<h3><span class="header-section-number">6.12.4</span> Example Data Set<a href="neon-aop.html#example-data-set" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="gedi-example-data-subset" class="section level4 hasAnchor" number="6.12.4.1">
<h4><span class="header-section-number">6.12.4.1</span> GEDI Example Data Subset<a href="neon-aop.html#gedi-example-data-subset" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This dataset has been subset from a full GEDI orbit retaining only the ‘shots’ that correspond to a single 1km AOP tile, and only the ‘datasets’ (attributes) that are needed to visualize the GEDI waveform as shown below.
<a href="https://ndownloader.figshare.com/files/24978809" class="link--button link--arrow">
Download GEDI Example Dataset</a></p>
</div>
<div id="datum-difference-between-wgs84-and-nad83" class="section level4 hasAnchor" number="6.12.4.2">
<h4><span class="header-section-number">6.12.4.2</span> Datum difference between WGS84 and NAD83<a href="neon-aop.html#datum-difference-between-wgs84-and-nad83" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This dataset describes the differences between the common WGS84 and NAD83 standards for vertical data in North America.
<a href="https://ndownloader.figshare.com/files/24994703" class="link--button link--arrow">
Download Dataset</a></p>
</div>
<div id="datum-difference-between-geoid12a-and-nad83" class="section level4 hasAnchor" number="6.12.4.3">
<h4><span class="header-section-number">6.12.4.3</span> Datum difference between GEOID12A and NAD83<a href="neon-aop.html#datum-difference-between-geoid12a-and-nad83" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This dataset describes the differences between the GEOID12A and NAD83 standards for vertical data in North America.
<a href="https://ndownloader.figshare.com/files/24994697" class="link--button link--arrow">
Download Dataset</a></p>
</div>
</div>
<div id="getting-started" class="section level3 hasAnchor" number="6.12.5">
<h3><span class="header-section-number">6.12.5</span> Getting Started<a href="neon-aop.html#getting-started" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this section we will compare NEON and GEDI LiDAR data by comparing the information that they both capture in the same location. NEON data are actually one of the datasets used by the GEDI mission to calibrate and validate GEDI waveforms, so this makes for a valuable comparison!</p>
<p>In order to compare these data, we will need to download GEDI data that overlap a NEON site. Fortunately, Carlos Silva et al. have made a convenient R package clled <code>rGEDI</code> and <a href="https://cran.r-project.org/web/packages/rGEDI/vignettes/tutorial.html">this excellent tutorial hosted on CRAN</a> desribing how to work with GEDI data in R.</p>
<p>However, GEDI data are currently only available to download per complete orbit, which means that the vast majority of the orbit’s data does not fall within a NEON site. The GEDI orbit datasets come in HDF5 data format, and contain about 7Gb of data, so you may want to run the first few sections of this tutorial to get the GEDI download started, and refresh your memory of HDF5 files with NEON’s <a href="https://www.neonscience.org/intro-hdf5-r-series">Intro to HDF5 series</a>.</p>
<p>First, we will load the required libraries and set our working directory:</p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="neon-aop.html#cb491-1" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_git(&quot;https://github.com/carlos-alberto-silva/rGEDI&quot;, dependencies = TRUE)</span></span>
<span id="cb491-2"><a href="neon-aop.html#cb491-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(rGEDI)</span></span>
<span id="cb491-3"><a href="neon-aop.html#cb491-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb491-4"><a href="neon-aop.html#cb491-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb491-5"><a href="neon-aop.html#cb491-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span></code></pre></div>
<pre><code>## Linking to GEOS 3.9.1, GDAL 3.4.3, PROJ 7.2.1; sf_use_s2() is TRUE</code></pre>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="neon-aop.html#cb493-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgl)</span>
<span id="cb493-2"><a href="neon-aop.html#cb493-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lidR)</span>
<span id="cb493-3"><a href="neon-aop.html#cb493-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(neonUtilities)</span>
<span id="cb493-4"><a href="neon-aop.html#cb493-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span></code></pre></div>
<pre><code>## Loading required package: viridisLite</code></pre>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="neon-aop.html#cb495-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maptools)</span></code></pre></div>
<pre><code>## Checking rgeos availability: TRUE
## Please note that &#39;maptools&#39; will be retired by the end of 2023,
## plan transition at your earliest convenience;
## some functionality will be moved to &#39;sp&#39;.</code></pre>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="neon-aop.html#cb497-1" aria-hidden="true" tabindex="-1"></a><span class="co">#wd &lt;- &quot;./data&quot; # This will depend on your local environment</span></span>
<span id="cb497-2"><a href="neon-aop.html#cb497-2" aria-hidden="true" tabindex="-1"></a><span class="co">#setwd(wd)</span></span></code></pre></div>
<p>Next, we will download a Canopy Height Model (CHM) tile from the Wind River Experiemental Forest (WREF) using the <code>byTileAOP()</code> function to use as a preliminary map on which to overlay the GEDI data. There is one particularly interesting mosaic tile which we will select using the <code>easting</code> and <code>northing</code> arguments. We then load the raster into R and make a simple plot. For more information about CHMs, please see our tutorial <a href="https://www.neonscience.org/chm-dsm-dtm-gridded-lidar-data">What is a CHM?</a></p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="neon-aop.html#cb498-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the SITECODE as a variable because</span></span>
<span id="cb498-2"><a href="neon-aop.html#cb498-2" aria-hidden="true" tabindex="-1"></a><span class="co"># we will use it several times in this tutorial</span></span>
<span id="cb498-3"><a href="neon-aop.html#cb498-3" aria-hidden="true" tabindex="-1"></a>SITECODE <span class="ot">&lt;-</span> <span class="st">&quot;WREF&quot;</span></span>
<span id="cb498-4"><a href="neon-aop.html#cb498-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb498-5"><a href="neon-aop.html#cb498-5" aria-hidden="true" tabindex="-1"></a><span class="fu">byTileAOP</span>(<span class="at">dpID =</span> <span class="st">&quot;DP3.30015.001&quot;</span>, <span class="at">site =</span> SITECODE, <span class="at">year =</span> <span class="dv">2017</span>, </span>
<span id="cb498-6"><a href="neon-aop.html#cb498-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">easting =</span> <span class="dv">580000</span>, <span class="at">northing =</span> <span class="dv">5075000</span>, <span class="at">check.size =</span> F,</span>
<span id="cb498-7"><a href="neon-aop.html#cb498-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">savepath =</span> <span class="st">&#39;./data&#39;</span>)</span></code></pre></div>
<pre><code>## Downloading files totaling approximately 4.035953 MB 
## Downloading 6 files
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |======================================================================| 100%
## Successfully downloaded  6  files.
## NEON_D16_WREF_DP1_580000_5075000_classified_point_cloud.shp downloaded to ./data/DP3.30015.001/neon-aop-products/2017/FullSite/D16/2017_WREF_1/Metadata/DiscreteLidar/TileBoundary/shps
## NEON_D16_WREF_DP1_580000_5075000_classified_point_cloud.kml downloaded to ./data/DP3.30015.001/neon-aop-products/2017/FullSite/D16/2017_WREF_1/Metadata/DiscreteLidar/TileBoundary/kmls
## NEON_D16_WREF_DP3_580000_5075000_CHM.tif downloaded to ./data/DP3.30015.001/neon-aop-products/2017/FullSite/D16/2017_WREF_1/L3/DiscreteLidar/CanopyHeightModelGtif
## NEON_D16_WREF_DP1_580000_5075000_classified_point_cloud.prj downloaded to ./data/DP3.30015.001/neon-aop-products/2017/FullSite/D16/2017_WREF_1/Metadata/DiscreteLidar/TileBoundary/shps
## NEON_D16_WREF_DP1_580000_5075000_classified_point_cloud.dbf downloaded to ./data/DP3.30015.001/neon-aop-products/2017/FullSite/D16/2017_WREF_1/Metadata/DiscreteLidar/TileBoundary/shps
## NEON_D16_WREF_DP1_580000_5075000_classified_point_cloud.shx downloaded to ./data/DP3.30015.001/neon-aop-products/2017/FullSite/D16/2017_WREF_1/Metadata/DiscreteLidar/TileBoundary/shps</code></pre>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="neon-aop.html#cb500-1" aria-hidden="true" tabindex="-1"></a>chm <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">&#39;./data/DP3.30015.001/neon-aop-products/2017/FullSite/D16/2017_WREF_1/L3/DiscreteLidar/CanopyHeightModelGtif/NEON_D16_WREF_DP3_580000_5075000_CHM.tif&#39;</span>)</span>
<span id="cb500-2"><a href="neon-aop.html#cb500-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb500-3"><a href="neon-aop.html#cb500-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(chm)</span></code></pre></div>
<p><img src="07-NEON_AOP_files/figure-html/download-chm-1.png" width="672" /></p>
<p>As you can see, this particular CHM is showing a conspicuous, triangle-shaped clearcut in this section of the experimental forest, where the tree canopy is much shorter than the towering 60m+ trees in the undisturbed areas. This variation will give us a variety of forest structures to investigate.</p>
</div>
<div id="downloading-gedi-data" class="section level3 hasAnchor" number="6.12.6">
<h3><span class="header-section-number">6.12.6</span> Downloading GEDI data<a href="neon-aop.html#downloading-gedi-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This next section on downloading and working with GEDI data is loosely based on the excellent <code>rGEDI</code> package tutorial <a href="https://cran.r-project.org/web/packages/rGEDI/vignettes/tutorial.html">posted on CRAN here</a>. If you would prefer to avoid a large download (&gt;7Gb) of a full GEDI orbit, you can forego these steps and use the <a href="https://ndownloader.figshare.com/files/24978809">
example GEDI dataset here</a>, and skip to the <code>readLevel1B()</code> function below.</p>
<p>The Global Ecosystem Dynamics Investigation (GEDI) is a NASA mission with the primary data collection being performed by a novel waveform lidar instrument mounted on the International Space Station (ISS). Please see <a href="https://www.sciencedirect.com/science/article/pii/S2666017220300018">this open-access paper</a> published in Science of Remote Sensing that describes this mission in detail. The ISS orbits around the world every 90 minutes, and can be tracked <a href="https://spotthestation.nasa.gov/tracking_map.cfm">on this cool NASA website</a>.</p>
<p>As described <a href="https://lpdaac.usgs.gov/data/get-started-data/collection-overview/missions/gedi-overview/">here</a> on the Land Processes Distributed Active Archive Center (LP DAAC), “the sole GEDI observable is the waveform from which all other data products are derived. Each waveform is captured with a nominal ~30 m diameter.” As of the date of publication, GEDI data are only offered in HDF5 format, with each file containing the data for a full orbit. The LP DAAC has developed a tool that allows researchers to input a bounding box, which will return a list of every orbit that has a “shot” (waveform return) that falls within that box. Unfortunately, at this time, the tool will not subset out the specific shots that fall within that bounding box; you must download the entire orbit (~7Gb). This functionality may be improved in the future.</p>
<p>Our next few steps involve defining our bounding box, requesting the list of GEDI orbits that contain data relevant to that bounding box, and downloading those data. Let’s focus on the extent of our CHM that we downloaded above - but we will first need to re-project the CHM from its UTM projection into WGS84. To do so, we will refer to the EPSG code for WGS84. To look up any of these codes, please see the amazing resource <a href="https://spatialreference.org/ref/epsg/4326/">spatialrerference.org</a>.</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="neon-aop.html#cb501-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Project CHM to WGS84</span></span>
<span id="cb501-2"><a href="neon-aop.html#cb501-2" aria-hidden="true" tabindex="-1"></a>chm_WGS <span class="ot">=</span> <span class="fu">projectRaster</span>(chm, <span class="at">crs=</span><span class="fu">CRS</span>(<span class="st">&quot;+init=epsg:4326&quot;</span>))</span>
<span id="cb501-3"><a href="neon-aop.html#cb501-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb501-4"><a href="neon-aop.html#cb501-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Study area boundary box coordinates</span></span>
<span id="cb501-5"><a href="neon-aop.html#cb501-5" aria-hidden="true" tabindex="-1"></a>ul_lat<span class="ot">&lt;-</span> <span class="fu">extent</span>(chm_WGS)[<span class="dv">4</span>]</span>
<span id="cb501-6"><a href="neon-aop.html#cb501-6" aria-hidden="true" tabindex="-1"></a>lr_lat<span class="ot">&lt;-</span> <span class="fu">extent</span>(chm_WGS)[<span class="dv">3</span>]</span>
<span id="cb501-7"><a href="neon-aop.html#cb501-7" aria-hidden="true" tabindex="-1"></a>ul_lon<span class="ot">&lt;-</span> <span class="fu">extent</span>(chm_WGS)[<span class="dv">1</span>]</span>
<span id="cb501-8"><a href="neon-aop.html#cb501-8" aria-hidden="true" tabindex="-1"></a>lr_lon<span class="ot">&lt;-</span> <span class="fu">extent</span>(chm_WGS)[<span class="dv">2</span>]</span></code></pre></div>
<p>Next, we use that bounding box information as an input to the <code>gedifinder()</code> funciton.</p>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="neon-aop.html#cb502-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifying the optional date range, if desired</span></span>
<span id="cb502-2"><a href="neon-aop.html#cb502-2" aria-hidden="true" tabindex="-1"></a>daterange<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;2019-03-25&quot;</span>, <span class="co">#first date of GEDI availability</span></span>
<span id="cb502-3"><a href="neon-aop.html#cb502-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;2020-07-15&quot;</span>)</span>
<span id="cb502-4"><a href="neon-aop.html#cb502-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb502-5"><a href="neon-aop.html#cb502-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Get path to GEDI data</span></span>
<span id="cb502-6"><a href="neon-aop.html#cb502-6" aria-hidden="true" tabindex="-1"></a><span class="co"># These lines use an API request to determine which orbits are available </span></span>
<span id="cb502-7"><a href="neon-aop.html#cb502-7" aria-hidden="true" tabindex="-1"></a><span class="co"># that intersect the bounding box of interest.</span></span>
<span id="cb502-8"><a href="neon-aop.html#cb502-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that you still must download the entire orbit and then subset to </span></span>
<span id="cb502-9"><a href="neon-aop.html#cb502-9" aria-hidden="true" tabindex="-1"></a><span class="co"># your area of interest!</span></span>
<span id="cb502-10"><a href="neon-aop.html#cb502-10" aria-hidden="true" tabindex="-1"></a>gLevel1B <span class="ot">&lt;-</span> <span class="fu">gedifinder</span>(<span class="at">product=</span><span class="st">&quot;GEDI01_B&quot;</span>,</span>
<span id="cb502-11"><a href="neon-aop.html#cb502-11" aria-hidden="true" tabindex="-1"></a>                      ul_lat, ul_lon, lr_lat,lr_lon,</span>
<span id="cb502-12"><a href="neon-aop.html#cb502-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">version=</span><span class="st">&quot;001&quot;</span>,<span class="at">daterange=</span><span class="cn">NULL</span>)</span>
<span id="cb502-13"><a href="neon-aop.html#cb502-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb502-14"><a href="neon-aop.html#cb502-14" aria-hidden="true" tabindex="-1"></a><span class="co"># # View list of available data</span></span>
<span id="cb502-15"><a href="neon-aop.html#cb502-15" aria-hidden="true" tabindex="-1"></a> gLevel1B</span></code></pre></div>
<p>Great! There are several GEDI orbits available that have at least 1 ‘shot’ within our bounding box of interest. For more information about GEDI filename conventions, and other valuable information about GEDI data, <a href="https://lpdaac.usgs.gov/data/get-started-data/collection-overview/missions/gedi-overview/#gedi-temporal-and-spatial-resolution">see this page on the LP DAAC</a>. However, as mentioned before, each of these files are quite large (~7Gb), so let’s focus on just the first one for now.</p>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="neon-aop.html#cb503-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Downloading GEDI data, if you haven&#39;t already</span></span>
<span id="cb503-2"><a href="neon-aop.html#cb503-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that this will download a large file (&gt;7Gb) which</span></span>
<span id="cb503-3"><a href="neon-aop.html#cb503-3" aria-hidden="true" tabindex="-1"></a><span class="co"># can be avoided by using the example dataset provided above.</span></span>
<span id="cb503-4"><a href="neon-aop.html#cb503-4" aria-hidden="true" tabindex="-1"></a><span class="co"># wd=&#39;./data/&#39;</span></span>
<span id="cb503-5"><a href="neon-aop.html#cb503-5" aria-hidden="true" tabindex="-1"></a><span class="co"># if(!file.exists(paste0(&quot;./data/&quot;,basename(gLevel1B[2])))){</span></span>
<span id="cb503-6"><a href="neon-aop.html#cb503-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   gediDownload(filepath=gLevel1B[2],outdir=&quot;./data/&quot;)</span></span>
<span id="cb503-7"><a href="neon-aop.html#cb503-7" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span></code></pre></div>
<p>Next, we use the rGEDI package to read in the GEDI data. First, we need to make a ‘gedi.level1b’ object using the <code>readLevel1B()</code> function. Next, we extract the geographic position of the center of each shot from the ‘gedi.level1b’ object using the <code>getLevel1BGeo()</code> function, and display the head of the resulting table.</p>
<p>From this point on, we will be using the (much smaller) example subset of GEDI data linked at the top of this section. All functions and processes should also work with a full GEDI dataset downloaded above, if you choose to pursue this research on your own!</p>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="neon-aop.html#cb504-1" aria-hidden="true" tabindex="-1"></a>gedilevel1b<span class="ot">&lt;-</span><span class="fu">readLevel1B</span>(<span class="at">level1Bpath =</span> <span class="fu">file.path</span>(<span class="st">&#39;./data/NEON_WREF_GEDI_subset.h5&#39;</span>))</span>
<span id="cb504-2"><a href="neon-aop.html#cb504-2" aria-hidden="true" tabindex="-1"></a><span class="co">#gedilevel1b&lt;-readLevel1B(level1Bpath = file.path(wd, &quot;GEDI01_B_2019206022612_O03482_T00370_02_003_01.h5&quot;))</span></span>
<span id="cb504-3"><a href="neon-aop.html#cb504-3" aria-hidden="true" tabindex="-1"></a>level1bGeo<span class="ot">&lt;-</span><span class="fu">getLevel1BGeo</span>(<span class="at">level1b=</span>gedilevel1b,<span class="at">select=</span><span class="fu">c</span>(<span class="st">&quot;elevation_bin0&quot;</span>))</span>
<span id="cb504-4"><a href="neon-aop.html#cb504-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(level1bGeo)</span></code></pre></div>
</div>
<div id="plot-gedi-footprints-on-chm" class="section level3 hasAnchor" number="6.12.7">
<h3><span class="header-section-number">6.12.7</span> Plot GEDI footprints on CHM<a href="neon-aop.html#plot-gedi-footprints-on-chm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s visualize where the GEDI footprints are located on the CHM tile. To do so, we will need to first convert the GEDI data into a spatial object. For this example, we will use a ‘spatial features’ object type from the ‘sp’ package:</p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="neon-aop.html#cb505-1" aria-hidden="true" tabindex="-1"></a><span class="co"># drop any shots with missing latitude/longitude values</span></span>
<span id="cb505-2"><a href="neon-aop.html#cb505-2" aria-hidden="true" tabindex="-1"></a>level1bGeo <span class="ot">=</span> level1bGeo[<span class="sc">!</span><span class="fu">is.na</span>(level1bGeo<span class="sc">$</span>latitude_bin0)<span class="sc">&amp;</span></span>
<span id="cb505-3"><a href="neon-aop.html#cb505-3" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">!</span><span class="fu">is.na</span>(level1bGeo<span class="sc">$</span>longitude_bin0),]</span>
<span id="cb505-4"><a href="neon-aop.html#cb505-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb505-5"><a href="neon-aop.html#cb505-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the GEDI data.frame into an &#39;sf&#39; object</span></span>
<span id="cb505-6"><a href="neon-aop.html#cb505-6" aria-hidden="true" tabindex="-1"></a>level1bGeo_spdf<span class="ot">&lt;-</span><span class="fu">st_as_sf</span>(level1bGeo, </span>
<span id="cb505-7"><a href="neon-aop.html#cb505-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;longitude_bin0&quot;</span>, <span class="st">&quot;latitude_bin0&quot;</span>),</span>
<span id="cb505-8"><a href="neon-aop.html#cb505-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">crs=</span><span class="fu">CRS</span>(<span class="st">&quot;+init=epsg:4326&quot;</span>))</span>
<span id="cb505-9"><a href="neon-aop.html#cb505-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb505-10"><a href="neon-aop.html#cb505-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb505-11"><a href="neon-aop.html#cb505-11" aria-hidden="true" tabindex="-1"></a><span class="co"># crop to the CHM that is in WGS84</span></span>
<span id="cb505-12"><a href="neon-aop.html#cb505-12" aria-hidden="true" tabindex="-1"></a>level1bgeo_WREF<span class="ot">=</span><span class="fu">st_crop</span>(level1bGeo_spdf, chm_WGS)</span></code></pre></div>
<p>Next, project the GEDI geospatial data into the UTM zone that the CHM is within (Zone 10 North). These data come as the point location at the center of the GEDI footprint, so we next convert the GEDI footprint center (lat/long) into a circle using the <code>buffer()</code> function. Finally, we can plot the CHM and overlay the GEDI footprint circles, and label with the last three digits of the ‘shot’ number.</p>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="neon-aop.html#cb506-1" aria-hidden="true" tabindex="-1"></a><span class="co"># project to UTM</span></span>
<span id="cb506-2"><a href="neon-aop.html#cb506-2" aria-hidden="true" tabindex="-1"></a>level1bgeo_WREF_UTM<span class="ot">=</span><span class="fu">st_transform</span>(</span>
<span id="cb506-3"><a href="neon-aop.html#cb506-3" aria-hidden="true" tabindex="-1"></a>  level1bgeo_WREF, <span class="at">crs=</span>chm<span class="sc">$</span>NEON_D16_WREF_DP3_580000_5075000_CHM<span class="sc">@</span>crs)</span>
<span id="cb506-4"><a href="neon-aop.html#cb506-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-5"><a href="neon-aop.html#cb506-5" aria-hidden="true" tabindex="-1"></a><span class="co"># buffer the GEDI shot center by a radius of 12.5m </span></span>
<span id="cb506-6"><a href="neon-aop.html#cb506-6" aria-hidden="true" tabindex="-1"></a><span class="co"># to represent the full 25m diameter GEDI footprint</span></span>
<span id="cb506-7"><a href="neon-aop.html#cb506-7" aria-hidden="true" tabindex="-1"></a>level1bgeo_WREF_UTM_buffer<span class="ot">=</span><span class="fu">st_buffer</span>(level1bgeo_WREF_UTM, <span class="at">dist=</span><span class="fl">12.5</span>)</span>
<span id="cb506-8"><a href="neon-aop.html#cb506-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-9"><a href="neon-aop.html#cb506-9" aria-hidden="true" tabindex="-1"></a><span class="co"># plot CHM and overlay GEDI data</span></span>
<span id="cb506-10"><a href="neon-aop.html#cb506-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(chm)</span>
<span id="cb506-11"><a href="neon-aop.html#cb506-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(level1bgeo_WREF_UTM_buffer, <span class="at">add=</span>T, <span class="at">col=</span><span class="st">&quot;transparent&quot;</span>)</span>
<span id="cb506-12"><a href="neon-aop.html#cb506-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-13"><a href="neon-aop.html#cb506-13" aria-hidden="true" tabindex="-1"></a><span class="co"># add labes with the last three digits of the GEDI shot_number</span></span>
<span id="cb506-14"><a href="neon-aop.html#cb506-14" aria-hidden="true" tabindex="-1"></a><span class="fu">pointLabel</span>(<span class="fu">st_coordinates</span>(level1bgeo_WREF_UTM),</span>
<span id="cb506-15"><a href="neon-aop.html#cb506-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels=</span>level1bgeo_WREF_UTM<span class="sc">$</span>shot_number, <span class="at">cex=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="extract-waveform-for-a-single-shot" class="section level3 hasAnchor" number="6.12.8">
<h3><span class="header-section-number">6.12.8</span> Extract Waveform for a single Shot<a href="neon-aop.html#extract-waveform-for-a-single-shot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s take a look at a waveform for a single GEDI shot. We can select a shot by using its <code>shot_number</code> as shown below. Note, however, that the example data subset shots have been re-numbered, and those numbers will not correspond with full orbit GEDI data.</p>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="neon-aop.html#cb507-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting GEDI full-waveform for a given shot_number</span></span>
<span id="cb507-2"><a href="neon-aop.html#cb507-2" aria-hidden="true" tabindex="-1"></a>wf <span class="ot">&lt;-</span> <span class="fu">getLevel1BWF</span>(gedilevel1b,<span class="at">shot_number =</span> <span class="dv">20</span>)</span>
<span id="cb507-3"><a href="neon-aop.html#cb507-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-4"><a href="neon-aop.html#cb507-4" aria-hidden="true" tabindex="-1"></a><span class="co"># or, if using a full GEDI dataset,</span></span>
<span id="cb507-5"><a href="neon-aop.html#cb507-5" aria-hidden="true" tabindex="-1"></a><span class="co"># wf &lt;- getLevel1BWF(gedilevel1b,shot_number = level1bgeo_WREF_UTM_buffer$shot_number[which(level1bgeo_WREF_UTM_buffer$shot_number==1786)])</span></span>
<span id="cb507-6"><a href="neon-aop.html#cb507-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-7"><a href="neon-aop.html#cb507-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Save current plotting parameters to revert to</span></span>
<span id="cb507-8"><a href="neon-aop.html#cb507-8" aria-hidden="true" tabindex="-1"></a>oldpar <span class="ot">&lt;-</span> <span class="fu">par</span>()</span>
<span id="cb507-9"><a href="neon-aop.html#cb507-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-10"><a href="neon-aop.html#cb507-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up plotting paramters</span></span>
<span id="cb507-11"><a href="neon-aop.html#cb507-11" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">cex.axis =</span> <span class="fl">1.5</span>)</span>
<span id="cb507-12"><a href="neon-aop.html#cb507-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-13"><a href="neon-aop.html#cb507-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot filled-in waveform </span></span>
<span id="cb507-14"><a href="neon-aop.html#cb507-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wf, <span class="at">relative=</span><span class="cn">FALSE</span>, <span class="at">polygon=</span><span class="cn">TRUE</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;forestgreen&quot;</span>,</span>
<span id="cb507-15"><a href="neon-aop.html#cb507-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Waveform Amplitude&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Elevation (m)&quot;</span>)</span>
<span id="cb507-16"><a href="neon-aop.html#cb507-16" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>() <span class="co">#add a grid to the plot</span></span>
<span id="cb507-17"><a href="neon-aop.html#cb507-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-18"><a href="neon-aop.html#cb507-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a simple line with no fill</span></span>
<span id="cb507-19"><a href="neon-aop.html#cb507-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wf, <span class="at">relative=</span><span class="cn">TRUE</span>, <span class="at">polygon=</span><span class="cn">FALSE</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;forestgreen&quot;</span>,</span>
<span id="cb507-20"><a href="neon-aop.html#cb507-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Waveform Amplitude (%)&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Elevation (m)&quot;</span>)</span>
<span id="cb507-21"><a href="neon-aop.html#cb507-21" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()<span class="co">#add a grid to the plot</span></span>
<span id="cb507-22"><a href="neon-aop.html#cb507-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-23"><a href="neon-aop.html#cb507-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Revert plotting parameters to previous values.</span></span>
<span id="cb507-24"><a href="neon-aop.html#cb507-24" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(oldpar)</span></code></pre></div>
<p>This waveform shows some noise above and below the main ecosystem return, with a fairly dense canopy around 370m elevation, and a characteristic ground return spike at about 340m. While the GEDI data are extremely valuable and offer a near-global coverage, it is hard to get a good sense of what the ecosystem really looks like from this GEDI waveform. Let’s download some NEON AOP pointcloud data to pair up with this waveform to get a better sense of what GEDI is reporting.</p>
</div>
<div id="download-and-plot-neon-aop-lidar-pointcloud-data" class="section level3 hasAnchor" number="6.12.9">
<h3><span class="header-section-number">6.12.9</span> Download and Plot NEON AOP LiDAR pointcloud data<a href="neon-aop.html#download-and-plot-neon-aop-lidar-pointcloud-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here, we will use the <code>byTileAOP()</code> function from the ‘neonUtilities’ package to download the classified pointcloud mosaic data (DP1.30003.001). Since this is a mosaic tile like the CHM, we can just pass this function the lower left corner of the CHM tile to get the corresponding lidar pointcloud mosaic tile for our analysis.</p>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="neon-aop.html#cb508-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Download the pointcloud data if you don&#39;t have it already</span></span>
<span id="cb508-2"><a href="neon-aop.html#cb508-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">&#39;./data/DP1.30003.001/2017/FullSite/D16/2017_WREF_1/L1/DiscreteLidar/ClassifiedPointCloud/NEON_D16_WREF_DP1_580000_5075000_classified_point_cloud.laz&#39;</span>)){</span>
<span id="cb508-3"><a href="neon-aop.html#cb508-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">byTileAOP</span>(<span class="at">dpID =</span> <span class="st">&quot;DP1.30003.001&quot;</span>, <span class="at">site =</span> SITECODE, <span class="at">year =</span> <span class="dv">2017</span>, </span>
<span id="cb508-4"><a href="neon-aop.html#cb508-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">easting =</span> <span class="fu">extent</span>(chm)[<span class="dv">1</span>], <span class="at">northing=</span><span class="fu">extent</span>(chm)[<span class="dv">3</span>], </span>
<span id="cb508-5"><a href="neon-aop.html#cb508-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">check.size =</span> F, <span class="at">savepath =</span> <span class="st">&#39;./data/&#39;</span>) <span class="co"># Edit savepath as needed</span></span>
<span id="cb508-6"><a href="neon-aop.html#cb508-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>After downloading the point cloud data, let’s read them into our R session using the <code>readLAS()</code> function from the <code>lidaR</code> package, and plot them in 3D. Note, you may need to update your ‘XQuartz’ if you are using a Mac.</p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="neon-aop.html#cb509-1" aria-hidden="true" tabindex="-1"></a>WREF_LAS<span class="ot">=</span><span class="fu">readLAS</span>(<span class="st">&quot;./data/DP1.30003.001/2017/FullSite/D16/2017_WREF_1/L1/DiscreteLidar/ClassifiedPointCloud/NEON_D16_WREF_DP1_580000_5075000_classified_point_cloud.laz&quot;</span>)</span>
<span id="cb509-2"><a href="neon-aop.html#cb509-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-3"><a href="neon-aop.html#cb509-3" aria-hidden="true" tabindex="-1"></a>lidR<span class="sc">::</span><span class="fu">plot</span>(WREF_LAS)</span></code></pre></div>
<p><img src="images/GEDI_AOP1.png" width="768" />
Oh, yikes! There are a lot of outliers above the actual forest, and a few below. Let’s use some simple statistics to throw out those outliers. We will first calculate the mean and standard deviation for the verical axis, and then use the ‘filter’ options of the <code>readLAS()</code> function to eliminate the vertical outliers.</p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="neon-aop.html#cb510-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">###</span><span class="co"> remove outlier lidar point outliers using mean and sd statistics</span></span>
<span id="cb510-2"><a href="neon-aop.html#cb510-2" aria-hidden="true" tabindex="-1"></a>Z_sd<span class="ot">=</span><span class="fu">sd</span>(WREF_LAS<span class="sc">@</span>data<span class="sc">$</span>Z)</span>
<span id="cb510-3"><a href="neon-aop.html#cb510-3" aria-hidden="true" tabindex="-1"></a>Z_mean<span class="ot">=</span><span class="fu">mean</span>(WREF_LAS<span class="sc">@</span>data<span class="sc">$</span>Z)</span>
<span id="cb510-4"><a href="neon-aop.html#cb510-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb510-5"><a href="neon-aop.html#cb510-5" aria-hidden="true" tabindex="-1"></a><span class="co"># make filter string in form filter = &quot;-drop_z_below 50 -drop_z_above 1000&quot;</span></span>
<span id="cb510-6"><a href="neon-aop.html#cb510-6" aria-hidden="true" tabindex="-1"></a><span class="co"># You can increase or decrease (from 4) the number of sd&#39;s to filter outliers</span></span>
<span id="cb510-7"><a href="neon-aop.html#cb510-7" aria-hidden="true" tabindex="-1"></a>f <span class="ot">=</span> <span class="fu">paste</span>(<span class="st">&quot;-drop_z_below&quot;</span>,(Z_mean<span class="dv">-4</span><span class="sc">*</span>Z_sd),<span class="st">&quot;-drop_z_above&quot;</span>,(Z_mean<span class="sc">+</span><span class="dv">4</span><span class="sc">*</span>Z_sd))</span>
<span id="cb510-8"><a href="neon-aop.html#cb510-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb510-9"><a href="neon-aop.html#cb510-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in LAS file, trimming off vertical outlier points</span></span>
<span id="cb510-10"><a href="neon-aop.html#cb510-10" aria-hidden="true" tabindex="-1"></a>WREF_LAS<span class="ot">=</span><span class="fu">readLAS</span>(<span class="st">&quot;./data/DP1.30003.001/2017/FullSite/D16/2017_WREF_1/L1/DiscreteLidar/ClassifiedPointCloud/NEON_D16_WREF_DP1_580000_5075000_classified_point_cloud.laz&quot;</span>,</span>
<span id="cb510-11"><a href="neon-aop.html#cb510-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">filter =</span> f)</span>
<span id="cb510-12"><a href="neon-aop.html#cb510-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb510-13"><a href="neon-aop.html#cb510-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the full LiDAR point cloud mosaic tile (1km^2)</span></span>
<span id="cb510-14"><a href="neon-aop.html#cb510-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(WREF_LAS)</span></code></pre></div>
<p><img src="images/GEDI_AOP2.png" width="479" /></p>
<p>Ahhh, that’s better.</p>
</div>
<div id="clip-aop-lidar-pointcloud-to-gedi-footprints" class="section level3 hasAnchor" number="6.12.10">
<h3><span class="header-section-number">6.12.10</span> Clip AOP LiDAR Pointcloud to GEDI footprints<a href="neon-aop.html#clip-aop-lidar-pointcloud-to-gedi-footprints" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can now use the GEDI footprint circles (that we made using the <code>buffer()</code> function) to clip out the NEON AOP LiDAR points that correspond with the GEDI footprints:</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="neon-aop.html#cb511-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clip the pointcloud by the GEDI footprints created by buffering above. </span></span>
<span id="cb511-2"><a href="neon-aop.html#cb511-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This makes a &#39;list&#39; of LAS objects</span></span>
<span id="cb511-3"><a href="neon-aop.html#cb511-3" aria-hidden="true" tabindex="-1"></a>WREF_GEDI_footprints<span class="ot">=</span><span class="fu">lasclip</span>(WREF_LAS, <span class="at">geometry =</span> level1bgeo_WREF_UTM_buffer)</span>
<span id="cb511-4"><a href="neon-aop.html#cb511-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb511-5"><a href="neon-aop.html#cb511-5" aria-hidden="true" tabindex="-1"></a><span class="co"># we can now plot individual footprint clips</span></span>
<span id="cb511-6"><a href="neon-aop.html#cb511-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(WREF_GEDI_footprints[[<span class="dv">8</span>]])</span></code></pre></div>
<iframe width="560" height="315" src="https://www.youtube.com/embed/ERdy6-bqiZI" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</div>
<div id="plot-gedi-waveform-with-aop-pointcloud-in-3d-space" class="section level3 hasAnchor" number="6.12.11">
<h3><span class="header-section-number">6.12.11</span> Plot GEDI Waveform with AOP Pointcloud in 3D space<a href="neon-aop.html#plot-gedi-waveform-with-aop-pointcloud-in-3d-space" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that we can extract individual waveforms, and the AOP LiDAR pointcloud that corresponds with each GEDI waveform, let’s see if we can plot them both in 3D space. We already know how to plot the AOP LiDAR points, so let’s write a function to draw the GEDI waveform, too, using the <code>points3d()</code> function:</p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="neon-aop.html#cb512-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(shot_n <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">20</span>)){</span>
<span id="cb512-2"><a href="neon-aop.html#cb512-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-3"><a href="neon-aop.html#cb512-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># First, plot the NEON AOP LiDAR clipped to the GEDI footprint</span></span>
<span id="cb512-4"><a href="neon-aop.html#cb512-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We save the plot as an object &#39;p&#39; which gives the (x,y) offset for the lower</span></span>
<span id="cb512-5"><a href="neon-aop.html#cb512-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># left corner of the plot. The &#39;rgl&#39; package offsets all (x,y) locations </span></span>
<span id="cb512-6"><a href="neon-aop.html#cb512-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># to this point, so we will need to subtract these values from any other </span></span>
<span id="cb512-7"><a href="neon-aop.html#cb512-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (x,y) points that we want to add to the plot</span></span>
<span id="cb512-8"><a href="neon-aop.html#cb512-8" aria-hidden="true" tabindex="-1"></a>  p<span class="ot">=</span><span class="fu">plot</span>(WREF_GEDI_footprints[[shot_n]])</span>
<span id="cb512-9"><a href="neon-aop.html#cb512-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb512-10"><a href="neon-aop.html#cb512-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the specific waveform from the GEDI data</span></span>
<span id="cb512-11"><a href="neon-aop.html#cb512-11" aria-hidden="true" tabindex="-1"></a>  wf <span class="ot">&lt;-</span> <span class="fu">getLevel1BWF</span>(gedilevel1b,<span class="at">shot_number =</span> level1bgeo_WREF<span class="sc">$</span>shot_number[shot_n])</span>
<span id="cb512-12"><a href="neon-aop.html#cb512-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb512-13"><a href="neon-aop.html#cb512-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make a new data.frame &#39;d&#39; to convert the waveform data coordinates into 3D space</span></span>
<span id="cb512-14"><a href="neon-aop.html#cb512-14" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">=</span>wf<span class="sc">@</span>dt</span>
<span id="cb512-15"><a href="neon-aop.html#cb512-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb512-16"><a href="neon-aop.html#cb512-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># normalize rxwaveform to 0-1</span></span>
<span id="cb512-17"><a href="neon-aop.html#cb512-17" aria-hidden="true" tabindex="-1"></a>  d<span class="sc">$</span>rxwaveform<span class="ot">=</span>d<span class="sc">$</span>rxwaveform<span class="sc">-</span><span class="fu">min</span>(d<span class="sc">$</span>rxwaveform)</span>
<span id="cb512-18"><a href="neon-aop.html#cb512-18" aria-hidden="true" tabindex="-1"></a>  d<span class="sc">$</span>rxwaveform<span class="ot">=</span>d<span class="sc">$</span>rxwaveform<span class="sc">/</span><span class="fu">max</span>(d<span class="sc">$</span>rxwaveform)</span>
<span id="cb512-19"><a href="neon-aop.html#cb512-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb512-20"><a href="neon-aop.html#cb512-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add xy data in UTMs, and offset lower left corner of &#39;p&#39;</span></span>
<span id="cb512-21"><a href="neon-aop.html#cb512-21" aria-hidden="true" tabindex="-1"></a>  d<span class="sc">$</span>x<span class="ot">=</span><span class="fu">st_coordinates</span>(level1bgeo_WREF_UTM[shot_n,])[<span class="dv">1</span>]<span class="sc">-</span>p[<span class="dv">1</span>]</span>
<span id="cb512-22"><a href="neon-aop.html#cb512-22" aria-hidden="true" tabindex="-1"></a>  d<span class="sc">$</span>y<span class="ot">=</span><span class="fu">st_coordinates</span>(level1bgeo_WREF_UTM[shot_n,])[<span class="dv">2</span>]<span class="sc">-</span>p[<span class="dv">2</span>]</span>
<span id="cb512-23"><a href="neon-aop.html#cb512-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb512-24"><a href="neon-aop.html#cb512-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make a new column &#39;x_wf&#39; where we place the GEDI waveform in space with the </span></span>
<span id="cb512-25"><a href="neon-aop.html#cb512-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># NEON AOP LiDAR data, we scale the waveform to 30m in the x-dimension, and </span></span>
<span id="cb512-26"><a href="neon-aop.html#cb512-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># offset by 12.5m (the radius of the GEDI footprint) in the x-dimension.</span></span>
<span id="cb512-27"><a href="neon-aop.html#cb512-27" aria-hidden="true" tabindex="-1"></a>  d<span class="sc">$</span>x_wf<span class="ot">=</span>d<span class="sc">$</span>x<span class="sc">+</span>d<span class="sc">$</span>rxwaveform<span class="sc">*</span><span class="dv">30</span><span class="fl">+12.5</span></span>
<span id="cb512-28"><a href="neon-aop.html#cb512-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb512-29"><a href="neon-aop.html#cb512-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add GEDI points to 3D space in &#39;green&#39; color</span></span>
<span id="cb512-30"><a href="neon-aop.html#cb512-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points3d</span>(<span class="at">x=</span>d<span class="sc">$</span>x_wf, <span class="at">y=</span>d<span class="sc">$</span>y, <span class="at">z=</span>d<span class="sc">$</span>elevation, <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">add=</span>T)</span>
<span id="cb512-31"><a href="neon-aop.html#cb512-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-32"><a href="neon-aop.html#cb512-32" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<iframe width="560" height="315" src="https://www.youtube.com/embed/DnqbPPVSwTg" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<p>Whoa, it looks like there is a bad vertical mismatch between those two data sources. This is because the two data sources have a different vertical datum. The NEON AOP data are delivered in the GEOID12A datum, while the GEDI data are delivered in the WGS84 native datum. We will need to convert one to the other to get them to line up correctly.</p>
</div>
<div id="datum-geoid-and-how-to-best-measure-the-earth" class="section level3 hasAnchor" number="6.12.12">
<h3><span class="header-section-number">6.12.12</span> Datum, Geoid, and how to best measure the Earth<a href="neon-aop.html#datum-geoid-and-how-to-best-measure-the-earth" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We are seeing a vertical mismatch between the NEON and GEDI LiDAR data sources because they are using different standards for measuring the Earth. Here, we will briefly describe the main differences between these two datum models, and then show how to correct for this discrepancy.</p>
<div id="wgs84" class="section level4 hasAnchor" number="6.12.12.1">
<h4><span class="header-section-number">6.12.12.1</span> WGS84<a href="neon-aop.html#wgs84" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As described in <a href="https://en.wikipedia.org/wiki/World_Geodetic_System">this great Wikipedia article</a> the World Geodedic System (WGS) is a global standard for cartography, geodesy, and navigation including GPS. Most people refer to “WGS84,” which is the latest revision to this system in 1984. To describe elevation, WGS84 uses an idealized mathematical model to describe the ‘oblate spheroid’ of the Earth (basically, it looks kind of like a sphere that is wider around the equator and shorter from pole to pole). This model, called a ‘datum,’ defines the relative elevational surface of the Earth. However, the Earth isn’t exactly this idealized shape - it has a lot of undulations caused by topogrophy and local differences in its gravitational field. In the locations where the natural variations of the Earth do not coencide with the mathematical model, it can be harder to accurately describe the elevation of certain landforms and structures. Still, for a global datum, WGS84 does a great job overall.</p>
</div>
<div id="geoid12a" class="section level4 hasAnchor" number="6.12.12.2">
<h4><span class="header-section-number">6.12.12.2</span> GEOID12A<a href="neon-aop.html#geoid12a" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>While WGS84 is a convenient global standard, precisely describing location information is a common problem in geography, and is often remedied by using a local datum or projection. For latitude and longitude spatial information in North America, this is often done by using the <a href="https://www.ngs.noaa.gov/datums/horizontal/north-american-datum-1983.shtml">North American Datum (NAD83)</a> or various Universal Transverse Mercator (UTM) or State Plane projections based on the NAD83 datum. The NAD83 Datum was developed in 1983 as the horizontal and geometric control datum for the United States, Canada, Mexico, and Central America. This is the official datum for the government of the United States of America, and therefore many public datasets that are specific to this geographic region use this datum. In order to further refine the vertical precision over a wide geographic area, we can model the gravitational field of the Earth - this surface is called a “Geoid”. <a href="https://geodesy.noaa.gov/GEOID/geoid_def.html">According to NOAA</a>, a geoid can be defined as “the equipotential surface of the Earth’s gravity field which best fits, in a least squares sense, global mean sea level.” For a nice description of the North American geoid, please <a href="https://geodesy.noaa.gov/GEOID/geophysics.shtml">see this page on the NOAA website</a> written by Dr. Allen Joel Anderson. As described by Dr. Anderson, this gravitational field is changing all the time, as can global mean sea level (due to melting glaciers, etc.). Therefore local and regional geoids must be updated regularly to reflect these changes, as shown <a href="https://geodesy.noaa.gov/GEOID/models.shtml">in this list of NOAA geoids</a>. One recent standard from 2012 is &lt;<a href="https://geodesy.noaa.gov/GEOID/GEOID12A/">GEOID12A</a> - this is the geoid selected by NEON as the vertical reference for the Z-dimension of our LiDAR data. Note that GEOID12B superscedes GEOID12A, however they are identical everywhere except for Puerto Rico and the US Virgin Islands <a href="https://geodesy.noaa.gov/GEOID/GEOID12B/">according to NOAA</a>. If you are working with any NEON data from Puerto Rico, please be aware that these data are delivered in GEOID12A format and may need to be converted to GEOID12B for some purposes.</p>
<p>For more information about these standards, please see <a href="https://desktop.arcgis.com/en/arcmap/10.3/guide-books/map-projections/about-the-geoid-ellipsoid-spheroid-and-datum-and-h.htm">this ESRI help document</a>.</p>
</div>
</div>
<div id="aligning-the-vertical-datum" class="section level3 hasAnchor" number="6.12.13">
<h3><span class="header-section-number">6.12.13</span> Aligning the Vertical Datum<a href="neon-aop.html#aligning-the-vertical-datum" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>AOP data have a relatively small area of coverage, and are therefore delivered with the coordinate reference system (CRS) in the UTM zone in which they were collected, set to the GEOID12A vertical datum (roughly equaling mean sea level). Meanwhile, GEDI data are global, so they are delivered with the common WGS84 ellipsoidal refrence datum. We need to align these vertical datums to ensure that the two data products line up correctly. However, this is not a trivial step, nor as simple as a reprojection. In this example, we will keep the NEON LiDAR data in its current datum, and convert the vertical position of the GEDI data from WGS84 into GEOID12A vertical position.</p>
<p>NOAA has a useful <a href="https://www.ngs.noaa.gov/INFO/facts/vdatum.shtml">tool called Vdatum</a> that will convert from one datum to another. For this example, we will use Vdatum to convert from WGS84 to NAD83. Seeing as GEOID12A is based on the NAD83 datum, we can first convert the GEDI data’s vertical position from WGS84 to NAD83 datum, then apply the offset between NAD83 and GEOID12A. Rather than use the Vdatum tool for each point, we will use a raster created by NEON scientists that reports the vertical difference between WGS84 and NAD83 for all points in the conterminous USA.</p>
<p>You can access this dataset by <a href="https://ndownloader.figshare.com/files/24994703">clicking here to download the WGS84-NAD83 datum offset raster</a>.</p>
</div>
<div id="geoid12a-height-model" class="section level3 hasAnchor" number="6.12.14">
<h3><span class="header-section-number">6.12.14</span> GEOID12A Height Model<a href="neon-aop.html#geoid12a-height-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>GEOID12A is a surface model that is described in terms of its relative height compared to NAD83. You can use <a href="https://www.ngs.noaa.gov/cgi-bin/GEOID_STUFF/geoid12A_prompt1.prl">this interactive webpage</a> to find the geoid height for any location within North America. However, that would be combersome to have to use this webpage for every location. Instead, you can download a &lt;a href=“<a href="https://www.ngs.noaa.gov/GEOID/GEOID12A/GEOID12A_CONUS.shtml" class="uri">https://www.ngs.noaa.gov/GEOID/GEOID12A/GEOID12A_CONUS.shtml</a>&gt;binary file from the NOAA website</a> that describes this geoid’s height, and convert that into a raster similar to the one that we just downloaded above. To simplify things here, we have already gone through the process of downloading the binary file and converting it to a raster for you to download, which can now easily be read into your R environment.</p>
<p>You can access this dataset by <a href="https://ndownloader.figshare.com/files/24994697">clicking here to download the GEOID12A-NAD83 datum offset raster</a>.</p>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="neon-aop.html#cb513-1" aria-hidden="true" tabindex="-1"></a>GEOID12A_diff_rast<span class="ot">=</span><span class="fu">raster</span>(<span class="st">&quot;./data/GEOID12A_NAD83_offset.tif&quot;</span>)</span>
<span id="cb513-2"><a href="neon-aop.html#cb513-2" aria-hidden="true" tabindex="-1"></a>WGS84_diff_rast<span class="ot">=</span><span class="fu">raster</span>(<span class="st">&quot;./data/WGS84_NAD83_offset.tif&quot;</span>)</span></code></pre></div>
<p>Now that we have the two offset rasters, let’s plot them together to compare their spatial patterns.</p>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="neon-aop.html#cb514-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">2.5</span>,<span class="fl">2.5</span>, <span class="fl">3.5</span>,<span class="dv">1</span>))</span>
<span id="cb514-2"><a href="neon-aop.html#cb514-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(GEOID12A_diff_rast, <span class="at">col=</span><span class="fu">viridis</span>(<span class="dv">100</span>),<span class="at">main=</span><span class="st">&quot;GEOID12A minus NAD83 (m)&quot;</span>)</span>
<span id="cb514-3"><a href="neon-aop.html#cb514-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(WGS84_diff_rast, <span class="at">main=</span><span class="st">&quot;WGS84 minus NAD83 (m)&quot;</span>)</span></code></pre></div>
<p>As you can see, the differences between the GEOID12A geoid, and the NAD83 sphereoid vary quite a lot across space, especially in mountainous areas. The magnitude of these differences is also large, upwards of 35m in some areas. Meanwhile, the differences between the NAD83 and WGS84 sphereoids shows a smooth gradient that is relatively small, with total difference less than 2m across the Conterminous USA.</p>
</div>
<div id="extract-vertical-offset-for-gedi-shots" class="section level3 hasAnchor" number="6.12.15">
<h3><span class="header-section-number">6.12.15</span> Extract vertical offset for GEDI shots<a href="neon-aop.html#extract-vertical-offset-for-gedi-shots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that we know the relative vertical offsets between WGS84, NAD83, and GEOID12A for all of the conterminous USA, we can use the <code>extract()</code> function to retrieve those relative offsets for any location. By combining those offsets together, we can finally rectify the vertical position of the NEON and GEDI LiDAR data.</p>
<p>***** DO I need to convert GEDI x/y locations from WGS84 to NAD83?? *****</p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="neon-aop.html#cb515-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a new DF to store the GEDI footprint (x,y) locations, and the relative datum/geoid offsets</span></span>
<span id="cb515-2"><a href="neon-aop.html#cb515-2" aria-hidden="true" tabindex="-1"></a>footprint_df<span class="ot">=</span><span class="fu">as.data.frame</span>(</span>
<span id="cb515-3"><a href="neon-aop.html#cb515-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(level1bgeo_WREF<span class="sc">$</span>longitude_lastbin, level1bgeo_WREF<span class="sc">$</span>latitude_lastbin))</span>
<span id="cb515-4"><a href="neon-aop.html#cb515-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb515-5"><a href="neon-aop.html#cb515-5" aria-hidden="true" tabindex="-1"></a>WGS_NAD_diff <span class="ot">&lt;-</span> <span class="fu">extract</span>(WGS84_diff_rast, footprint_df)</span>
<span id="cb515-6"><a href="neon-aop.html#cb515-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb515-7"><a href="neon-aop.html#cb515-7" aria-hidden="true" tabindex="-1"></a>GEOID12A_NAD_diff <span class="ot">&lt;-</span> <span class="fu">extract</span>(GEOID12A_diff_rast,footprint_df)</span>
<span id="cb515-8"><a href="neon-aop.html#cb515-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb515-9"><a href="neon-aop.html#cb515-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Add together the offsets to calculate a vector of net differences in elevation</span></span>
<span id="cb515-10"><a href="neon-aop.html#cb515-10" aria-hidden="true" tabindex="-1"></a>net_diff<span class="ot">=</span>WGS_NAD_diff<span class="sc">+</span>GEOID12A_NAD_diff</span></code></pre></div>
</div>
<div id="plot-vertically-corrected-gedi-waveform-in-3d" class="section level3 hasAnchor" number="6.12.16">
<h3><span class="header-section-number">6.12.16</span> Plot vertically corrected GEDI waveform in 3D<a href="neon-aop.html#plot-vertically-corrected-gedi-waveform-in-3d" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that we have a vertical offset for each of the GEDI footprints, let’s try again to plot the NEON AOP pointcloud data with the GEDI waveform.</p>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="neon-aop.html#cb516-1" aria-hidden="true" tabindex="-1"></a><span class="co"># You can enter whichever shots that you want to plot in the for loop here</span></span>
<span id="cb516-2"><a href="neon-aop.html#cb516-2" aria-hidden="true" tabindex="-1"></a><span class="co">#for(shot_n in 1:length(WREF_GEDI_footprints)){</span></span>
<span id="cb516-3"><a href="neon-aop.html#cb516-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(shot_n <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">20</span>)){</span>
<span id="cb516-4"><a href="neon-aop.html#cb516-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb516-5"><a href="neon-aop.html#cb516-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># First, plot the NEON AOP LiDAR clipped to the GEDI footprint</span></span>
<span id="cb516-6"><a href="neon-aop.html#cb516-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We save the plot as an object &#39;p&#39; which gives the (x,y) offset for the lower</span></span>
<span id="cb516-7"><a href="neon-aop.html#cb516-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># left corner of the plot. The &#39;rgl&#39; package offsets all (x,y) locations </span></span>
<span id="cb516-8"><a href="neon-aop.html#cb516-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># to this point, so we will need to subtract these values from any other </span></span>
<span id="cb516-9"><a href="neon-aop.html#cb516-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (x,y) points that we want to add to the plot</span></span>
<span id="cb516-10"><a href="neon-aop.html#cb516-10" aria-hidden="true" tabindex="-1"></a>  p<span class="ot">=</span><span class="fu">plot</span>(WREF_GEDI_footprints[[shot_n]])</span>
<span id="cb516-11"><a href="neon-aop.html#cb516-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb516-12"><a href="neon-aop.html#cb516-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the specific waveform from the GEDI data</span></span>
<span id="cb516-13"><a href="neon-aop.html#cb516-13" aria-hidden="true" tabindex="-1"></a>  wf <span class="ot">&lt;-</span> <span class="fu">getLevel1BWF</span>(gedilevel1b,<span class="at">shot_number =</span> level1bgeo_WREF<span class="sc">$</span>shot_number[shot_n])</span>
<span id="cb516-14"><a href="neon-aop.html#cb516-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb516-15"><a href="neon-aop.html#cb516-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make a new data.frame &#39;d&#39; to convert the waveform data coordinates into 3D space</span></span>
<span id="cb516-16"><a href="neon-aop.html#cb516-16" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">=</span>wf<span class="sc">@</span>dt</span>
<span id="cb516-17"><a href="neon-aop.html#cb516-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb516-18"><a href="neon-aop.html#cb516-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># normalize rxwaveform to 0-1</span></span>
<span id="cb516-19"><a href="neon-aop.html#cb516-19" aria-hidden="true" tabindex="-1"></a>  d<span class="sc">$</span>rxwaveform<span class="ot">=</span>d<span class="sc">$</span>rxwaveform<span class="sc">-</span><span class="fu">min</span>(d<span class="sc">$</span>rxwaveform)</span>
<span id="cb516-20"><a href="neon-aop.html#cb516-20" aria-hidden="true" tabindex="-1"></a>  d<span class="sc">$</span>rxwaveform<span class="ot">=</span>d<span class="sc">$</span>rxwaveform<span class="sc">/</span><span class="fu">max</span>(d<span class="sc">$</span>rxwaveform)</span>
<span id="cb516-21"><a href="neon-aop.html#cb516-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb516-22"><a href="neon-aop.html#cb516-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add xy data in UTMs, and offset lower left corner of &#39;p&#39;</span></span>
<span id="cb516-23"><a href="neon-aop.html#cb516-23" aria-hidden="true" tabindex="-1"></a>  d<span class="sc">$</span>x<span class="ot">=</span><span class="fu">st_coordinates</span>(level1bgeo_WREF_UTM[shot_n,])[<span class="dv">1</span>]<span class="sc">-</span>p[<span class="dv">1</span>]</span>
<span id="cb516-24"><a href="neon-aop.html#cb516-24" aria-hidden="true" tabindex="-1"></a>  d<span class="sc">$</span>y<span class="ot">=</span><span class="fu">st_coordinates</span>(level1bgeo_WREF_UTM[shot_n,])[<span class="dv">2</span>]<span class="sc">-</span>p[<span class="dv">2</span>]</span>
<span id="cb516-25"><a href="neon-aop.html#cb516-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb516-26"><a href="neon-aop.html#cb516-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make a new column &#39;x_wf&#39; where we place the GEDI waveform in space with the </span></span>
<span id="cb516-27"><a href="neon-aop.html#cb516-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># NEON AOP LiDAR data, we scale the waveform to 30m in the x-dimension, and </span></span>
<span id="cb516-28"><a href="neon-aop.html#cb516-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># offset by 12.5m (the radius of the GEDI footprint) in the x-dimension.</span></span>
<span id="cb516-29"><a href="neon-aop.html#cb516-29" aria-hidden="true" tabindex="-1"></a>  d<span class="sc">$</span>x_wf<span class="ot">=</span>d<span class="sc">$</span>x<span class="sc">+</span>d<span class="sc">$</span>rxwaveform<span class="sc">*</span><span class="dv">30</span><span class="fl">+12.5</span></span>
<span id="cb516-30"><a href="neon-aop.html#cb516-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb516-31"><a href="neon-aop.html#cb516-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add GEDI points to 3D space in &#39;green&#39; color</span></span>
<span id="cb516-32"><a href="neon-aop.html#cb516-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This time, subtracting the elevation difference for that shot</span></span>
<span id="cb516-33"><a href="neon-aop.html#cb516-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points3d</span>(<span class="at">x=</span>d<span class="sc">$</span>x_wf, <span class="at">y=</span>d<span class="sc">$</span>y, <span class="at">z=</span>d<span class="sc">$</span>elevation<span class="sc">-</span>net_diff[shot_n], <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">add=</span>T)</span>
<span id="cb516-34"><a href="neon-aop.html#cb516-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb516-35"><a href="neon-aop.html#cb516-35" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="optional---neon-base-plots" class="section level3 hasAnchor" number="6.12.17">
<h3><span class="header-section-number">6.12.17</span> Optional - NEON base plots<a href="neon-aop.html#optional---neon-base-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You may also be interested to see if any of the GEDI footprints intersect a NEON base plot, which would allow for a direct comparison of the GEDI waveform with many of the datasets which are collected within the base plots, such as the vegetation structure data product containing height, DBH, and species identification of all trees &gt;10cm DBH. While it is statistically pretty unlikely that a GEDI footprint will intersect with your base plot of interest, it is possible that <em>some</em> GEDI footprint will intersetc with <em>some</em> base plot in your study area, so we may as well take a look:</p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="neon-aop.html#cb517-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;./data/&quot;</span>) <span class="co"># This will depend upon your local environment</span></span>
<span id="cb517-2"><a href="neon-aop.html#cb517-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb517-3"><a href="neon-aop.html#cb517-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Download the NEON TOS plots polygons directly from the NEON website</span></span>
<span id="cb517-4"><a href="neon-aop.html#cb517-4" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="at">url=</span><span class="st">&quot;https://data.neonscience.org/api/v0/documents/All_NEON_TOS_Plots_V8&quot;</span>, </span>
<span id="cb517-5"><a href="neon-aop.html#cb517-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">destfile=</span><span class="st">&quot;All_NEON_TOS_Plots_V8.zip&quot;</span>, <span class="at">mode =</span> <span class="st">&#39;wb&#39;</span>)</span>
<span id="cb517-6"><a href="neon-aop.html#cb517-6" aria-hidden="true" tabindex="-1"></a><span class="fu">unzip</span>(<span class="st">&quot;All_NEON_TOS_Plots_V8.zip&quot;</span>)</span>
<span id="cb517-7"><a href="neon-aop.html#cb517-7" aria-hidden="true" tabindex="-1"></a>NEON_all_plots <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&#39;All_NEON_TOS_Plots_V8/All_NEON_TOS_Plot_Polygons_V8.shp&#39;</span>)</span></code></pre></div>
<pre><code>## Reading layer `All_NEON_TOS_Plot_Polygons_V8&#39; from data source 
##   `C:\Users\rohan\katharynduffy.github.io\data\All_NEON_TOS_Plots_V8\All_NEON_TOS_Plot_Polygons_V8.shp&#39; 
##   using driver `ESRI Shapefile&#39;
## Simple feature collection with 3841 features and 36 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: -156.6516 ymin: 17.9514 xmax: -66.82358 ymax: 71.3169
## Geodetic CRS:  WGS 84</code></pre>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="neon-aop.html#cb519-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select just the WREF site</span></span>
<span id="cb519-2"><a href="neon-aop.html#cb519-2" aria-hidden="true" tabindex="-1"></a>SITECODE <span class="ot">=</span> <span class="st">&#39;WREF&#39;</span></span>
<span id="cb519-3"><a href="neon-aop.html#cb519-3" aria-hidden="true" tabindex="-1"></a>base_plots_SPDF <span class="ot">&lt;-</span> NEON_all_plots[</span>
<span id="cb519-4"><a href="neon-aop.html#cb519-4" aria-hidden="true" tabindex="-1"></a>  (NEON_all_plots<span class="sc">$</span>siteID <span class="sc">==</span> SITECODE)<span class="sc">&amp;</span></span>
<span id="cb519-5"><a href="neon-aop.html#cb519-5" aria-hidden="true" tabindex="-1"></a>    (NEON_all_plots<span class="sc">$</span>subtype <span class="sc">==</span> <span class="st">&#39;basePlot&#39;</span>),]</span>
<span id="cb519-6"><a href="neon-aop.html#cb519-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(NEON_all_plots)</span>
<span id="cb519-7"><a href="neon-aop.html#cb519-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb519-8"><a href="neon-aop.html#cb519-8" aria-hidden="true" tabindex="-1"></a>base_crop<span class="ot">=</span><span class="fu">st_crop</span>(base_plots_SPDF, <span class="fu">extent</span>(chm_WGS))</span></code></pre></div>
<pre><code>## Warning: attribute variables are assumed to be spatially constant throughout all
## geometries</code></pre>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="neon-aop.html#cb521-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(chm_WGS)</span>
<span id="cb521-2"><a href="neon-aop.html#cb521-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(base_crop<span class="sc">$</span>geometry, <span class="at">border =</span> <span class="st">&#39;blue&#39;</span>, <span class="at">add=</span>T)</span></code></pre></div>
<p><img src="07-NEON_AOP_files/figure-html/import%20and%20plot%20base%20plots-1.png" width="672" /></p>
</div>
</div>
<div id="neon-aop-written-questions" class="section level2 hasAnchor" number="6.13">
<h2><span class="header-section-number">6.13</span> NEON AOP Written Questions:<a href="neon-aop.html#neon-aop-written-questions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>Reminder: these questions are largely based on the assigned video lectures. I highly recommend you watching or re-watching them before tackling these questions.</em></p>
<ol style="list-style-type: decimal">
<li><p>What is the overlap in the type of data generated by NEON AOP and PhenoCam. What metrics from PhenoCam could you apply to NEON AOP data, especially once there are &gt;10 years of aerial data?</p></li>
<li><p>List 4 challenges to timing AOP flight campaigns.</p></li>
<li><p>When using NEON AOP data, when should you use <code>byTileAOP</code> versus <code>byFileAOP</code>? What additional processing might you need to do if you worked with the <code>byFileAOP</code> data?
<em>Hint: try pulling the data in both formats (this will take a while)</em></p></li>
<li><p>How do the additional bands in NEON AOP improve our contraint of Biodiversity and Ecosystem Structure relative to satelite-derived data?</p></li>
<li><p>What role do campaigns such as NEON AOP play in ‘filling the sampling gap’ of essential <em>in situ</em> data such as FLUXNET (Eddy Co-Variance) data?</p></li>
<li><p>List 3 attributes of NEON AOP data that are unique to other publicly served data.
<em>Hints: Band width? Resolution? Something else?</em></p></li>
<li><p>Which data product(s) derived from the NEON AOP campaign align with remotely-sensed products from NASA?<br />
<em>Hint: start with vegetation indices</em></p></li>
</ol>
</div>
<div id="neon-aop-coding-lab" class="section level2 hasAnchor" number="6.14">
<h2><span class="header-section-number">6.14</span> NEON AOP Coding Lab<a href="neon-aop.html#neon-aop-coding-lab" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For the purpose of this coding lab we will evaluate 2 different forested sites in 2018:</p>
<ol style="list-style-type: decimal">
<li>Guanica (GUAN) in Puerto Rico:</li>
</ol>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Rz9kgfPgLPo" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<ol start="2" style="list-style-type: decimal">
<li>Bartlett Experimental Forest (BART) in New Hampshire:</li>
</ol>
<iframe width="560" height="315" src="https://www.youtube.com/embed/zK4cEEs-8tQ" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<p><strong>1:</strong> How are these two forests similar? How are they different? <em>(3-5 sentences)</em></p>
<p><em>A few places to start if you need them. You don’t have to address these, just in case you need some hints:</em>
<em>Climate? How that could affect vegetation structure?</em>
<em>Heterogeniety of the ecossytems?</em>
<em>How seasonal are they? (hint:PhenoCam)</em>
<em>Something else?</em></p>
<p><strong>2:</strong> Using this NEON tutorial and the tutorials we’ve covered in this textbook <em>(hint: you did half of this workflow in your very first coding lab)</em> pull the NEON AOP derived Canopy Height Model (CHM, <code>DP3.30015.001</code>) and High-resolution orthorectified camera imagery mosaic
<code>DP3.30010.001</code> for each forest and overlay the NEON TOS Woody Vegetation Structure <code>DP1.10098.001</code> basal diameter data product to evaluate how well AOP captures trees in each forest.<br />
<strong>Generate a labeled 2x2 plot panel including:</strong></p>
<ul>
<li><p><strong>Each RGB image with basal diameter overlaid</strong></p></li>
<li><p><strong>Each CHM with basal diameter overlaid</strong></p></li>
</ul>
<p><em>Hints/reminders from section 2.9:</em></p>
<pre><code>&lt;- loadByProduct
&lt;- getLocTOS
&lt;- merge</code></pre>
<p><strong>Write 2-3 sentences summarizing your findings and thoughts.</strong></p>
<p><strong>3:</strong> Use the <code>byTileAOP</code> function of the <code>neonUtilities</code> package to pull a subset of the descrete LiDAR pointcloud for each forest (<em>Hint: You can feed <code>byTileAOP</code> Easting and Northing from your <code>Vegetation Structure</code> dataframe(s)</em>). Use the <code>structural_diversity_metrics</code> function that you defined in section 6.5 of the textbook to process discrete return LiDAR for each site and generte structural diversity metrics.</p>
<ul>
<li>Using <code>lidR</code> generate a labeled 2-panel plot of your canopy height model for each forest</li>
<li>Using <code>lidR</code> generate a labeled 2-panel plot of a cross-section for each forest</li>
<li>Use section <code>6.5.3 Comparing Metrics Between Forests</code> to compare each forest and generate a a clean summary table via <code>kable</code></li>
<li>Using <strong>Table 2</strong> from <a href="https://doi.org/10.3390/rs12091407" target="_blank">LaRue, Wagner, et al. (2020) </a> as a reference, write 1-2 paragraphs summarizing the differences in forest structural diversity between the two forests and how they may relate to your answers to <strong>Question 1</strong>.</li>
</ul>
</div>
<div id="neon-aop-culmination-write-up" class="section level2 hasAnchor" number="6.15">
<h2><span class="header-section-number">6.15</span> NEON AOP Culmination Write Up<a href="neon-aop.html#neon-aop-culmination-write-up" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Write up a 1-page <strong>derived data product or research pipeline proposal</strong> summary of a project that you might want to explore using NEON AOP data. Include the types of NEON (and other data) that you would need to implement this project. Save this summary as you will be refining and adding to your ideas over the course of the semester.</p>
<p>Suggestions:</p>
<ol style="list-style-type: decimal">
<li><p>Tables or bullet lists of <strong>specific</strong> data products</p></li>
<li><p>An <strong>overarching high-quality figure</strong> to show how these data align</p></li>
<li><p>One paragraph summarizing <em>how</em> this data or analysis is useful to <strong>you and/or the infrastructure</strong>.</p></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="flux-measurements-inter-operability.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="nasas-earth-observing-system-eos.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"],
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rdboone/katharynduffy.github.io/edit/master/07-NEON_AOP.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Environmental Informatics Using Research Infrastructures and their Data.pdf", "Environmental Informatics Using Research Infrastructures and their Data.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
